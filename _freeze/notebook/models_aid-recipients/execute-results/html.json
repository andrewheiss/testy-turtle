{
  "hash": "ca96f83919a8680771d651ea8d88bdf3",
  "result": {
    "markdown": "---\ntitle: \"H~3~: Effect of anti-NGO crackdown on aid recipients\"\nformat:\n  html:\n    code-fold: true\n    toc-depth: 5\n    knitr:\n      opts_chunk:\n        out.width: \"80%\"\neditor_options: \n  chunk_output_type: inline\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(targets)\nlibrary(brms)\nlibrary(tidybayes)\nlibrary(broom)\nlibrary(broom.mixed)\nlibrary(modelsummary)\nlibrary(marginaleffects)\nlibrary(patchwork)\nlibrary(scales)\nlibrary(ggdist)\nlibrary(ggtext)\nlibrary(ggh4x)\nlibrary(extraDistr)\nlibrary(kableExtra)\nlibrary(glue)\nlibrary(here)\n\ntar_config_set(store = here::here('_targets'),\n               script = here::here('_targets.R'))\n\nset.seed(1234)\n\n# Load stuff from targets\n# Plotting functions\ninvisible(list2env(tar_read(graphic_functions), .GlobalEnv))\nset_annotation_fonts()\n\n# Tell bayesplot to use the sunset palette for things like pp_check()\nbayesplot::color_scheme_set(clrs$Sunset[2:7])\n\n# Data\ndf_country_aid <- tar_read(country_aid_final) %>% \n  filter(year > 2000 & year < 2013)\ndf_country_aid_laws <- filter(df_country_aid, laws)\n\n# Treatment models\ntar_load(c(m_recip_treatment_total_dom, m_recip_treatment_advocacy_dom, \n           m_recip_treatment_entry_dom, m_recip_treatment_funding_dom, \n           m_recip_treatment_ccsi_dom, m_recip_treatment_repress_dom))\ntar_load(c(m_recip_treatment_total_foreign, m_recip_treatment_advocacy_foreign, \n           m_recip_treatment_entry_foreign, m_recip_treatment_funding_foreign, \n           m_recip_treatment_ccsi_foreign, m_recip_treatment_repress_foreign))\n\n# IPTW data\ntar_load(c(df_recip_iptw_total_dom, df_recip_iptw_advocacy_dom, \n           df_recip_iptw_entry_dom, df_recip_iptw_funding_dom,\n           df_recip_iptw_ccsi_dom, df_recip_iptw_repress_dom))\ntar_load(c(df_recip_iptw_total_foreign, df_recip_iptw_advocacy_foreign, \n           df_recip_iptw_entry_foreign, df_recip_iptw_funding_foreign,\n           df_recip_iptw_ccsi_foreign, df_recip_iptw_repress_foreign))\n\n# Outcome models\ntar_load(c(m_recip_outcome_total_dom, m_recip_outcome_advocacy_dom, \n           m_recip_outcome_entry_dom, m_recip_outcome_funding_dom,\n           m_recip_outcome_ccsi_dom, m_recip_outcome_repress_dom))\ntar_load(c(m_recip_outcome_total_foreign, m_recip_outcome_advocacy_foreign, \n           m_recip_outcome_entry_foreign, m_recip_outcome_funding_foreign,\n           m_recip_outcome_ccsi_foreign, m_recip_outcome_repress_foreign))\n\n# Marginal/conditional effects\ntar_load(c(mfx_recip_cfx_multiple_dom, mfx_recip_cfx_single_dom,\n           mfx_recip_cfx_multiple_foreign, mfx_recip_cfx_single_foreign))\n\n# Results tables\ntar_load(c(models_tbl_h3_treatment_num_dom, models_tbl_h3_treatment_denom_dom))\ntar_load(c(models_tbl_h3_treatment_num_foreign, models_tbl_h3_treatment_denom_foreign))\ntar_load(c(models_tbl_h3_outcome_dejure_dom, models_tbl_h3_outcome_defacto_dom))\ntar_load(c(models_tbl_h3_outcome_dejure_foreign, models_tbl_h3_outcome_defacto_foreign))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ninvisible(list2env(tar_read(modelsummary_functions), .GlobalEnv))\n\ntreatment_names <- c(\"Treatment\", \"Total barriers (t)\", \"Barriers to advocacy (t)\", \n                     \"Barriers to entry (t)\", \"Barriers to funding (t)\", \"CCSI (t)\",\n                     \"CS repression (t)\")\ntreatment_rows <- as.data.frame(t(treatment_names))\nattr(treatment_rows, \"position\") <- 1\n\noutcome_names <- c(\"Treatment\", \"Total barriers (t)\", \"Barriers to advocacy (t)\", \n                   \"Barriers to entry (t)\", \"Barriers to funding (t)\")\noutcome_rows <- as.data.frame(t(outcome_names))\nattr(outcome_rows, \"position\") <- 1\n```\n:::\n\n\n# Weight models\n\n## General idea\n\nSee the [\"Weight models—General idea\" section from the total aid page](models_total-aid.qmd#general-idea) for an explanation of the intuition behind how to create these stabilized weights.\n\n## Actual models\n\nWe identify our time-varying and time-invariant confounders based on [our causal model and *do*-calculus logic](causal-model.qmd#final-variables-to-use), and we deal with the panel structure of the data by including random intercepts for country, and both a population-level trend and random slopes for year. We use [generic weakly informative priors](https://mc-stan.org/users/documentation/case-studies/weakly_informative_shapes.html) for our model parameters.\n\n### Numerator\n\nOur numerator models look like this (but with the actual treatment variable replacing `treatment`, like `barriers_total`, `advocacy`, and so on):\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(treatment ~ treatment_lag1 + treatment_lag2_cumsum + (1 | gwcode))\n```\n:::\n\n\nOr more formally:\n\n$$\n\\begin{aligned}\n\\text{Treatment}_{it_j} &\\sim \\mathcal{N}(\\mu_{it_j}, \\sigma_y) \\\\\n\\mu_{it_j} &= (\\beta_0 + b_{0_j}) + \\beta_1 \\text{Treatment}_{i, t-1_j} + \\textstyle{\\sum_{\\tau = (t-2)}^{t}} \\text{Treatment}_{i\\tau} \\\\\nb_{0_j} &\\sim \\mathcal{N}(0, \\sigma_0) \\\\\n\\\\\n\\beta_0, \\beta_1 &\\sim \\operatorname{Student~\\textit{t}\\,}(\\nu = 3, \\mu = 0, \\sigma = 1.5) \\\\\n\\sigma_y, \\sigma_0 &\\sim \\operatorname{Exponential}(1)\n\\end{aligned}\n$$\n\n### Denominator\n\nOur denominator models look like this (but again with the actual treatment variable replacing `treatment`):\n\n::: {.panel-tabset}\n#### Domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(treatment ~ treatment_lag1 + treatment_lag2_cumsum + \n     # Lagged outcome\n     prop_ngo_dom_lag1 +\n     # Human rights and politics\n     v2x_polyarchy + v2x_corr + v2x_rule + v2x_civlib + v2x_clphy + v2x_clpriv +\n     # Economics and development\n     gdpcap_log_z + un_trade_pct_gdp + v2peedueq + v2pehealth + e_peinfmor +\n     # Conflict and disasters\n     internal_conflict_past_5 + natural_dis_count +\n     # Time and country effects\n     year_c + (1 + year_c | gwcode))\n```\n:::\n\n\nOr more formally:\n\n$$\n\\begin{aligned}\n\\text{Treatment}_{it_j} \\sim&\\ \\mathcal{N}(\\mu_{it_j}, \\sigma_y) \\\\\n\\mu_{it_j} =&\\ (\\beta_0 + b_{0_j}) + \\beta_1\\, \\text{Treatment}_{i, t-1_j} + \\beta_2\\, \\textstyle{\\sum_{\\tau = (t-2)}^{t}} \\text{Treatment}_{i\\tau} + \\\\\n&\\ \\beta_3\\, \\text{Proportion of USAID aid to domestic NGOs}_{i,t-1_j} + \\\\\n&\\ \\beta_{4 \\ldots 9}\\, \\text{Human rights \\& politics}_{it_j} + \\\\\n&\\ \\beta_{10 \\ldots 14}\\, \\text{Economics \\& development} + \\beta_{15, 16}\\, \\text{Conflict \\& disasters}_{it_j} + \\\\\n&\\ (\\beta_{17} + b_{17_j})\\, \\text{Year}_{it_j} \\\\\n\\left(\n  \\begin{array}{c} \n  b_{0_j} \\\\\n  b_{17_j}\n  \\end{array}\n\\right) \n\\sim&\\ \\text{MV}\\,\\mathcal{N}\n\\left[\n  \\left(\n    \\begin{array}{c}\n    0 \\\\\n    0 \\\\\n    \\end{array}\n  \\right)\n  , \\,\n  \\left(\n  \\begin{array}{cc}\n     \\sigma^2_{0} & \\rho_{0, 17}\\, \\sigma_{0} \\sigma_{17} \\\\ \n     \\cdots & \\sigma^2_{17}\n  \\end{array}\n\\right)\n\\right] \\\\\n\\\\\n\\beta_0 \\ldots \\beta_{17} \\sim&\\ \\operatorname{Student~\\textit{t}\\,}(\\nu = 3, \\mu = 0, \\sigma = 1.5) \\\\\n\\sigma_y, \\sigma_0, \\sigma_{17} \\sim&\\ \\operatorname{Exponential}(1) \\\\\n\\rho \\sim&\\ \\operatorname{LKJ}(2)\n\\end{aligned}\n$$\n\n#### Foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(treatment ~ treatment_lag1 + treatment_lag2_cumsum + \n     # Lagged outcome\n     prop_ngo_foreign_lag1 +\n     # Human rights and politics\n     v2x_polyarchy + v2x_corr + v2x_rule + v2x_civlib + v2x_clphy + v2x_clpriv +\n     # Economics and development\n     gdpcap_log_z + un_trade_pct_gdp + v2peedueq + v2pehealth + e_peinfmor +\n     # Conflict and disasters\n     internal_conflict_past_5 + natural_dis_count +\n     # Time and country effects\n     year_c + (1 + year_c | gwcode))\n```\n:::\n\n\nOr more formally:\n\n$$\n\\begin{aligned}\n\\text{Treatment}_{it_j} \\sim&\\ \\mathcal{N}(\\mu_{it_j}, \\sigma_y) \\\\\n\\mu_{it_j} =&\\ (\\beta_0 + b_{0_j}) + \\beta_1\\, \\text{Treatment}_{i, t-1_j} + \\beta_2\\, \\textstyle{\\sum_{\\tau = (t-2)}^{t}} \\text{Treatment}_{i\\tau} + \\\\\n&\\ \\beta_3\\, \\text{Proportion of USAID aid to foreign NGOs}_{i,t-1_j} + \\\\\n&\\ \\beta_{4 \\ldots 9}\\, \\text{Human rights \\& politics}_{it_j} + \\\\\n&\\ \\beta_{10 \\ldots 14}\\, \\text{Economics \\& development} + \\beta_{15, 16}\\, \\text{Conflict \\& disasters}_{it_j} + \\\\\n&\\ (\\beta_{17} + b_{17_j})\\, \\text{Year}_{it_j} \\\\\n\\left(\n  \\begin{array}{c} \n  b_{0_j} \\\\\n  b_{17_j}\n  \\end{array}\n\\right) \n\\sim&\\ \\text{MV}\\,\\mathcal{N}\n\\left[\n  \\left(\n    \\begin{array}{c}\n    0 \\\\\n    0 \\\\\n    \\end{array}\n  \\right)\n  , \\,\n  \\left(\n  \\begin{array}{cc}\n     \\sigma^2_{0} & \\rho_{0, 17}\\, \\sigma_{0} \\sigma_{17} \\\\ \n     \\cdots & \\sigma^2_{17}\n  \\end{array}\n\\right)\n\\right] \\\\\n\\\\\n\\beta_0 \\ldots \\beta_{17} \\sim&\\ \\operatorname{Student~\\textit{t}\\,}(\\nu = 3, \\mu = 0, \\sigma = 1.5) \\\\\n\\sigma_y, \\sigma_0, \\sigma_{17} \\sim&\\ \\operatorname{Exponential}(1) \\\\\n\\rho \\sim&\\ \\operatorname{LKJ}(2)\n\\end{aligned}\n$$\n\n:::\n\n\n## MCMC diagnostics\n\nJust to make sure everything converged nicely, we check some diagnostics for the weight models for the total barriers treatment for domestic NGO recipients. All the other models look basically the same as this—everything's fine.\n\n### Numerator\n\n::: {.panel-tabset}\n\n#### Trace plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_treatment_total_dom$model_num %>% \n  gather_draws(`^b_.*|^sd_.*|^sigma`, regex = TRUE) %>% \n  ggplot(aes(x = .iteration, y = .value, color = factor(.chain))) +\n  geom_line(linewidth = 0.1) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-num-trace-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Trank plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_treatment_total_dom$model_num %>% \n  gather_draws(`^b_.*|^sd_.*|^sigma`, regex = TRUE) %>% \n  group_by(.variable) %>% \n  mutate(draw_rank = rank(.value)) %>% \n  ggplot(aes(x = draw_rank, color = factor(.chain))) +\n  stat_bin(geom = \"step\", binwidth = 500, position = position_identity(), boundary = 0) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors() +\n  theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-num-trank-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Posterior predictive check\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwithr::with_seed(1234, {\n  pp_check(m_recip_treatment_total_dom$model_num, ndraws = 20) +\n    labs(x = \"Total NGO barriers\",\n         title = \"Numerator model\") +\n    theme_donors()\n})\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-num-ppcheck-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Denominator\n\n::: {.panel-tabset}\n\n#### Trace plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_treatment_total_dom$model_denom %>% \n  gather_draws(`^b_.*|^sd_.*|^cor_.*|^sigma`, regex = TRUE) %>% \n  ggplot(aes(x = .iteration, y = .value, color = factor(.chain))) +\n  geom_line(linewidth = 0.1) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-denom-trace-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n#### Trank plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_treatment_total_dom$model_denom %>% \n  gather_draws(`^b_.*|^sd_.*|^cor_.*|^sigma`, regex = TRUE) %>% \n  group_by(.variable) %>% \n  mutate(draw_rank = rank(.value)) %>% \n  ggplot(aes(x = draw_rank, color = factor(.chain))) +\n  stat_bin(geom = \"step\", binwidth = 500, position = position_identity(), boundary = 0) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors() +\n  theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-denom-trank-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n#### Posterior predictive check\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwithr::with_seed(1234, {\n  pp_check(m_recip_treatment_total_dom$model_denom, ndraws = 20) +\n    labs(x = \"Total NGO barriers\",\n         title = \"Denominator model\") +\n    theme_donors()\n})\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-denom-ppcheck-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n\n## Check weights\n\nIPTWs should generally have a mean of 1 and shouldn't be too incredibly high. When they're big, it's a good idea to truncate them at some reasonable level.\n\n:::: {.panel-tabset}\n\n### Total barriers\n\n::: {.panel-tabset}\n#### % of aid to domestic NGO recipients\n\nThe max weight here is 19, but there are only a handful of observations with weights that high. The average is 0.99 and the median is 0.92, which are both essentially 1, so we're good.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_total_dom$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.05    0.81    0.92    0.99    1.01   19.23\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_total_dom %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-total-oda-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### % of aid to foreign NGO recipients\n\nThe max weight here is 20, but there are only a handful of observations with weights that high. The average is 0.99 and the median is 0.92, which are both essentially 1, so we're still good.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_total_foreign$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.04    0.81    0.92    0.99    1.01   19.61\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_total_foreign %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-total-oda-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Advocacy\n\n::: {.panel-tabset}\n#### % of aid to domestic NGO recipients\n\nThe max weight here is 19 which is lovely. The average is 1.05, so we're good.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_advocacy_dom$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.01    0.65    0.78    1.05    0.90   19.27\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_advocacy_dom %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-advocacy-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### % of aid to foreign NGO recipients\n\nThe max weight here is 18 which is lovely. The average is 1.04, so we're good.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_advocacy_foreign$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.01    0.65    0.78    1.04    0.90   18.23\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_advocacy_foreign %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-advocacy-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Entry\n\n::: {.panel-tabset}\n#### % of aid to domestic NGO recipients\n\nThe max weight here is 6 which is grand. The average is 0.93, so we're golden.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_entry_dom$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.15    0.80    0.91    0.93    1.00    6.15\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_entry_dom %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-entry-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### % of aid to foreign NGO recipients\n\nThe max weight here is 6 which is grand. The average is 0.93, so we're golden.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_entry_foreign$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.14    0.79    0.90    0.93    0.99    5.79\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_entry_foreign %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-entry-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Funding\n\n::: {.panel-tabset}\n#### % of aid to domestic NGO recipients\n\nThe max weight here is 18 which is fine. The average is 1.02, so all is well.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_funding_dom$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.01    0.82    0.92    1.02    1.00   17.98\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_funding_dom %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-funding-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### % of aid to foreign NGO recipients\n\nThe max weight here is 20 which is fine. The average is 1.02, so all is well.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_funding_foreign$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.01    0.82    0.92    1.02    0.99   19.98\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_funding_foreign %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-funding-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Core civil society index\n\n::: {.panel-tabset}\n#### % of aid to domestic NGO recipients\n\nlol these blow up again. The max weight is 19,178,015,127,580, which, oh no.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_ccsi_dom$iptw)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## 0.00e+00 0.00e+00 0.00e+00 1.20e+10 0.00e+00 1.92e+13\n```\n:::\n\n\nThere aren't a lot of observations with weights that high though. Check out the counts of rows with weights greater than 50 and greater than 500—only 100ish:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\ndf_recip_iptw_ccsi_dom %>% count(iptw >= 50)\n## # A tibble: 2 × 2\n##   `iptw >= 50`     n\n##   <lgl>        <int>\n## 1 FALSE         1639\n## 2 TRUE            37\ndf_recip_iptw_ccsi_dom %>% count(iptw >= 500)\n## # A tibble: 2 × 2\n##   `iptw >= 500`     n\n##   <lgl>         <int>\n## 1 FALSE          1652\n## 2 TRUE             24\n```\n:::\n\n\nWe truncate these weights at 50.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_iptw_ccsi_dom <- bind_rows(\n  df_recip_iptw_ccsi_dom %>% mutate(threshold = 50, iptw = ifelse(iptw > threshold, threshold, iptw)),\n  df_recip_iptw_ccsi_dom %>% mutate(threshold = 500, iptw = ifelse(iptw > threshold, threshold, iptw))\n) %>% \n  mutate(threshold = paste0(\"Truncated at \", threshold),\n         threshold = fct_inorder(threshold))\n\nplot_iptw_ccsi_dom %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(bins = 50, boundary = 0) +\n  facet_wrap(vars(threshold), scales = \"free_x\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-ccsi-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### % of aid to foreign NGO recipients\n\nlol these blow up again. The max weight is 25,234,055,290,047, which, oh no.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_ccsi_foreign$iptw)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## 0.00e+00 0.00e+00 0.00e+00 1.57e+10 0.00e+00 2.52e+13\n```\n:::\n\n\nWe also truncate these weights at 50.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_iptw_ccsi_foreign <- df_recip_iptw_ccsi_foreign %>% \n  mutate(threshold = 50, iptw = ifelse(iptw > threshold, threshold, iptw)) %>% \n  mutate(threshold = paste0(\"Truncated at \", threshold),\n         threshold = fct_inorder(threshold))\n\nplot_iptw_ccsi_foreign %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(bins = 50, boundary = 0) +\n  facet_wrap(vars(threshold), scales = \"free_x\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-ccsi-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Civil society repression\n\n::: {.panel-tabset}\n#### % of aid to domestic NGO recipients\n\nThese weights are also horrendous, with a maximum weight of 5,256,086,475.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_repress_dom$iptw)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## 0.00e+00 0.00e+00 0.00e+00 3.14e+06 0.00e+00 5.26e+09\n```\n:::\n\n\nAs with the core civil society index, there aren't a lot of observations with weights that high:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\ndf_recip_iptw_repress_dom %>% count(iptw >= 50)\n## # A tibble: 2 × 2\n##   `iptw >= 50`     n\n##   <lgl>        <int>\n## 1 FALSE         1645\n## 2 TRUE            31\ndf_recip_iptw_repress_dom %>% count(iptw >= 500)\n## # A tibble: 2 × 2\n##   `iptw >= 500`     n\n##   <lgl>         <int>\n## 1 FALSE          1663\n## 2 TRUE             13\n```\n:::\n\n\nSo we truncate these weights at 50 again. Since the results from the core civil society models are basically the same when truncating at 500, we only use a truncation point of 50 here.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_recip_iptw_ccsi_dom %>% \n  mutate(threshold = 50, iptw = ifelse(iptw > threshold, threshold, iptw)) %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(bins = 50, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-csrepress-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### % of aid to foreign NGO recipients\n\nlol these blow up again. The max weight is 5,101,360,230, which, oh no.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_recip_iptw_repress_foreign$iptw)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## 0.00e+00 0.00e+00 0.00e+00 3.05e+06 0.00e+00 5.10e+09\n```\n:::\n\n\nWe also truncate these weights at 50.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_iptw_repress_foreign <- df_recip_iptw_repress_foreign %>% \n  mutate(threshold = 50, iptw = ifelse(iptw > threshold, threshold, iptw)) %>% \n  mutate(threshold = paste0(\"Truncated at \", threshold),\n         threshold = fct_inorder(threshold))\n\nplot_iptw_repress_foreign %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(bins = 50, boundary = 0) +\n  facet_wrap(vars(threshold), scales = \"free_x\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-iptws-csrepress-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n::::\n\n## Results\n\nThese are less important since we just use these treatment models to generate weights *and* because interpreting each coefficient when trying to isolate causal effects is unimportant [@WestreichGreenland:2013; @KeeleStevensonElwert:2020].\n\n:::: {.panel-tabset}\n\n### % of aid to domestic NGO recipients\n\n::: {.panel-tabset}\n\n#### Numerator\n\n\n::: {#tbl-h3-num-dom .cell layout-align=\"center\" tbl-cap='Results from all numerator models'}\n\n```{.r .cell-code}\nmodels_tbl_h3_treatment_num_dom <- models_tbl_h3_treatment_num_dom %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals in brackets\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects\", \n  \"Marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h3_treatment_num_dom,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = treatment_rows,\n             coef_map = coefs_num,\n             gof_map = gofs,\n             output = \"kableExtra\",\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2)) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\")\n```\n:::\n\n\n#### Denominator\n\n\n::: {#tbl-h3-denom-dom .cell layout-align=\"center\" tbl-cap='Results from all numerator models'}\n\n```{.r .cell-code}\nmodels_tbl_h3_treatment_denom_dom <- models_tbl_h3_treatment_denom_dom %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals in brackets\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects\", \n  \"Marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h3_treatment_denom_dom,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = treatment_rows,\n             coef_map = coefs_denom,\n             gof_map = gofs,\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2),\n             notes = notes) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\")\n```\n:::\n\n\n:::\n\n### % of aid to foreign NGO recipients\n\n::: {.panel-tabset}\n\n#### Numerator\n\n\n::: {#tbl-h3-num-foreign .cell layout-align=\"center\" tbl-cap='Results from all numerator models'}\n\n```{.r .cell-code}\nmodels_tbl_h3_treatment_num_foreign <- models_tbl_h3_treatment_num_foreign %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals in brackets\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects\", \n  \"Marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h3_treatment_num_foreign,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = treatment_rows,\n             coef_map = coefs_num,\n             gof_map = gofs,\n             output = \"kableExtra\",\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2)) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\")\n```\n:::\n\n\n#### Denominator\n\n\n::: {#tbl-h3-denom-foreign .cell layout-align=\"center\" tbl-cap='Results from all numerator models'}\n\n```{.r .cell-code}\nmodels_tbl_h3_treatment_denom_foreign <- models_tbl_h3_treatment_denom_foreign %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals in brackets\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects\", \n  \"Marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h3_treatment_denom_foreign,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = treatment_rows,\n             coef_map = coefs_denom,\n             gof_map = gofs,\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2),\n             notes = notes) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\")\n```\n:::\n\n\n:::\n\n::::\n\n\n# Outcome models\n\nOur outcome variable for these hypotheses is the proportion of USAID aid allocated to (1) domestic and (2) foreign NGOs, which are (1) bounded between 0% and 100% and (2) have a lot of zeros.\n\n\n::: {#tbl-zero-summary .cell layout-align=\"center\" tbl-cap='0s in recipient outcomes'}\n\n```{.r .cell-code}\nbind_rows(\n  `Proportion of aid to domestic NGOs` = count(df_country_aid_laws, is_zero = prop_ngo_dom == 0),\n  `Proportion of aid to foreign NGOs` = count(df_country_aid_laws, is_zero = prop_ngo_foreign == 0),\n  .id = \"Outcome\"\n) %>% \n  group_by(Outcome) %>% \n  mutate(`Number of 0s` = glue::glue(\"{n[2]} / {sum(n)}\")) %>% \n  mutate(`Proportion of 0s` = label_percent(accuracy = 0.1)(n / sum(n))) %>% \n  ungroup() %>% \n  filter(is_zero) %>% select(-is_zero, -n) %>% \n  kbl(align = c(\"l\", \"c\", \"c\")) %>% \n  kable_styling(htmltable_class = \"table table-sm\",\n                full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" table table-sm\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Outcome </th>\n   <th style=\"text-align:center;\"> Number of 0s </th>\n   <th style=\"text-align:center;\"> Proportion of 0s </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Proportion of aid to domestic NGOs </td>\n   <td style=\"text-align:center;\"> 468 / 1676 </td>\n   <td style=\"text-align:center;\"> 27.9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Proportion of aid to foreign NGOs </td>\n   <td style=\"text-align:center;\"> 390 / 1676 </td>\n   <td style=\"text-align:center;\"> 23.3% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell .column-page-inset-right layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- df_country_aid_laws %>%\n  mutate(is_zero = prop_ngo_dom == 0) %>% \n  mutate(prop_ngo_dom = ifelse(is_zero, -0.05, prop_ngo_dom))  %>%  \n  ggplot(aes(x = prop_ngo_dom)) +\n  geom_histogram(aes(fill = is_zero), binwidth = 0.05, \n                 linewidth = 0.25, boundary = 0, color = \"white\") +\n  geom_vline(xintercept = 0) + \n  scale_x_continuous(labels = label_percent()) +\n  scale_y_continuous(labels = label_comma()) +\n  scale_fill_manual(values = c(clrs$Prism[2], clrs$Prism[8]), \n                    guide = guide_legend(reverse = TRUE)) +\n  labs(x = \"Proportion of aid to domestic NGOs\", y = NULL, fill = \"Is zero?\") +\n  coord_cartesian(ylim = c(0, 1500)) +\n  theme_donors() +\n  theme(legend.position = \"bottom\")\n\np2 <- df_country_aid_laws %>%\n  mutate(is_zero = prop_ngo_foreign == 0) %>% \n  mutate(prop_ngo_foreign = ifelse(is_zero, -0.05, prop_ngo_foreign))  %>%  \n  ggplot(aes(x = prop_ngo_foreign)) +\n  geom_histogram(aes(fill = is_zero), binwidth = 0.05, \n                 linewidth = 0.25, boundary = 0, color = \"white\") +\n  geom_vline(xintercept = 0) + \n  scale_x_continuous(labels = label_percent()) +\n  scale_y_continuous(labels = label_comma()) +\n  scale_fill_manual(values = c(clrs$Prism[2], clrs$Prism[8]), \n                    guide = guide_legend(reverse = TRUE)) +\n  labs(x = \"Proportion of aid to foreign NGOs\", y = NULL, fill = \"Is zero?\") +\n  coord_cartesian(ylim = c(0, 1500)) +\n  theme_donors() +\n  theme(legend.position = \"bottom\")\n\n(p1 | p2) +\n  plot_layout(guides = \"collect\") +\n  plot_annotation(theme = theme(legend.position = \"bottom\"))\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-zero-recip-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\nBecause of this distribution, we use a zero-inflated beta family to model the outcome. [This guide to working with tricky outcomes with lots of zeros](model-tricky-outcomes.qmd#zero-inflated-models-proportions) explores all the intricacies of zero-inflated beta families, so we won't go into tons of detail here.\n\nAs with foreign aid, we’re not entirely sure what the actual underlying zero process is for the proportion of contentious aid, but from looking at the data, we know that there’s a time component—in the early 2000s, very few countries received no contentious aid. We thus model the zero-inflated part of the model with year and year squared since the year trend is parabolic and nonlinear.\n\n\n::: {.cell .column-page-inset-right layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- df_country_aid_laws %>% \n  group_by(year) %>% \n  summarize(prop_zero = mean(prop_ngo_dom == 0)) %>% \n  ggplot(aes(x = year, y = prop_zero)) +\n  geom_line(linewidth = 0.5, color = \"grey70\") +\n  geom_point(size = 1) + \n  geom_smooth(aes(color = \"y = x\"), method = \"lm\", \n              formula = y ~ x, se = FALSE) +\n  geom_smooth(aes(color = \"y = x + x<sup>2</sup>\"), method = \"lm\", \n              formula = y ~ x + I(x^2), se = FALSE) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_color_manual(values = clrs$Prism[c(3, 11)]) +\n  labs(x = NULL, y = \"Proportion of countries\\nwith zero aid to domestic NGOs\",\n       color = NULL) +\n  coord_cartesian(ylim = c(0.15, 0.45)) +\n  theme_donors() +\n  theme(legend.text = element_markdown())\n\np2 <- df_country_aid_laws %>% \n  group_by(year) %>% \n  summarize(prop_zero = mean(prop_ngo_foreign == 0)) %>% \n  ggplot(aes(x = year, y = prop_zero)) +\n  geom_line(linewidth = 0.5, color = \"grey70\") +\n  geom_point(size = 1) + \n  geom_smooth(aes(color = \"y = x\"), method = \"lm\", \n              formula = y ~ x, se = FALSE) +\n  geom_smooth(aes(color = \"y = x + x<sup>2</sup>\"), method = \"lm\", \n              formula = y ~ x + I(x^2), se = FALSE) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_color_manual(values = clrs$Prism[c(3, 11)]) +\n  labs(x = NULL, y = \"Proportion of countries\\nwith zero aid to foreign NGOs\",\n       color = NULL) +\n  coord_cartesian(ylim = c(0.15, 0.45)) +\n  theme_donors() +\n  theme(legend.text = element_markdown())\n\n(p1 | p2) +\n  plot_layout(guides = \"collect\") +\n  plot_annotation(theme = theme(legend.position = \"bottom\"))\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-prop-zero-zi-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n## Formal model and priors\n\nOur final models look like this (again with `treatment` replaced by the actual treatment column):\n\n:::: {.panel-tabset}\n\n#### Domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(prop_ngo_dom | weights(iptw) ~ treatment_lag1 + treatment_lag2_cumsum +\n     year_c + (1 + year_c | gwcode),\n   zi ~ year_c + I(year_c^2))\n```\n:::\n\n\n#### Foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(prop_ngo_foreign | weights(iptw) ~ treatment_lag1 + treatment_lag2_cumsum +\n     year_c + (1 + year_c | gwcode),\n   zi ~ year_c + I(year_c^2))\n```\n:::\n\n\n:::\n\nOr more formally:\n\n::: {.column-page-inset-right}\n\n$$\n\\begin{aligned}\n&\\ \\mathrlap{\\textbf{Zero-inflated model of proportion $i$ across time $t$ within each country $j$}} \\\\\n\\text{Proportion}_{it_j} \\sim&\\ \\mathrlap{\\begin{cases}\n0 & \\text{with probability } \\pi_{it} + [(1 - \\pi_{it}) \\times \\operatorname{Beta}(0 \\mid \\mu_{it_j}, \\phi_y)] \\\\[4pt]\n\\operatorname{Beta}(\\mu_{it_j}, \\phi_y) & \\text{with probability } (1 - \\pi_{it}) \\times \\operatorname{Beta}(\\text{Proportion}_{it_j} \\mid \\mu_{it_j}, \\phi_y)\n\\end{cases}} \\\\\n\\\\\n&\\ \\textbf{Models for distribution parameters} \\\\\n\\operatorname{logit}(\\pi_{it}) =&\\ \\gamma_0 + \\gamma_1 \\text{Year}_{it} + \\gamma_2 \\text{Year}^2_{it} & \\text{Zero-inflation process} \\\\[4pt]\n\\operatorname{logit}(\\mu_{it_j}) =&\\ \\text{IPTW}_{i, t-1_j} \\times \\Bigl[ (\\beta_0 + b_{0_j}) + \\beta_1\\, \\text{Treatment}_{i, t-1_j} + \\\\\n&\\ \\beta_2\\, \\textstyle{\\sum_{\\tau = (t-2)}^{t}} \\text{Treatment}_{i\\tau} + (\\beta_3 + b_{3_j}) \\text{Year}_{it_j} \\Bigr] & \\text{Within-country variation} \\\\[4pt]\n\\left(\n  \\begin{array}{c} \n  b_{0_j} \\\\\n  b_{3_j}\n  \\end{array}\n\\right) \n\\sim&\\ \\text{MV}\\,\\mathcal{N}\n\\left[\n  \\left(\n    \\begin{array}{c}\n    0 \\\\\n    0 \\\\\n    \\end{array}\n  \\right)\n  , \\,\n  \\left(\n  \\begin{array}{cc}\n     \\sigma^2_{0} & \\rho_{0, 3}\\, \\sigma_{0} \\sigma_{3} \\\\ \n     \\cdots & \\sigma^2_{3}\n  \\end{array}\n\\right)\n\\right] & \\text{Variability in average intercepts and slopes} \\\\\n\\\\\n&\\ \\textbf{Priors} \\\\\n\\gamma_0 \\sim&\\ \\text{Student $t$}(\\nu = 3, \\mu = 0, \\sigma = 1.5) & \\text{Prior for intercept in zero-inflated model} \\\\\n\\gamma_1, \\gamma_2 \\sim&\\ \\text{Student $t$}(3, 0, 1.5) & \\text{Prior for year effect in zero-inflated model} \\\\\n\\beta_0 \\sim&\\ \\text{Student $t$}(3, 0, 1.5) & \\text{Prior for global average proportion} \\\\\n\\beta_1, \\beta_2, \\beta_3 \\sim&\\ \\text{Student $t$}(3, 0, 1.5) & \\text{Prior for global effects} \\\\\n\\phi_y \\sim&\\ \\operatorname{Exponential}(1) & \\text{Prior for within-country dispersion} \\\\\n\\sigma_0, \\sigma_3 \\sim&\\ \\operatorname{Exponential}(1) & \\text{Prior for within-country variability} \\\\\n\\rho \\sim&\\ \\operatorname{LKJ}(2) & \\text{Prior for between-country variability}\n\\end{aligned}\n$$\n\n:::\n\n\n## MCMC diagnostics\n\nTo check that everything converged nicely, we check some diagnostics for the outcome models for the total barriers treatment for domestic NGO recipients. All the other models look basically the same as this—everything's fine.\n\n::: {.panel-tabset}\n\n### Trace plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_total_dom$model %>% \n  gather_draws(`^b_.*|^sd_.*|^phi`, regex = TRUE) %>% \n  ggplot(aes(x = .iteration, y = .value, color = factor(.chain))) +\n  geom_line(linewidth = 0.1) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-outcome-trace-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Trank plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_total_dom$model %>% \n  gather_draws(`^b_.*|^sd_.*|^phi`, regex = TRUE) %>% \n  group_by(.variable) %>% \n  mutate(draw_rank = rank(.value)) %>% \n  ggplot(aes(x = draw_rank, color = factor(.chain))) +\n  stat_bin(geom = \"step\", binwidth = 1000, position = position_identity(), boundary = 0) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors() +\n  theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-outcome-trank-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Posterior predictive check\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwithr::with_seed(1234, {\n  pp_check(m_recip_outcome_total_dom$model, ndraws = 20) +\n    labs(x = \"Proportion of aid to domestic NGOs\",\n         title = \"Outcome model\") +\n    theme_donors() +\n    coord_cartesian(xlim = c(0, 1))\n})\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-outcome-ppcheck-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n\n## Analyzing the posterior\n\n### Average treatment effects\n\n:::: {.panel-tabset}\n\n#### Total barriers\n\n::: {.panel-tabset}\n##### % of aid to domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_total_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_total_dom$model,\n                                 year_c = 0,\n                                 barriers_total = seq(0, 10, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = barriers_total, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = seq(0, 10, by = 2)) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Total barriers\", y = \"Predicted proportion of\\naid to domestic NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-total-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$total %>% \n  select(barriers_total, dydx, conf.low, conf.high)\n##    barriers_total    dydx  conf.low conf.high\n## 1               0 0.00166 -9.56e-05   0.00327\n## 2               1 0.00179 -9.52e-05   0.00376\n## 3               2 0.00193 -9.48e-05   0.00434\n## 4               3 0.00208 -9.45e-05   0.00499\n## 5               4 0.00225 -9.41e-05   0.00574\n## 6               5 0.00242 -9.38e-05   0.00657\n## 7               6 0.00260 -9.34e-05   0.00749\n## 8               7 0.00279 -9.31e-05   0.00854\n## 9               8 0.00300 -9.27e-05   0.00967\n## 10              9 0.00321 -9.23e-05   0.01086\n## 11             10 0.00344 -9.20e-05   0.01218\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_total_p_direction_dom <- mfx_recip_cfx_multiple_dom$total %>% \n  posteriordraws() %>% \n  filter(barriers_total == 1) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$total %>% \n  posteriordraws() %>% \n  filter(barriers_total %in% c(1, 7)) %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(barriers_total))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6)]) +\n  labs(x = \"Conditional effect of total barriers on\\nproportion of aid to domestic NGOs in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_total_p_direction_dom, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-total-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n##### % of aid to foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_total_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_total_foreign$model,\n                                 year_c = 0,\n                                 barriers_total = seq(0, 10, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = barriers_total, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = seq(0, 10, by = 2)) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Total barriers\", y = \"Predicted proportion of\\naid to foreign NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-total-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$total %>% \n  select(barriers_total, dydx, conf.low, conf.high)\n##    barriers_total    dydx conf.low conf.high\n## 1               0 0.00340 -0.00824    0.0142\n## 2               1 0.00342 -0.00813    0.0146\n## 3               2 0.00345 -0.00802    0.0151\n## 4               3 0.00347 -0.00788    0.0155\n## 5               4 0.00350 -0.00775    0.0159\n## 6               5 0.00352 -0.00760    0.0162\n## 7               6 0.00355 -0.00745    0.0165\n## 8               7 0.00357 -0.00729    0.0167\n## 9               8 0.00359 -0.00712    0.0169\n## 10              9 0.00361 -0.00697    0.0170\n## 11             10 0.00363 -0.00680    0.0170\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_total_p_direction_foreign <- mfx_recip_cfx_multiple_foreign$total %>% \n  posteriordraws() %>% \n  filter(barriers_total == 1) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$total %>% \n  posteriordraws() %>% \n  filter(barriers_total %in% c(1, 7)) %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(barriers_total))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6)]) +\n  labs(x = \"Conditional effect of total barriers on\\nproportion of aid to foreign NGOs in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_total_p_direction_foreign, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-total-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n:::\n\n#### Advocacy\n\n::: {.panel-tabset}\n##### % of aid to domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_advocacy_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_advocacy_dom$model,\n                                 year_c = 0,\n                                 advocacy = seq(0, 2, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = advocacy, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:2) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to advocacy\", y = \"Predicted proportion of\\naid to domestic NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-advocacy-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$advocacy %>% \n  select(advocacy, dydx, conf.low, conf.high)\n##   advocacy     dydx conf.low conf.high\n## 1        0 -0.00780 -0.02361   0.00269\n## 2        1 -0.00612 -0.01430   0.00294\n## 3        2 -0.00470 -0.00882   0.00322\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_advocacy_p_direction_dom <- mfx_recip_cfx_multiple_dom$advocacy %>% \n  posteriordraws() %>% \n  filter(advocacy == 1) %>% \n  summarize(pd = sum(draw > 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$advocacy %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(advocacy))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6)]) +\n  labs(x = \"Conditional effect of\\nbarriers to advocacy on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_advocacy_p_direction_dom, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-advocacy-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n##### % of aid to foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_advocacy_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_advocacy_foreign$model,\n                                 year_c = 0,\n                                 advocacy = seq(0, 2, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = advocacy, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:2) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to advocacy\", y = \"Predicted proportion of\\naid to foreign NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-advocacy-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$advocacy %>% \n  select(advocacy, dydx, conf.low, conf.high)\n##   advocacy   dydx conf.low conf.high\n## 1        0 0.0299  -0.0217    0.0765\n## 2        1 0.0317  -0.0208    0.0884\n## 3        2 0.0332  -0.0197    0.0923\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_advocacy_p_direction_foreign <- mfx_recip_cfx_multiple_foreign$advocacy %>% \n  posteriordraws() %>% \n  filter(advocacy == 1) %>% \n  summarize(pd = sum(draw > 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$advocacy %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(advocacy))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6)]) +\n  labs(x = \"Conditional effect of\\nbarriers to advocacy on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_advocacy_p_direction_foreign, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-advocacy-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n#### Entry\n\n::: {.panel-tabset}\n##### % of aid to domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_entry_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_entry_dom$model,\n                                 year_c = 0,\n                                 entry = seq(0, 3, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = entry, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:3) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to entry\", y = \"Predicted proportion of\\naid to domestic NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-entry-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$entry %>% \n  select(entry, dydx, conf.low, conf.high)\n##   entry    dydx  conf.low conf.high\n## 1     0 0.00357 -1.43e-05   0.00703\n## 2     1 0.00414 -1.43e-05   0.00911\n## 3     2 0.00478 -1.43e-05   0.01180\n## 4     3 0.00550 -1.43e-05   0.01519\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_entry_p_direction_dom <- mfx_recip_cfx_multiple_dom$entry %>% \n  posteriordraws() %>% \n  filter(entry == 1) %>% \n  summarize(pd = sum(draw > 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$entry %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(entry))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\nbarriers to entry on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_entry_p_direction_dom, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-entry-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n##### % of aid to foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_entry_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_entry_foreign$model,\n                                 year_c = 0,\n                                 entry = seq(0, 3, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = entry, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:3) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to entry\", y = \"Predicted proportion of\\naid to foreign NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-entry-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$entry %>% \n  select(entry, dydx, conf.low, conf.high)\n##   entry    dydx conf.low conf.high\n## 1     0 0.00927  -0.0114    0.0285\n## 2     1 0.00947  -0.0112    0.0305\n## 3     2 0.00965  -0.0109    0.0322\n## 4     3 0.00982  -0.0106    0.0334\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_entry_p_direction_foreign <- mfx_recip_cfx_multiple_foreign$entry %>% \n  posteriordraws() %>% \n  filter(entry == 1) %>% \n  summarize(pd = sum(draw > 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$entry %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(entry))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\nbarriers to entry on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_entry_p_direction_foreign, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-entry-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n#### Funding\n\n::: {.panel-tabset}\n##### % of aid to domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_funding_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_funding_dom$model,\n                                 year_c = 0,\n                                 funding = seq(0, 4, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = funding, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:4) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to funding\", y = \"Predicted proportion of\\naid to domestic NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-funding-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$funding %>% \n  select(funding, dydx, conf.low, conf.high)\n##   funding    dydx conf.low conf.high\n## 1       0 0.00394 0.000294    0.0078\n## 2       1 0.00471 0.000297    0.0107\n## 3       2 0.00561 0.000301    0.0145\n## 4       3 0.00664 0.000304    0.0194\n## 5       4 0.00782 0.000308    0.0254\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_funding_p_direction_dom <- mfx_recip_cfx_multiple_dom$funding %>% \n  posteriordraws() %>% \n  filter(funding == 1) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$funding %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(funding))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\nbarriers to funding on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_funding_p_direction_dom, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-funding-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n##### % of aid to foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_funding_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_funding_foreign$model,\n                                 year_c = 0,\n                                 funding = seq(0, 4, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = funding, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:4) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to funding\", y = \"Predicted proportion of\\naid to foreign NGOs in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-funding-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$funding %>% \n  select(funding, dydx, conf.low, conf.high)\n##   funding    dydx conf.low conf.high\n## 1       0 0.00429  -0.0202    0.0280\n## 2       1 0.00433  -0.0194    0.0297\n## 3       2 0.00437  -0.0184    0.0311\n## 4       3 0.00442  -0.0175    0.0320\n## 5       4 0.00445  -0.0165    0.0326\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_funding_p_direction_foreign <- mfx_recip_cfx_multiple_foreign$funding %>% \n  posteriordraws() %>% \n  filter(funding == 1) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$funding %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(funding))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\nbarriers to funding on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_funding_p_direction_foreign, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-funding-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n#### Core civil society index\n\n::: {.panel-tabset}\n##### % of aid to domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_ccsi_dom$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_ccsi_dom$model_50,\n                                 year_c = 0,\n                                 v2xcs_ccsi = seq(0, 1, 0.1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2xcs_ccsi, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Core civil society index\", y = \"Predicted proportion of\\naid to domestic NGOs in the following year\",\n       caption = \"Higher values represent better respect for civil society\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-ccsi-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$ccsi %>% \n  select(v2xcs_ccsi, dydx, conf.low, conf.high)\n##   v2xcs_ccsi    dydx conf.low conf.high\n## 1        0.0 0.00516  0.00291   0.00906\n## 2        0.5 0.01496  0.00846   0.02591\n## 3        1.0 0.04118  0.02294   0.07176\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_ccsi_p_direction_dom <- mfx_recip_cfx_multiple_dom$ccsi %>% \n  posteriordraws() %>% \n  filter(v2xcs_ccsi == 0.5) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$ccsi %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(v2xcs_ccsi))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\ncore civil society index on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_ccsi_p_direction_dom, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-ccsi-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n##### % of aid to foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_ccsi_foreign$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_ccsi_foreign$model_50,\n                                 year_c = 0,\n                                 v2xcs_ccsi = seq(0, 1, 0.1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2xcs_ccsi, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Core civil society index\", y = \"Predicted proportion of\\naid to foreign NGOs in the following year\",\n       caption = \"Higher values represent better respect for civil society\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-ccsi-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$ccsi %>% \n  select(v2xcs_ccsi, dydx, conf.low, conf.high)\n##   v2xcs_ccsi   dydx conf.low conf.high\n## 1        0.0 -0.293   -0.345    -0.242\n## 2        0.5 -0.267   -0.325    -0.210\n## 3        1.0 -0.195   -0.247    -0.148\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_ccsi_p_direction_foreign <- mfx_recip_cfx_multiple_foreign$ccsi %>% \n  posteriordraws() %>% \n  filter(v2xcs_ccsi == 0.5) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$ccsi %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(v2xcs_ccsi))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\ncore civil society index on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_ccsi_p_direction_foreign, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-ccsi-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n#### Civil society repression\n\n::: {.panel-tabset}\n##### % of aid to domestic NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_repress_dom$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_repress_dom$model_50,\n                                 year_c = 0,\n                                 v2csreprss = seq(-4, 3, 0.25)),\n              re_formula = NA)  %>% \n  ggplot(aes(x = v2csreprss, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Civil society repression\", y = \"Predicted proportion of\\naid to domestic NGOs in the following year\",\n       caption = \"Higher values represent better respect for civil society\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-repress-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$repress %>% \n  select(v2csreprss, dydx, conf.low, conf.high)\n##   v2csreprss      dydx conf.low conf.high\n## 1         -2 -0.001653 -0.00367 -0.000535\n## 2          0 -0.001275 -0.00254 -0.000474\n## 3          2 -0.000974 -0.00177 -0.000419\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_repress_p_direction_dom <- mfx_recip_cfx_multiple_dom$repress %>% \n  posteriordraws() %>% \n  filter(v2csreprss == 0) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_dom$repress %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(v2csreprss))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\ncivil society repression on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_repress_p_direction_dom, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-repress-dom-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n##### % of aid to foreign NGO recipients\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_recip_outcome_repress_foreign$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_repress_foreign$model_50,\n                                 year_c = 0,\n                                 v2csreprss = seq(-4, 3, 0.25)),\n              re_formula = NA)  %>% \n  ggplot(aes(x = v2csreprss, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Civil society repression\", y = \"Predicted proportion of\\naid to foreign NGOs in the following year\",\n       caption = \"Higher values represent better respect for civil society\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-range-repress-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$repress %>% \n  select(v2csreprss, dydx, conf.low, conf.high)\n##   v2csreprss    dydx conf.low conf.high\n## 1         -2 -0.0624  -0.0738   -0.0513\n## 2          0 -0.0551  -0.0677   -0.0432\n## 3          2 -0.0388  -0.0500   -0.0292\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_repress_p_direction_foreign <- mfx_recip_cfx_multiple_foreign$repress %>% \n  posteriordraws() %>% \n  filter(v2csreprss == 0) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_recip_cfx_multiple_foreign$repress %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(v2csreprss))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\ncivil society repression on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_repress_p_direction_foreign, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_aid-recipients_files/figure-html/plot-cfx-mfx-repress-foreign-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n::::\n\n\n### Combined plots\n\n#### Predictions: Proportion of aid to domestic NGOs\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nci_cols <- c(\"grey70\", \"grey45\", \"grey20\")\n\np1 <- m_recip_outcome_total_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_total_dom$model,\n                                 year_c = 0,\n                                 barriers_total = seq(0, 10, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = barriers_total, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = seq(0, 10, by = 2)) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$PurpOr[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$PurpOr[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.085)) +\n  facet_wrap(vars(\"Total barriers\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np2 <- m_recip_outcome_advocacy_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_advocacy_dom$model,\n                                 year_c = 0,\n                                 advocacy = seq(0, 2, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = advocacy, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:2) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Teal[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Teal[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.085)) +\n  facet_wrap(vars(\"Barriers to advocacy\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np3 <- m_recip_outcome_entry_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_entry_dom$model,\n                                 year_c = 0,\n                                 entry = seq(0, 3, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = entry, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:3) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Emrld[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Emrld[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.085)) +\n  facet_wrap(vars(\"Barriers to entry\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np4 <- m_recip_outcome_funding_dom$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_funding_dom$model,\n                                 year_c = 0,\n                                 funding = seq(0, 4, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = funding, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:4) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Peach[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Peach[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.085)) +\n  facet_wrap(vars(\"Barriers to funding\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Put the shared y-axis label in a separate plot and add it to the combined plot\n# https://stackoverflow.com/a/66778622/120898\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, angle = 90, size = 3.3, fontface = \"bold\",\n           label = \"Predicted proportion of\\naid to domestic NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(p_lab | \n    ((p1 | p2) / (p3 | p4) + \n       plot_layout(guides = \"collect\") + \n       plot_annotation(theme = theme(legend.position = \"bottom\")))) + \n  plot_layout(widths = c(0.05, 1))\n```\n\n::: {.cell-output-display}\n![The effect of de jure anti-NGO legal barriers on predicted proportion of USAID aid allocated to domestic NGOs in a typical country](models_aid-recipients_files/figure-html/plot-cfx-predictions-combined-dom-1.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- m_recip_outcome_ccsi_dom$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_ccsi_dom$model_50,\n                                 year_c = 0,\n                                 v2xcs_ccsi = seq(0, 1, 0.1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2xcs_ccsi, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = seq(0, 1, by = 0.25)) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Sunset[4],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Sunset[c(1, 2, 3)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.04)) +\n  facet_wrap(vars(\"Core civil society index\")) +\n  theme_donors() +\n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np2 <- m_recip_outcome_repress_dom$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_repress_dom$model_50,\n                                 year_c = 0,\n                                 v2csreprss = seq(-4, 3, 0.25)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2csreprss, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Sunset[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Sunset[c(4, 5, 6)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.04)) +\n  facet_wrap(vars(\"Improvement in civil society repression\")) +\n  theme_donors() +\n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, angle = 90, size = 3.3, fontface = \"bold\",\n           label = \"Predicted proportion of\\naid to domestic NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(p_lab | \n    ((p1 | p2) + \n       plot_layout(guides = \"collect\") + \n       plot_annotation(theme = theme(legend.position = \"bottom\")))) + \n  plot_layout(widths = c(0.05, 1))\n```\n\n::: {.cell-output-display}\n![The effect of the de facto civil society legal environment on predicted proportion of USAID aid channeled to domestic NGOs aid in a typical country](models_aid-recipients_files/figure-html/plot-cfx-predictions-defacto-dom-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n#### Conditional marginal effects: Proportion of aid to domestic NGOs\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_total_stats_dom <- mfx_recip_cfx_single_dom$total %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_advocacy_stats_dom <- mfx_recip_cfx_single_dom$advocacy %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_entry_stats_dom <- mfx_recip_cfx_single_dom$entry %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_funding_stats_dom <- mfx_recip_cfx_single_dom$funding %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_ccsi_stats_dom <- mfx_recip_cfx_single_dom$ccsi %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_repress_stats_dom <- mfx_recip_cfx_single_dom$repress %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- mfx_recip_cfx_single_dom$total %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$PurpOr[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE < 0) = {pull(mfx_total_stats_dom, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$PurpOr[4], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier of any type\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np2 <- mfx_recip_cfx_single_dom$advocacy %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Teal[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_advocacy_stats_dom, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Teal[6], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to advocacy\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np3 <- mfx_recip_cfx_single_dom$entry %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Emrld[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_entry_stats_dom, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Emrld[6], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to entry\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np4 <- mfx_recip_cfx_single_dom$funding %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Peach[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE < 0) = {pull(mfx_funding_stats_dom, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Peach[4], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to funding\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, size = 3.3, fontface = \"bold\",\n           label = \"Conditional effect of treatment on proportion\\nof aid to domestic NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(((p1 | p2) / (p3 | p4)) / p_lab) + \n  plot_layout(heights = c(1, 1, 0.1)) +\n  plot_annotation(caption = \"Point shows median value;\\nthick bar = 80% credible interval; thin bar = 95% credible interval\")\n```\n\n::: {.cell-output-display}\n![The effect of one additional de jure anti-NGO legal barrier on foreign aid in a typical country](models_aid-recipients_files/figure-html/plot-cfx-mfx-combined-dom-1.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- mfx_recip_cfx_single_dom$ccsi %>% \n  posteriordraws() %>% \n  mutate(draw = draw / 10) %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Sunset[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_ccsi_stats_dom, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Sunset[3], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"A 0.1 unit increase in\\nthe core civil society index\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np2 <- mfx_recip_cfx_single_dom$repress %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x > 0)),\n               fill = clrs$Sunset[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_repress_stats_dom, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Sunset[3], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"A 1 unit increase (improvement) in\\nthe civil society repression score\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, size = 3.3, fontface = \"bold\",\n           label = \"Conditional effect of treatment on proportion\\nof aid to domestic NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n((p1 | p2) / p_lab) + \n  plot_layout(heights = c(1, 0.15)) +\n  plot_annotation(caption = \"Point shows median value;\\nthick bar = 80% credible interval; thin bar = 95% credible interval\")\n```\n\n::: {.cell-output-display}\n![The effect of changes in the de facto civil society legal environment on predicted proportion of contentious aid in a typical country](models_aid-recipients_files/figure-html/plot-cfx-mfx-defacto-dom-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n#### Predictions: Proportion of aid to foreign NGOs\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nci_cols <- c(\"grey70\", \"grey45\", \"grey20\")\n\np1 <- m_recip_outcome_total_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_total_foreign$model,\n                                 year_c = 0,\n                                 barriers_total = seq(0, 10, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = barriers_total, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = seq(0, 10, by = 2)) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$PurpOr[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$PurpOr[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0.15, 0.42)) +\n  facet_wrap(vars(\"Total barriers\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np2 <- m_recip_outcome_advocacy_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_advocacy_foreign$model,\n                                 year_c = 0,\n                                 advocacy = seq(0, 2, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = advocacy, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:2) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Teal[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Teal[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0.15, 0.42)) +\n  facet_wrap(vars(\"Barriers to advocacy\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np3 <- m_recip_outcome_entry_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_entry_foreign$model,\n                                 year_c = 0,\n                                 entry = seq(0, 3, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = entry, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:3) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Emrld[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Emrld[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0.15, 0.42)) +\n  facet_wrap(vars(\"Barriers to entry\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np4 <- m_recip_outcome_funding_foreign$model %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_funding_foreign$model,\n                                 year_c = 0,\n                                 funding = seq(0, 4, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = funding, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:4) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Peach[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Peach[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0.15, 0.42)) +\n  facet_wrap(vars(\"Barriers to funding\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Put the shared y-axis label in a separate plot and add it to the combined plot\n# https://stackoverflow.com/a/66778622/120898\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, angle = 90, size = 3.3, fontface = \"bold\",\n           label = \"Predicted proportion of\\naid to foreign NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(p_lab | \n    ((p1 | p2) / (p3 | p4) + \n       plot_layout(guides = \"collect\") + \n       plot_annotation(theme = theme(legend.position = \"bottom\")))) + \n  plot_layout(widths = c(0.05, 1))\n```\n\n::: {.cell-output-display}\n![The effect of de jure anti-NGO legal barriers on predicted proportion of USAID aid allocated to domestic NGOs in a typical country](models_aid-recipients_files/figure-html/plot-cfx-predictions-combined-foreign-1.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- m_recip_outcome_ccsi_foreign$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_ccsi_foreign$model_50,\n                                 year_c = 0,\n                                 v2xcs_ccsi = seq(0, 1, 0.1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2xcs_ccsi, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = seq(0, 1, by = 0.25)) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Sunset[4],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Sunset[c(1, 2, 3)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.6)) +\n  facet_wrap(vars(\"Core civil society index\")) +\n  theme_donors() +\n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np2 <- m_recip_outcome_repress_foreign$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_recip_outcome_repress_foreign$model_50,\n                                 year_c = 0,\n                                 v2csreprss = seq(-4, 3, 0.25)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2csreprss, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  scale_color_manual(\n    values = clrs$Sunset[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Sunset[c(4, 5, 6)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  coord_cartesian(ylim = c(0, 0.6)) +\n  facet_wrap(vars(\"Improvement in civil society repression\")) +\n  theme_donors() +\n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, angle = 90, size = 3.3, fontface = \"bold\",\n           label = \"Predicted proportion of\\naid to foreign NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(p_lab | \n    ((p1 | p2) + \n       plot_layout(guides = \"collect\") + \n       plot_annotation(theme = theme(legend.position = \"bottom\")))) + \n  plot_layout(widths = c(0.05, 1))\n```\n\n::: {.cell-output-display}\n![The effect of the de facto civil society legal environment on predicted proportion of USAID aid channeled to foreign NGOs aid in a typical country](models_aid-recipients_files/figure-html/plot-cfx-predictions-defacto-foreign-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n#### Conditional marginal effects: Proportion of aid to foreign NGOs\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_total_stats_foreign <- mfx_recip_cfx_single_foreign$total %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_advocacy_stats_foreign <- mfx_recip_cfx_single_foreign$advocacy %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_entry_stats_foreign <- mfx_recip_cfx_single_foreign$entry %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_funding_stats_foreign <- mfx_recip_cfx_single_foreign$funding %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_ccsi_stats_foreign <- mfx_recip_cfx_single_foreign$ccsi %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_repress_stats_foreign <- mfx_recip_cfx_single_foreign$repress %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- mfx_recip_cfx_single_foreign$total %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$PurpOr[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE < 0) = {pull(mfx_total_stats_foreign, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$PurpOr[4], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier of any type\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np2 <- mfx_recip_cfx_single_foreign$advocacy %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Teal[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_advocacy_stats_foreign, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Teal[6], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to advocacy\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np3 <- mfx_recip_cfx_single_foreign$entry %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Emrld[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_entry_stats_foreign, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Emrld[6], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to entry\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np4 <- mfx_recip_cfx_single_foreign$funding %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Peach[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE < 0) = {pull(mfx_funding_stats_foreign, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Peach[4], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to funding\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, size = 3.3, fontface = \"bold\",\n           label = \"Conditional effect of treatment on proportion\\nof aid to domestic NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(((p1 | p2) / (p3 | p4)) / p_lab) + \n  plot_layout(heights = c(1, 1, 0.1)) +\n  plot_annotation(caption = \"Point shows median value;\\nthick bar = 80% credible interval; thin bar = 95% credible interval\")\n```\n\n::: {.cell-output-display}\n![The effect of one additional de jure anti-NGO legal barrier on foreign aid in a typical country](models_aid-recipients_files/figure-html/plot-cfx-mfx-combined-foreign-1.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- mfx_recip_cfx_single_foreign$ccsi %>% \n  posteriordraws() %>% \n  mutate(draw = draw / 10) %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Sunset[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_ccsi_stats_foreign, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Sunset[3], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"A 0.1 unit increase in\\nthe core civil society index\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np2 <- mfx_recip_cfx_single_foreign$repress %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x > 0)),\n               fill = clrs$Sunset[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_repress_stats_foreign, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_number(scale = 100, suffix = \" pp.\",\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Sunset[3], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"A 1 unit increase (improvement) in\\nthe civil society repression score\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, size = 3.3, fontface = \"bold\",\n           label = \"Conditional effect of treatment on proportion\\nof aid to domestic NGOs in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n((p1 | p2) / p_lab) + \n  plot_layout(heights = c(1, 0.15)) +\n  plot_annotation(caption = \"Point shows median value;\\nthick bar = 80% credible interval; thin bar = 95% credible interval\")\n```\n\n::: {.cell-output-display}\n![The effect of changes in the de facto civil society legal environment on predicted proportion of contentious aid in a typical country](models_aid-recipients_files/figure-html/plot-cfx-mfx-defacto-foreign-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n#### Table\n\nWith H~1~ we had to convert the dollar-scale treatment effects into percent changes to make them more interpretable, since we were working with millions of dollars. With this outcome, though, we're just working with a 0–100% range, so we can stick with percentage point-scale effects. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsignif_pp <- label_number(accuracy = 0.01, scale = 100, suffix = \" pp.\",\n                          style_negative = \"minus\")\n\nmfx_lookup <- tribble(\n  ~term, ~Treatment,\n  \"barriers_total\", \"One additional barrier of any type\",\n  \"advocacy\", \"One additional barrier to advocacy\",\n  \"entry\", \"One additional barrier to entry\",\n  \"funding\", \"One additional barrier to funding\",\n  \"v2xcs_ccsi\", \"A 0.1 unit increase (improvement) in the core civil society index\",\n  \"v2csreprss\", \"A 1 unit increase (improvement) in civil society repression\"\n) %>% \n  mutate(Treatment = fct_inorder(Treatment))\n\nmfx_all_posteriors_dom <- bind_rows(\n  posteriordraws(mfx_recip_cfx_single_dom$total), \n  posteriordraws(mfx_recip_cfx_single_dom$advocacy), \n  posteriordraws(mfx_recip_cfx_single_dom$entry), \n  posteriordraws(mfx_recip_cfx_single_dom$funding),\n  posteriordraws(mfx_recip_cfx_single_dom$ccsi) %>% mutate(draw = draw / 10),\n  posteriordraws(mfx_recip_cfx_single_dom$repress)) %>% \n  mutate(id = \"domestic\")\n\nmfx_all_posteriors_foreign <- bind_rows(\n  posteriordraws(mfx_recip_cfx_single_foreign$total), \n  posteriordraws(mfx_recip_cfx_single_foreign$advocacy), \n  posteriordraws(mfx_recip_cfx_single_foreign$entry), \n  posteriordraws(mfx_recip_cfx_single_foreign$funding),\n  posteriordraws(mfx_recip_cfx_single_foreign$ccsi) %>% mutate(draw = draw / 10),\n  posteriordraws(mfx_recip_cfx_single_foreign$repress)) %>% \n  mutate(id = \"foreign\")\n\nmfx_all_posteriors <- bind_rows(mfx_all_posteriors_dom,\n                                mfx_all_posteriors_foreign)\n\nmfx_pct_pt <- mfx_all_posteriors %>% \n  group_by(id, term) %>% \n  median_hdci(draw) %>%\n  mutate(across(c(draw, .lower, .upper), ~signif_pp(.))) %>% \n  mutate(interval = glue(\"[{.lower}, {.upper}]\")) %>% \n  select(id, term, draw, interval) %>% \n  pivot_longer(c(draw, interval), values_to = \"ate\") %>% \n  select(-name) %>% \n  group_by(id, term) %>% \n  mutate(row_num = row_number()) %>% \n  ungroup() %>% \n  pivot_wider(names_from = id, values_from = ate)\n\nmfx_p_direction <- mfx_all_posteriors %>% \n  group_by(id, term) %>% \n  summarize(lt0 = round(sum(draw < 0) / n(), 2),\n            gt0 = round(sum(draw > 0) / n(), 2)) %>% \n  mutate(row_num = 1) %>% \n  ungroup() %>% \n  pivot_wider(names_from = id, values_from = c(lt0, gt0))\n\nmfx_pct_pt %>% \n  left_join(mfx_p_direction, by = c(\"term\", \"row_num\")) %>% \n  left_join(mfx_lookup, by = \"term\") %>% \n  arrange(Treatment) %>% \n  mutate(Treatment = ifelse(row_num == 1, as.character(Treatment), NA)) %>% \n  select(Treatment, domestic, lt0_domestic, gt0_domestic, foreign, lt0_foreign, gt0_foreign) %>% \n  kbl(align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\", \"c\"),\n      col.names = c(\"Treatment\", \"ATE\", \"p < 0\", \"p > 0\", \"ATE\", \"p < 0\", \"p > 0\")) %>% \n  add_header_above(c(\" \" = 1, \"% of USAID aid to domestic NGOs\" = 3, \"% of USAID aid to foreign NGOs\" = 3)) %>% \n  kable_styling(htmltable_class = \"table table-sm light-border\") %>% \n  footnote(general = c(\"Reported values are posterior median conditional effects, multiplied by 100 to show percentage point changes.\", \n                       \"95% HPDI intervals shown in brackets.\"),\n           footnote_as_chunk = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" table table-sm light-border\" style=\"margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">% of USAID aid to domestic NGOs</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">% of USAID aid to foreign NGOs</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Treatment </th>\n   <th style=\"text-align:center;\"> ATE </th>\n   <th style=\"text-align:center;\"> p &lt; 0 </th>\n   <th style=\"text-align:center;\"> p &gt; 0 </th>\n   <th style=\"text-align:center;\"> ATE </th>\n   <th style=\"text-align:center;\"> p &lt; 0 </th>\n   <th style=\"text-align:center;\"> p &gt; 0 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> One additional barrier of any type </td>\n   <td style=\"text-align:center;\"> 0.18 pp. </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n   <td style=\"text-align:center;\"> 0.34 pp. </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> 0.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.01 pp., 0.37 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−0.81 pp., 1.47 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> One additional barrier to advocacy </td>\n   <td style=\"text-align:center;\"> −0.61 pp. </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 3.17 pp. </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−1.44 pp., 0.28 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−2.17 pp., 8.72 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> One additional barrier to entry </td>\n   <td style=\"text-align:center;\"> 0.41 pp. </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n   <td style=\"text-align:center;\"> 0.95 pp. </td>\n   <td style=\"text-align:center;\"> 0.18 </td>\n   <td style=\"text-align:center;\"> 0.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.02 pp., 0.89 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−1.11 pp., 3.06 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> One additional barrier to funding </td>\n   <td style=\"text-align:center;\"> 0.47 pp. </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.98 </td>\n   <td style=\"text-align:center;\"> 0.43 pp. </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n   <td style=\"text-align:center;\"> 0.64 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.01 pp., 1.02 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−1.92 pp., 2.98 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A 0.1 unit increase (improvement) in the core civil society index </td>\n   <td style=\"text-align:center;\"> 0.15 pp. </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> −2.67 pp. </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.08 pp., 0.25 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−3.24 pp., −2.09 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> A 1 unit increase (improvement) in civil society repression </td>\n   <td style=\"text-align:center;\"> −0.13 pp. </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n   <td style=\"text-align:center;\"> −5.51 pp. </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.24 pp., −0.04 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−6.74 pp., −4.30 pp.] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Reported values are posterior median conditional effects, multiplied by 100 to show percentage point changes. <sup></sup> 95% HPDI intervals shown in brackets.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n### Within- and between-country variability (φ and σs)\n\n\n\n\n\nThe $\\phi$ and $\\sigma$ terms are roughly the same across all these different models, so we'll just show the results from the total barriers + domestic NGOs model here. We have three uncertainty-related terms to work with:\n\n- $\\phi_y$ (`phi`): the precision or variance of aid contentiousness within countries. On the log scale, it's 14.51, which is 1,995,587 when unlogged or exponentiated, which is incredibly precise. That gives us a posterior distribution of the non-zero-inflated part of the model of $\\operatorname{Beta}(0.043, 1.996\\times 10^{6})$ which looks like this, very narrowly focused around the baseline average 2000 proportion:\n\n\n  ::: {.cell layout-align=\"center\"}\n  \n  ```{.r .cell-code}\n  beta_params <- m_recip_outcome_total_dom$model %>% \n    tidy(parameters = c(\"b_(Intercept)\", \"phi\"))\n  \n  beta_mu <- beta_params %>% \n    filter(term == \"b_(Intercept)\") %>% \n    pull(estimate)\n  \n  beta_phi <- beta_params %>% \n    filter(term == \"phi\") %>% \n    pull(estimate)\n  \n  ggplot() +\n    stat_function(geom = \"area\", fill = clrs$Prism[7],\n                  fun = ~dprop(., mean = plogis(beta_mu), size = exp(beta_phi))) +\n    scale_x_continuous(labels = label_percent(), limits = c(0.0425, 0.0437)) +\n    labs(title = \"Distribution of non-zero-inflated contentious aid in 2000\",\n         subtitle = glue::glue(\"Beta(µ = plogis({round(beta_mu, 2)}), φ = exp({round(beta_phi, 2)})) or Beta(µ = {round(plogis(beta_mu), 3)}, φ = {round(exp(beta_phi), 0)})\")) +\n    theme_donors()\n  ```\n  \n  ::: {.cell-output-display}\n  ![](models_aid-recipients_files/figure-html/plot-zi-phi-1.png){fig-align='center' width=70%}\n  :::\n  :::\n\n\n- $\\sigma_0$ (`sd__(Intercept)` for the `gwcode` group): the variability between countries' baseline averages, or the variability around the $b_{0_j}$ offsets. Here it's 1.48, which means that across or between countries, the proportion of contentious aid varies by 1.5ish logit units.\n\n- $\\sigma_3$ (`sd__year_c` for the `gwcode` group): the variability between countries' year effects, or the variability around the $b_{3_j}$ offsets. Here it's 0.16, which means that average year effects vary by 0.15ish logit units across or between countries.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nm_recip_outcome_total_dom$model %>% \n  tidy(parameters = c(\"sd_*\", \"phi\")) %>% \n  select(-component)\n## # A tibble: 3 × 5\n##   term                   estimate std.error conf.low conf.high\n##   <chr>                     <dbl>     <dbl>    <dbl>     <dbl>\n## 1 sd_gwcode__(Intercept)    1.48     0.131     1.25      1.76 \n## 2 sd_gwcode__year_c         0.155    0.0182    0.122     0.193\n## 3 phi                      14.5      0.804    13.0      16.1\n```\n:::\n\n\n### Full results table\n\nAgain, this is less important since we don't care about individual coefficients and instead care about conditional effects, but for the sake of full transparency (and to placate future reviewers), here's a table of all the results:\n\n::: {.panel-tabset}\n#### % of aid to domestic NGO recipients\n\n\n::: {#tbl-h3-outcome-dom .cell layout-align=\"center\" tbl-cap='Results from all outcome models'}\n\n```{.r .cell-code}\nmodels_tbl_h3_outcome_dejure_dom <- models_tbl_h3_outcome_dejure_dom %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals (HDPI) in brackets.\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects;\", \n  \"marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h3_outcome_dejure_dom,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = outcome_rows,\n             coef_map = coefs_outcome,\n             gof_map = gofs,\n             output = \"kableExtra\",\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2)) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\") %>% \n  footnote(general = notes, footnote_as_chunk = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-sm light-border\" style=\"width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> 1 </th>\n   <th style=\"text-align:center;\"> 2 </th>\n   <th style=\"text-align:center;\"> 3 </th>\n   <th style=\"text-align:center;\"> 4 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Treatment </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Total barriers (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to advocacy (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to entry (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to funding (t) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment (t − 1) </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> −0.26 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.004, 0.17] </td>\n   <td style=\"text-align:center;\"> [−0.62, 0.10] </td>\n   <td style=\"text-align:center;\"> [−0.0005, 0.32] </td>\n   <td style=\"text-align:center;\"> [0.01, 0.37] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment history </td>\n   <td style=\"text-align:center;\"> −0.004 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> −0.01 </td>\n   <td style=\"text-align:center;\"> −0.008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.01, 0.004] </td>\n   <td style=\"text-align:center;\"> [−0.02, 0.05] </td>\n   <td style=\"text-align:center;\"> [−0.03, 0.005] </td>\n   <td style=\"text-align:center;\"> [−0.02, 0.008] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:center;\"> −3.10 </td>\n   <td style=\"text-align:center;\"> −2.87 </td>\n   <td style=\"text-align:center;\"> −2.98 </td>\n   <td style=\"text-align:center;\"> −3.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−3.42, −2.78] </td>\n   <td style=\"text-align:center;\"> [−3.28, −2.46] </td>\n   <td style=\"text-align:center;\"> [−3.31, −2.65] </td>\n   <td style=\"text-align:center;\"> [−3.40, −2.79] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.0004, 0.07] </td>\n   <td style=\"text-align:center;\"> [−0.02, 0.06] </td>\n   <td style=\"text-align:center;\"> [−0.0008, 0.07] </td>\n   <td style=\"text-align:center;\"> [0.001, 0.07] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Zero-inflated part: Year </td>\n   <td style=\"text-align:center;\"> −0.24 </td>\n   <td style=\"text-align:center;\"> −0.24 </td>\n   <td style=\"text-align:center;\"> −0.18 </td>\n   <td style=\"text-align:center;\"> −0.27 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.38, −0.10] </td>\n   <td style=\"text-align:center;\"> [−0.38, −0.11] </td>\n   <td style=\"text-align:center;\"> [−0.32, −0.05] </td>\n   <td style=\"text-align:center;\"> [−0.41, −0.14] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Zero-inflated part: Year² </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.008 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.0005, 0.02] </td>\n   <td style=\"text-align:center;\"> [0.004, 0.02] </td>\n   <td style=\"text-align:center;\"> [−0.003, 0.02] </td>\n   <td style=\"text-align:center;\"> [0.004, 0.02] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Zero-inflated part: Intercept </td>\n   <td style=\"text-align:center;\"> −0.16 </td>\n   <td style=\"text-align:center;\"> −0.31 </td>\n   <td style=\"text-align:center;\"> −0.24 </td>\n   <td style=\"text-align:center;\"> −0.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.53, 0.20] </td>\n   <td style=\"text-align:center;\"> [−0.67, 0.05] </td>\n   <td style=\"text-align:center;\"> [−0.61, 0.13] </td>\n   <td style=\"text-align:center;\"> [−0.47, 0.25] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country intercept variability (\\(\\sigma_0\\) for \\(b_0\\) offsets) </td>\n   <td style=\"text-align:center;\"> 1.48 </td>\n   <td style=\"text-align:center;\"> 2.13 </td>\n   <td style=\"text-align:center;\"> 1.55 </td>\n   <td style=\"text-align:center;\"> 1.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [1.25, 1.76] </td>\n   <td style=\"text-align:center;\"> [1.79, 2.55] </td>\n   <td style=\"text-align:center;\"> [1.29, 1.87] </td>\n   <td style=\"text-align:center;\"> [1.22, 1.72] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country year variability (\\(\\sigma_3\\) for \\(b_3\\) offsets) </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.12, 0.19] </td>\n   <td style=\"text-align:center;\"> [0.18, 0.26] </td>\n   <td style=\"text-align:center;\"> [0.13, 0.20] </td>\n   <td style=\"text-align:center;\"> [0.12, 0.18] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Correlation between random intercepts and slopes (\\(\\rho\\)) </td>\n   <td style=\"text-align:center;\"> −0.75 </td>\n   <td style=\"text-align:center;\"> −0.84 </td>\n   <td style=\"text-align:center;\"> −0.76 </td>\n   <td style=\"text-align:center;\"> −0.74 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.84, −0.62] </td>\n   <td style=\"text-align:center;\"> [−0.90, −0.77] </td>\n   <td style=\"text-align:center;\"> [−0.84, −0.63] </td>\n   <td style=\"text-align:center;\"> [−0.83, −0.61] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model dispersion (\\(\\phi_y\\)) </td>\n   <td style=\"text-align:center;\"> 14.49 </td>\n   <td style=\"text-align:center;\"> 14.88 </td>\n   <td style=\"text-align:center;\"> 12.57 </td>\n   <td style=\"text-align:center;\"> 14.49 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [12.97, 16.14] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [13.30, 16.55] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [11.15, 14.12] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [13.04, 16.08] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (total) </td>\n   <td style=\"text-align:center;\"> 0.43 </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.44 </td>\n   <td style=\"text-align:center;\"> 0.42 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (marginal) </td>\n   <td style=\"text-align:center;\"> 0.008 </td>\n   <td style=\"text-align:center;\"> 0.004 </td>\n   <td style=\"text-align:center;\"> 0.008 </td>\n   <td style=\"text-align:center;\"> 0.009 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Posterior medians; 95% credible intervals (HDPI) in brackets. <sup></sup> Total \\(R^2\\) considers the variance of both population and group effects; <sup></sup> marginal \\(R^2\\) only takes population effects into account</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n#### % of aid to foreign NGO recipients\n\n\n::: {#tbl-h3-outcome-foreign .cell layout-align=\"center\" tbl-cap='Results from all outcome models'}\n\n```{.r .cell-code}\nmodels_tbl_h3_outcome_dejure_foreign <- models_tbl_h3_outcome_dejure_foreign %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals (HDPI) in brackets.\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects;\", \n  \"marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h3_outcome_dejure_foreign,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = outcome_rows,\n             coef_map = coefs_outcome,\n             gof_map = gofs,\n             output = \"kableExtra\",\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2)) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\") %>% \n  footnote(general = notes, footnote_as_chunk = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-sm light-border\" style=\"width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> 1 </th>\n   <th style=\"text-align:center;\"> 2 </th>\n   <th style=\"text-align:center;\"> 3 </th>\n   <th style=\"text-align:center;\"> 4 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Treatment </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Total barriers (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to advocacy (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to entry (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to funding (t) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment (t − 1) </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.18 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.05, 0.09] </td>\n   <td style=\"text-align:center;\"> [−0.12, 0.47] </td>\n   <td style=\"text-align:center;\"> [−0.07, 0.18] </td>\n   <td style=\"text-align:center;\"> [−0.12, 0.18] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment history </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n   <td style=\"text-align:center;\"> −0.002 </td>\n   <td style=\"text-align:center;\"> −0.002 </td>\n   <td style=\"text-align:center;\"> 0.007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.004, 0.009] </td>\n   <td style=\"text-align:center;\"> [−0.02, 0.02] </td>\n   <td style=\"text-align:center;\"> [−0.01, 0.01] </td>\n   <td style=\"text-align:center;\"> [−0.007, 0.02] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:center;\"> −0.80 </td>\n   <td style=\"text-align:center;\"> −0.78 </td>\n   <td style=\"text-align:center;\"> −0.77 </td>\n   <td style=\"text-align:center;\"> −0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−1.04, −0.56] </td>\n   <td style=\"text-align:center;\"> [−1.03, −0.53] </td>\n   <td style=\"text-align:center;\"> [−1.02, −0.54] </td>\n   <td style=\"text-align:center;\"> [−1.00, −0.54] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year </td>\n   <td style=\"text-align:center;\"> −0.05 </td>\n   <td style=\"text-align:center;\"> −0.05 </td>\n   <td style=\"text-align:center;\"> −0.04 </td>\n   <td style=\"text-align:center;\"> −0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.08, −0.02] </td>\n   <td style=\"text-align:center;\"> [−0.07, −0.02] </td>\n   <td style=\"text-align:center;\"> [−0.07, −0.02] </td>\n   <td style=\"text-align:center;\"> [−0.07, −0.02] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Zero-inflated part: Year </td>\n   <td style=\"text-align:center;\"> −0.04 </td>\n   <td style=\"text-align:center;\"> −0.06 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> −0.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.19, 0.11] </td>\n   <td style=\"text-align:center;\"> [−0.21, 0.09] </td>\n   <td style=\"text-align:center;\"> [−0.13, 0.17] </td>\n   <td style=\"text-align:center;\"> [−0.23, 0.06] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Zero-inflated part: Year² </td>\n   <td style=\"text-align:center;\"> 0.0004 </td>\n   <td style=\"text-align:center;\"> 0.006 </td>\n   <td style=\"text-align:center;\"> −0.002 </td>\n   <td style=\"text-align:center;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.01, 0.01] </td>\n   <td style=\"text-align:center;\"> [−0.006, 0.02] </td>\n   <td style=\"text-align:center;\"> [−0.01, 0.009] </td>\n   <td style=\"text-align:center;\"> [−0.007, 0.02] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Zero-inflated part: Intercept </td>\n   <td style=\"text-align:center;\"> −1.13 </td>\n   <td style=\"text-align:center;\"> −1.31 </td>\n   <td style=\"text-align:center;\"> −1.18 </td>\n   <td style=\"text-align:center;\"> −1.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−1.55, −0.73] </td>\n   <td style=\"text-align:center;\"> [−1.74, −0.90] </td>\n   <td style=\"text-align:center;\"> [−1.60, −0.78] </td>\n   <td style=\"text-align:center;\"> [−1.46, −0.65] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country intercept variability (\\(\\sigma_0\\) for \\(b_0\\) offsets) </td>\n   <td style=\"text-align:center;\"> 1.19 </td>\n   <td style=\"text-align:center;\"> 1.26 </td>\n   <td style=\"text-align:center;\"> 1.16 </td>\n   <td style=\"text-align:center;\"> 1.21 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [1.01, 1.40] </td>\n   <td style=\"text-align:center;\"> [1.07, 1.48] </td>\n   <td style=\"text-align:center;\"> [0.99, 1.37] </td>\n   <td style=\"text-align:center;\"> [1.03, 1.42] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country year variability (\\(\\sigma_3\\) for \\(b_3\\) offsets) </td>\n   <td style=\"text-align:center;\"> 0.11 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> 0.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.09, 0.14] </td>\n   <td style=\"text-align:center;\"> [0.09, 0.14] </td>\n   <td style=\"text-align:center;\"> [0.08, 0.13] </td>\n   <td style=\"text-align:center;\"> [0.09, 0.14] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Correlation between random intercepts and slopes (\\(\\rho\\)) </td>\n   <td style=\"text-align:center;\"> −0.70 </td>\n   <td style=\"text-align:center;\"> −0.73 </td>\n   <td style=\"text-align:center;\"> −0.68 </td>\n   <td style=\"text-align:center;\"> −0.71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.80, −0.55] </td>\n   <td style=\"text-align:center;\"> [−0.82, −0.58] </td>\n   <td style=\"text-align:center;\"> [−0.79, −0.52] </td>\n   <td style=\"text-align:center;\"> [−0.81, −0.57] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model dispersion (\\(\\phi_y\\)) </td>\n   <td style=\"text-align:center;\"> 8.64 </td>\n   <td style=\"text-align:center;\"> 8.65 </td>\n   <td style=\"text-align:center;\"> 8.00 </td>\n   <td style=\"text-align:center;\"> 8.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [7.93, 9.39] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [7.96, 9.39] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [7.29, 8.74] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [8.01, 9.47] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n   <td style=\"text-align:center;\"> 1676 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (total) </td>\n   <td style=\"text-align:center;\"> 0.34 </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n   <td style=\"text-align:center;\"> 0.33 </td>\n   <td style=\"text-align:center;\"> 0.35 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (marginal) </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Posterior medians; 95% credible intervals (HDPI) in brackets. <sup></sup> Total \\(R^2\\) considers the variance of both population and group effects; <sup></sup> marginal \\(R^2\\) only takes population effects into account</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "models_aid-recipients_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
{
  "hash": "f0f8465d0da4926083f6d025d69a2a1b",
  "result": {
    "markdown": "---\ntitle: \"H~1~: Effect of anti-NGO crackdown on total ODA\"\nformat:\n  html:\n    code-fold: true\n    toc-depth: 5\n    knitr:\n      opts_chunk:\n        out.width: \"80%\"\neditor_options: \n  chunk_output_type: inline\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(targets)\nlibrary(brms)\nlibrary(tidybayes)\nlibrary(broom)\nlibrary(broom.mixed)\nlibrary(modelsummary)\nlibrary(marginaleffects)\nlibrary(patchwork)\nlibrary(scales)\nlibrary(ggdist)\nlibrary(ggtext)\nlibrary(ggh4x)\nlibrary(kableExtra)\nlibrary(glue)\nlibrary(here)\n\ntar_config_set(store = here::here('_targets'),\n               script = here::here('_targets.R'))\n\nset.seed(1234)\n\n# Load stuff from targets\n# Plotting functions\ninvisible(list2env(tar_read(graphic_functions), .GlobalEnv))\ninvisible(list2env(tar_read(tbl_functions), .GlobalEnv))\nset_annotation_fonts()\n\n# Tell bayesplot to use the sunset palette for things like pp_check()\nbayesplot::color_scheme_set(clrs$Sunset[2:7])\n\n# Data\ndf_country_aid <- tar_read(country_aid_final)\ndf_country_aid_laws <- filter(df_country_aid, laws)\n\n# Treatment models\ntar_load(c(m_oda_treatment_total, m_oda_treatment_advocacy, \n           m_oda_treatment_entry, m_oda_treatment_funding, \n           m_oda_treatment_ccsi, m_oda_treatment_repress))\n\n# IPTW data\ntar_load(c(df_oda_iptw_total, df_oda_iptw_advocacy, \n           df_oda_iptw_entry, df_oda_iptw_funding,\n           df_oda_iptw_ccsi, df_oda_iptw_repress))\n\n# Outcome models\ntar_load(c(m_oda_outcome_total, m_oda_outcome_advocacy, \n           m_oda_outcome_entry, m_oda_outcome_funding,\n           m_oda_outcome_ccsi, m_oda_outcome_repress))\n\n# Marginal/conditional effects\ntar_load(c(mfx_oda_cfx_multiple, mfx_oda_cfx_single))\n\n# Results tables\ntar_load(c(models_tbl_h1_treatment_num, models_tbl_h1_treatment_denom))\ntar_load(c(models_tbl_h1_outcome_dejure, models_tbl_h1_outcome_defacto))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ninvisible(list2env(tar_read(modelsummary_functions), .GlobalEnv))\n\ntreatment_names <- c(\"Treatment\", \"Total barriers (t)\", \"Barriers to advocacy (t)\", \n                     \"Barriers to entry (t)\", \"Barriers to funding (t)\", \"CCSI (t)\",\n                     \"CS repression (t)\")\ntreatment_rows <- as.data.frame(t(treatment_names))\nattr(treatment_rows, \"position\") <- 1\n\noutcome_names <- c(\"Treatment\", \"Total barriers (t)\", \"Barriers to advocacy (t)\", \n                   \"Barriers to entry (t)\", \"Barriers to funding (t)\")\noutcome_rows <- as.data.frame(t(outcome_names))\nattr(outcome_rows, \"position\") <- 1\n```\n:::\n\n\n\n# Weight models\n\n## General idea\n\nTo create stabilized inverse probability of treatment weights (IPTW) for a continuous treatment, we calculate the ratio of two distributions:\n\n- The numerator is the probability distribution $\\phi$ of treatment $X_{it}$, given lagged treatment $X_{i, t-1}$, treatment history $\\sum_{\\tau = (t-2)}^{t} X_{i\\tau}$, and non-time-varying confounders $Z_i$\n\n- The denominator is the probability distribution $\\phi$ of treatment $X_{it}$, given lagged treatment $X_{i, t-1}$, treatment history $\\sum_{\\tau = (t-2)}^{t} X_{i\\tau}$, lagged outcome $Y_{i, t-1}$, time-varying confounders $Z_{it}$, and non-time-varying confounders $Z_i$\n\nWe then calculate the cumulative product of this ratio for each year within each country:\n\n$$\n\\text{Stabilized weights (IPTW)} = \\prod^t_{t = 1} \n\\frac{\\phi \\left(X_{it} \\mid X_{i, t-1}, \\left[\\sum_{\\tau = (t-2)}^{t} X_{i\\tau}\\right], Z_i \\right)}\n{\\phi \\left(X_{it} \\mid X_{i, t-1}, \\left[\\sum_{\\tau = (t-2)}^{t} X_{i\\tau}\\right], Y_{i, t-1}, Z_{it}, Z_i \\right)}\n$$\n\nIn general code, here's what that process looks like:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\n# We don't actually use lm() in the project; this is just a general illustration\n# of the idea of building the weights\nmodel_num <- lm(treatment ~ treatment_lag1 + treatment_lag2_cumsum + \n                  confounders_no_time)\n\ndistribution_num <- dnorm(data$treatment, \n                          mean = predict(model_num),\n                          sd = sd(residuals(model_num)))\n\nmodel_denom <- lm(treatment ~ treatment_lag1 + treatment_lag2_cumsum + \n                    outcome_lag1 + confounders_time_varying + counfounders_no_time)\n\ndistribution_denom <- dnorm(data$treatment, \n                            mean = predict(model_denom),\n                            sd = sd(residuals(model_denom)))\n\ndata <- data %>% \n  mutate(weights_ratio = distribution_num / distribution_denom) %>% \n  group_by(gwcode) %>% \n  mutate(iptw = cumprod(weights_ratio)) %>% \n  ungroup()\n```\n:::\n\n\n\n## Actual models\n\nWe identify our time-varying and time-invariant confounders based on [our causal model and *do*-calculus logic](causal-model.qmd#final-variables-to-use), and we deal with the panel structure of the data by including random intercepts for country, and both a population-level trend and random slopes for year. We use [generic weakly informative priors](https://mc-stan.org/users/documentation/case-studies/weakly_informative_shapes.html) for our model parameters.\n\n### Numerator\n\nOur numerator models look like this (but with the actual treatment variable replacing `treatment`, like `barriers_total`, `advocacy`, and so on):\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(treatment ~ treatment_lag1 + treatment_lag2_cumsum + (1 | gwcode))\n```\n:::\n\n\nOr more formally:\n\n$$\n\\begin{aligned}\n\\text{Treatment}_{it_j} &\\sim \\mathcal{N}(\\mu_{it_j}, \\sigma_y) \\\\\n\\mu_{it_j} &= (\\beta_0 + b_{0_j}) + \\beta_1 \\text{Treatment}_{i, t-1_j} + \\textstyle{\\sum_{\\tau = (t-2)}^{t}} \\text{Treatment}_{i\\tau} \\\\\nb_{0_j} &\\sim \\mathcal{N}(0, \\sigma_0) \\\\\n\\\\\n\\beta_0, \\beta_1 &\\sim \\operatorname{Student~\\textit{t}\\,}(\\nu = 3, \\mu = 0, \\sigma = 1.5) \\\\\n\\sigma_y, \\sigma_0 &\\sim \\operatorname{Exponential}(1)\n\\end{aligned}\n$$\n\n### Denominator\n\nOur denominator models look like this (but again with the actual treatment variable replacing `treatment`):\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(treatment ~ treatment_lag1 + treatment_lag2_cumsum + \n     # Lagged outcome\n     total_oda_z_lag1 +\n     # Human rights and politics\n     v2x_polyarchy + v2x_corr + v2x_rule + v2x_civlib + v2x_clphy + v2x_clpriv +\n     # Economics and development\n     gdpcap_log_z + un_trade_pct_gdp + v2peedueq + v2pehealth + e_peinfmor +\n     # Conflict and disasters\n     internal_conflict_past_5 + natural_dis_count +\n     # Time and country effects\n     year_c + (1 + year_c | gwcode))\n```\n:::\n\n\nOr more formally:\n\n$$\n\\begin{aligned}\n\\text{Treatment}_{it_j} \\sim&\\ \\mathcal{N}(\\mu_{it_j}, \\sigma_y) \\\\\n\\mu_{it_j} =&\\ (\\beta_0 + b_{0_j}) + \\beta_1\\, \\text{Treatment}_{i, t-1_j} + \\beta_2\\, \\textstyle{\\sum_{\\tau = (t-2)}^{t}} \\text{Treatment}_{i\\tau} + \\\\\n&\\ \\beta_3\\, \\text{Total ODA}_{i,t-1_j} + \\beta_{4 \\ldots 9}\\, \\text{Human rights \\& politics}_{it_j} + \\\\\n&\\ \\beta_{10 \\ldots 14}\\, \\text{Economics \\& development} + \\beta_{15, 16}\\, \\text{Conflict \\& disasters}_{it_j} + \\\\\n&\\ (\\beta_{17} + b_{17_j})\\, \\text{Year}_{it_j} \\\\\n\\left(\n  \\begin{array}{c} \n  b_{0_j} \\\\\n  b_{17_j}\n  \\end{array}\n\\right) \n\\sim&\\ \\text{MV}\\,\\mathcal{N}\n\\left[\n  \\left(\n    \\begin{array}{c}\n    0 \\\\\n    0 \\\\\n    \\end{array}\n  \\right)\n  , \\,\n  \\left(\n  \\begin{array}{cc}\n     \\sigma^2_{0} & \\rho_{0, 17}\\, \\sigma_{0} \\sigma_{17} \\\\ \n     \\cdots & \\sigma^2_{17}\n  \\end{array}\n\\right)\n\\right] \\\\\n\\\\\n\\beta_0 \\ldots \\beta_{17} \\sim&\\ \\operatorname{Student~\\textit{t}\\,}(\\nu = 3, \\mu = 0, \\sigma = 1.5) \\\\\n\\sigma_y, \\sigma_0, \\sigma_{17} \\sim&\\ \\operatorname{Exponential}(1) \\\\\n\\rho \\sim&\\ \\operatorname{LKJ}(2)\n\\end{aligned}\n$$\n\n## MCMC diagnostics\n\nJust to make sure everything converged nicely, we check some diagnostics for the weight models for the total barriers treatment. All the other models look basically the same as thisâ€”everything's fine.\n\n### Numerator\n\n::: {.panel-tabset}\n\n#### Trace plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_treatment_total$model_num %>% \n  gather_draws(`^b_.*|^sd_.*|^sigma`, regex = TRUE) %>% \n  ggplot(aes(x = .iteration, y = .value, color = factor(.chain))) +\n  geom_line(linewidth = 0.1) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-num-trace-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Trank plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_treatment_total$model_num %>% \n  gather_draws(`^b_.*|^sd_.*|^sigma`, regex = TRUE) %>% \n  group_by(.variable) %>% \n  mutate(draw_rank = rank(.value)) %>% \n  ggplot(aes(x = draw_rank, color = factor(.chain))) +\n  stat_bin(geom = \"step\", binwidth = 500, position = position_identity(), boundary = 0) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors() +\n  theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-num-trank-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Posterior predictive check\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwithr::with_seed(1234, {\n  pp_check(m_oda_treatment_total$model_num, ndraws = 20) +\n    labs(x = \"Total NGO barriers\",\n         title = \"Numerator model\") +\n    theme_donors()\n})\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-num-ppcheck-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Denominator\n\n::: {.panel-tabset}\n\n#### Trace plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_treatment_total$model_denom %>% \n  gather_draws(`^b_.*|^sd_.*|^cor_.*|^sigma`, regex = TRUE) %>% \n  ggplot(aes(x = .iteration, y = .value, color = factor(.chain))) +\n  geom_line(linewidth = 0.1) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-denom-trace-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n#### Trank plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_treatment_total$model_denom %>% \n  gather_draws(`^b_.*|^sd_.*|^cor_.*|^sigma`, regex = TRUE) %>% \n  group_by(.variable) %>% \n  mutate(draw_rank = rank(.value)) %>% \n  ggplot(aes(x = draw_rank, color = factor(.chain))) +\n  stat_bin(geom = \"step\", binwidth = 500, position = position_identity(), boundary = 0) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors() +\n  theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-denom-trank-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n#### Posterior predictive check\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwithr::with_seed(1234, {\n  pp_check(m_oda_treatment_total$model_denom, ndraws = 20) +\n    labs(x = \"Total NGO barriers\",\n         title = \"Denominator model\") +\n    theme_donors()\n})\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-denom-ppcheck-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n\n## Check weights\n\nIPTWs should generally have a mean of 1 and shouldn't be too incredibly high. When they're big, it's a good idea to truncate them at some reasonable level.\n\n::: {.panel-tabset}\n### Total barriers\n\nThe max weight here is 31, but there are only a handful of observations with weights that high. The average is 1.13 and the median is 0.91, which are both close to 1, so we're good.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_oda_iptw_total$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.05    0.78    0.91    1.13    1.00   30.65\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_oda_iptw_total %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-iptws-total-oda-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Advocacy\n\nThe max weight here is 9 which is lovely. The average is 0.94, so we're good.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_oda_iptw_advocacy$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.00    0.62    0.77    0.94    0.93    9.35\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_oda_iptw_advocacy %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-iptws-advocacy-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Entry\n\nThe max weight here is 8 which is grand. The average is 1.02, so we're golden.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_oda_iptw_entry$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.13    0.84    0.95    1.02    1.01    8.41\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_oda_iptw_entry %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-iptws-entry-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Funding\n\nThe max weight here is 14 which is fine. The average is 1.09, so all is well.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_oda_iptw_funding$iptw)\n##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##    0.01    0.82    0.91    1.09    1.00   13.72\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_oda_iptw_funding %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(binwidth = 0.5, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-iptws-funding-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Core civil society index\n\nlol these blow up. The max weight is 9,851,384,166,626, which, oh no.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_oda_iptw_ccsi$iptw)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## 0.00e+00 0.00e+00 0.00e+00 2.16e+10 0.00e+00 9.85e+12\n```\n:::\n\n\nThere aren't a lot of observations with weights that high though. Check out the counts of rows with weights greater than 50 and greater than 500â€”only 100ish:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\ndf_oda_iptw_ccsi %>% count(iptw >= 50)\n## # A tibble: 2 Ã— 2\n##   `iptw >= 50`     n\n##   <lgl>        <int>\n## 1 FALSE         3013\n## 2 TRUE           143\ndf_oda_iptw_ccsi %>% count(iptw >= 500)\n## # A tibble: 2 Ã— 2\n##   `iptw >= 500`     n\n##   <lgl>         <int>\n## 1 FALSE          3049\n## 2 TRUE            107\n```\n:::\n\n\nWe truncate these weights at 50. For robustness checks, we also truncate at 500, but (1) those models take *substantially* longer to run, and (2) the results are roughly the same.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_iptw_ccsi <- bind_rows(\n  df_oda_iptw_ccsi %>% mutate(threshold = 50, iptw = ifelse(iptw > threshold, threshold, iptw)),\n  df_oda_iptw_ccsi %>% mutate(threshold = 500, iptw = ifelse(iptw > threshold, threshold, iptw))\n) %>% \n  mutate(threshold = paste0(\"Truncated at \", threshold),\n         threshold = fct_inorder(threshold))\n\nplot_iptw_ccsi %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(bins = 50, boundary = 0) +\n  facet_wrap(vars(threshold), scales = \"free_x\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-iptws-ccsi-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Civil society repression\n\nThese weights are also horrendous, with a maximum weight of 7,628,779,434,017,474.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nsummary(df_oda_iptw_repress$iptw)\n##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n## 0.00e+00 0.00e+00 0.00e+00 7.04e+12 0.00e+00 7.63e+15\n```\n:::\n\n\nAs with the core civil society index, there aren't a lot of observations with weights that high:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\ndf_oda_iptw_repress %>% count(iptw >= 50)\n## # A tibble: 2 Ã— 2\n##   `iptw >= 50`     n\n##   <lgl>        <int>\n## 1 FALSE         2997\n## 2 TRUE           159\ndf_oda_iptw_repress %>% count(iptw >= 500)\n## # A tibble: 2 Ã— 2\n##   `iptw >= 500`     n\n##   <lgl>         <int>\n## 1 FALSE          3026\n## 2 TRUE            130\n```\n:::\n\n\nSo we truncate these weights at 50 again. Since the results from the core civil society models are basically the same when truncating at 500, we only use a truncation point of 50 here.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_oda_iptw_ccsi %>% \n  mutate(threshold = 50, iptw = ifelse(iptw > threshold, threshold, iptw)) %>% \n  ggplot(aes(x = iptw)) +\n  geom_histogram(bins = 50, boundary = 0) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-iptws-csrepress-1.png){fig-align='center' width=80%}\n:::\n:::\n\n:::\n\n\n## Results\n\nThese are less important since we just use these treatment models to generate weights *and* because interpreting each coefficient when trying to isolate causal effects is unimportant [@WestreichGreenland:2013; @KeeleStevensonElwert:2020].\n\n::: {.panel-tabset}\n\n### Numerator\n\n\n::: {#tbl-h1-num .cell layout-align=\"center\" tbl-cap='Results from all numerator models'}\n\n```{.r .cell-code}\nmodels_tbl_h1_treatment_num <- models_tbl_h1_treatment_num %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals in brackets\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects\", \n  \"Marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h1_treatment_num,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = treatment_rows,\n             coef_map = coefs_num,\n             gof_map = gofs,\n             output = \"kableExtra\",\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2)) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-sm light-border\" style=\"width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> 1 </th>\n   <th style=\"text-align:center;\"> 2 </th>\n   <th style=\"text-align:center;\"> 3 </th>\n   <th style=\"text-align:center;\"> 4 </th>\n   <th style=\"text-align:center;\"> 5 </th>\n   <th style=\"text-align:center;\"> 6 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Treatment </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Total barriers (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to advocacy (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to entry (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to funding (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> CCSI (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> CS repression (t) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment (t âˆ’ 1) </td>\n   <td style=\"text-align:center;\"> 0.99 </td>\n   <td style=\"text-align:center;\"> 1.00 </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n   <td style=\"text-align:center;\"> 0.99 </td>\n   <td style=\"text-align:center;\"> 0.83 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.97, 1.00] </td>\n   <td style=\"text-align:center;\"> [0.98, 1.01] </td>\n   <td style=\"text-align:center;\"> [0.96, 0.99] </td>\n   <td style=\"text-align:center;\"> [0.97, 1.00] </td>\n   <td style=\"text-align:center;\"> [0.81, 0.85] </td>\n   <td style=\"text-align:center;\"> [0.14, 0.14] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment history </td>\n   <td style=\"text-align:center;\"> âˆ’0.0001 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0005 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0003 </td>\n   <td style=\"text-align:center;\"> 0.0002 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0009 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0006 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, 0.001] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.0008] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.0009] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, 0.002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, âˆ’0.0005] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0008, âˆ’0.0003] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.06, 0.11] </td>\n   <td style=\"text-align:center;\"> [0.01, 0.02] </td>\n   <td style=\"text-align:center;\"> [0.04, 0.07] </td>\n   <td style=\"text-align:center;\"> [0.02, 0.04] </td>\n   <td style=\"text-align:center;\"> [0.11, 0.13] </td>\n   <td style=\"text-align:center;\"> [0.52, 0.56] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country variability (\\(\\sigma_0\\) for \\(b_0\\) offsets) </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.005 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.009 </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.001, 0.06] </td>\n   <td style=\"text-align:center;\"> [0.0002, 0.01] </td>\n   <td style=\"text-align:center;\"> [0.0007, 0.04] </td>\n   <td style=\"text-align:center;\"> [0.0005, 0.03] </td>\n   <td style=\"text-align:center;\"> [0.04, 0.06] </td>\n   <td style=\"text-align:center;\"> [0.11, 0.14] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model variability (\\(\\sigma_y\\)) </td>\n   <td style=\"text-align:center;\"> 0.47 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.24 </td>\n   <td style=\"text-align:center;\"> 0.23 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.46, 0.48] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.12, 0.12] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.24, 0.25] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.22, 0.23] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.05, 0.06] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.07, 0.07] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3272 </td>\n   <td style=\"text-align:center;\"> 3272 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (total) </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.95 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.96 </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (marginal) </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.95 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.90 </td>\n   <td style=\"text-align:center;\"> 0.65 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Denominator\n\n\n::: {#tbl-h1-denom .cell layout-align=\"center\" tbl-cap='Results from all numerator models'}\n\n```{.r .cell-code}\nmodels_tbl_h1_treatment_denom <- models_tbl_h1_treatment_denom %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals in brackets\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects\", \n  \"Marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h1_treatment_denom,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = treatment_rows,\n             coef_map = coefs_denom,\n             gof_map = gofs,\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2),\n             notes = notes) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"NAborder-bottom: 0;border-bottom: 0;border-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;\" class=\"table table-sm light-border\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> 1 </th>\n   <th style=\"text-align:center;\"> 2 </th>\n   <th style=\"text-align:center;\"> 3 </th>\n   <th style=\"text-align:center;\"> 4 </th>\n   <th style=\"text-align:center;\"> 5 </th>\n   <th style=\"text-align:center;\"> 6 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Treatment </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Total barriers (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to advocacy (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to entry (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to funding (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> CCSI (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> CS repression (t) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment (t âˆ’ 1) </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n   <td style=\"text-align:center;\"> 0.98 </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n   <td style=\"text-align:center;\"> 0.35 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.96, 0.99] </td>\n   <td style=\"text-align:center;\"> [0.96, 1.00] </td>\n   <td style=\"text-align:center;\"> [0.95, 0.98] </td>\n   <td style=\"text-align:center;\"> [0.95, 0.99] </td>\n   <td style=\"text-align:center;\"> [0.33, 0.38] </td>\n   <td style=\"text-align:center;\"> [0.04, 0.05] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment history </td>\n   <td style=\"text-align:center;\"> âˆ’0.0007 </td>\n   <td style=\"text-align:center;\"> 0.0002 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0009 </td>\n   <td style=\"text-align:center;\"> 0.00009 </td>\n   <td style=\"text-align:center;\"> âˆ’0.002 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0007 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.0007] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, 0.002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.0004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, 0.002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.003, 0.0001] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, âˆ’0.0003] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total ODA (standardized; t âˆ’ 1) </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n   <td style=\"text-align:center;\"> 0.009 </td>\n   <td style=\"text-align:center;\"> 0.004 </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0009, 0.03] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.006] </td>\n   <td style=\"text-align:center;\"> [0.0006, 0.02] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.004, 0.01] </td>\n   <td style=\"text-align:center;\"> [0.0001, 0.003] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0007, 0.003] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Polyarchy </td>\n   <td style=\"text-align:center;\"> âˆ’0.13 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> âˆ’0.10 </td>\n   <td style=\"text-align:center;\"> âˆ’0.05 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.31, 0.05] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.03, 0.07] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.20, âˆ’0.006] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.14, 0.03] </td>\n   <td style=\"text-align:center;\"> [0.001, 0.06] </td>\n   <td style=\"text-align:center;\"> [0.07, 0.13] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Corruption index </td>\n   <td style=\"text-align:center;\"> âˆ’0.13 </td>\n   <td style=\"text-align:center;\"> âˆ’0.02 </td>\n   <td style=\"text-align:center;\"> âˆ’0.05 </td>\n   <td style=\"text-align:center;\"> âˆ’0.05 </td>\n   <td style=\"text-align:center;\"> âˆ’0.03 </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.30, 0.06] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.07, 0.03] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.14, 0.05] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.14, 0.03] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.07, 0.02] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.06, 0.03] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Rule of law index </td>\n   <td style=\"text-align:center;\"> âˆ’0.15 </td>\n   <td style=\"text-align:center;\"> âˆ’0.04 </td>\n   <td style=\"text-align:center;\"> âˆ’0.04 </td>\n   <td style=\"text-align:center;\"> âˆ’0.06 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.35, 0.05] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.10, 0.02] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.15, 0.06] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.15, 0.05] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, 0.08] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.03, 0.08] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Civil liberties index </td>\n   <td style=\"text-align:center;\"> âˆ’0.44 </td>\n   <td style=\"text-align:center;\"> âˆ’0.15 </td>\n   <td style=\"text-align:center;\"> âˆ’0.15 </td>\n   <td style=\"text-align:center;\"> âˆ’0.12 </td>\n   <td style=\"text-align:center;\"> 0.86 </td>\n   <td style=\"text-align:center;\"> 1.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.97, 0.08] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.29, âˆ’0.009] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.43, 0.12] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.38, 0.14] </td>\n   <td style=\"text-align:center;\"> [0.79, 0.94] </td>\n   <td style=\"text-align:center;\"> [0.97, 1.13] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Physical violence index </td>\n   <td style=\"text-align:center;\"> 0.27 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n   <td style=\"text-align:center;\"> 0.11 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> âˆ’0.18 </td>\n   <td style=\"text-align:center;\"> âˆ’0.24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.03, 0.50] </td>\n   <td style=\"text-align:center;\"> [0.009, 0.14] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.23] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.04, 0.19] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.22, âˆ’0.14] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.28, âˆ’0.20] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Private civil liberties index </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 0.003 </td>\n   <td style=\"text-align:center;\"> âˆ’0.10 </td>\n   <td style=\"text-align:center;\"> âˆ’0.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.14, 0.42] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.14] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.07, 0.22] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.13, 0.14] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.14, âˆ’0.05] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.19, âˆ’0.09] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Log GDP/capita (standardized) </td>\n   <td style=\"text-align:center;\"> âˆ’0.02 </td>\n   <td style=\"text-align:center;\"> âˆ’0.004 </td>\n   <td style=\"text-align:center;\"> âˆ’0.007 </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n   <td style=\"text-align:center;\"> âˆ’0.02 </td>\n   <td style=\"text-align:center;\"> âˆ’0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.05, 0.006] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, 0.009] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.03, 0.002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.03, âˆ’0.007] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.04, âˆ’0.01] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Percent of GDP from trade </td>\n   <td style=\"text-align:center;\"> âˆ’0.02 </td>\n   <td style=\"text-align:center;\"> 0.004 </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n   <td style=\"text-align:center;\"> âˆ’0.009 </td>\n   <td style=\"text-align:center;\"> âˆ’0.004 </td>\n   <td style=\"text-align:center;\"> âˆ’0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.06, 0.02] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.008, 0.02] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.04, 0.009] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.03, 0.01] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.005] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.005] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Educational equality index </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0006 </td>\n   <td style=\"text-align:center;\"> âˆ’0.002 </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n   <td style=\"text-align:center;\"> âˆ’0.007 </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.04, 0.01] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.008, 0.007] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, 0.01] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, 0.002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.0002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, âˆ’0.002] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Health equality index </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> âˆ’0.002 </td>\n   <td style=\"text-align:center;\"> 0.0008 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.05] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.007, 0.01] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, 0.02] </td>\n   <td style=\"text-align:center;\"> [0.002, 0.03] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.005] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.008, 0.009] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Infant mortality rate </td>\n   <td style=\"text-align:center;\"> âˆ’0.0005 </td>\n   <td style=\"text-align:center;\"> âˆ’0.00005 </td>\n   <td style=\"text-align:center;\"> âˆ’0.00009 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0003 </td>\n   <td style=\"text-align:center;\"> 0.0001 </td>\n   <td style=\"text-align:center;\"> 0.0002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, 0.0004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0003, 0.0002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0006, 0.0004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0008, 0.00007] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0002, 0.0004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0001, 0.0006] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Internal conflict in past 5 years </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.004 </td>\n   <td style=\"text-align:center;\"> 0.005 </td>\n   <td style=\"text-align:center;\"> 0.006 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.03, 0.06] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.008, 0.02] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, 0.03] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.01, 0.03] </td>\n   <td style=\"text-align:center;\"> [0.004, 0.02] </td>\n   <td style=\"text-align:center;\"> [0.009, 0.02] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Count of natural disasters </td>\n   <td style=\"text-align:center;\"> 0.003 </td>\n   <td style=\"text-align:center;\"> 0.0008 </td>\n   <td style=\"text-align:center;\"> 0.0009 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.0002 </td>\n   <td style=\"text-align:center;\"> 0.0002 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.009] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0008, 0.002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.001, 0.004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0006, 0.001] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0007, 0.001] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:center;\"> 0.36 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.14 </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.18, 0.53] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.002, 0.09] </td>\n   <td style=\"text-align:center;\"> [0.05, 0.23] </td>\n   <td style=\"text-align:center;\"> [0.08, 0.24] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.009, 0.08] </td>\n   <td style=\"text-align:center;\"> [0.07, 0.17] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year trend </td>\n   <td style=\"text-align:center;\"> 0.006 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.003 </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.003, 0.009] </td>\n   <td style=\"text-align:center;\"> [0.00004, 0.002] </td>\n   <td style=\"text-align:center;\"> [0.001, 0.005] </td>\n   <td style=\"text-align:center;\"> [0.0008, 0.004] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.0003, 0.002] </td>\n   <td style=\"text-align:center;\"> [0.0003, 0.002] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country intercept variability (\\(\\sigma_0\\) for \\(b_0\\) offsets) </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.008 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> 0.009 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.0008, 0.05] </td>\n   <td style=\"text-align:center;\"> [0.001, 0.02] </td>\n   <td style=\"text-align:center;\"> [0.0005, 0.03] </td>\n   <td style=\"text-align:center;\"> [0.0005, 0.03] </td>\n   <td style=\"text-align:center;\"> [0.05, 0.07] </td>\n   <td style=\"text-align:center;\"> [0.07, 0.09] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country year variability (\\(\\sigma_{17}\\) for \\(b_{17}\\) offsets) </td>\n   <td style=\"text-align:center;\"> 0.003 </td>\n   <td style=\"text-align:center;\"> 0.003 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.003 </td>\n   <td style=\"text-align:center;\"> 0.004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.0002, 0.008] </td>\n   <td style=\"text-align:center;\"> [0.002, 0.004] </td>\n   <td style=\"text-align:center;\"> [0.00005, 0.003] </td>\n   <td style=\"text-align:center;\"> [0.00006, 0.003] </td>\n   <td style=\"text-align:center;\"> [0.003, 0.004] </td>\n   <td style=\"text-align:center;\"> [0.004, 0.005] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Correlation between random intercepts and slopes (\\(\\rho\\)) </td>\n   <td style=\"text-align:center;\"> 0.05 </td>\n   <td style=\"text-align:center;\"> 0.65 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.01 </td>\n   <td style=\"text-align:center;\"> âˆ’0.16 </td>\n   <td style=\"text-align:center;\"> âˆ’0.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.78, 0.82] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.11, 0.95] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.79, 0.81] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.80, 0.80] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.34, 0.04] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.32, 0.05] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model variability (\\(\\sigma_y\\)) </td>\n   <td style=\"text-align:center;\"> 0.46 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.24 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.45, 0.48] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.12, 0.12] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.24, 0.25] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.22, 0.23] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.04, 0.04] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.04, 0.05] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3011 </td>\n   <td style=\"text-align:center;\"> 3272 </td>\n   <td style=\"text-align:center;\"> 3272 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (total) </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.95 </td>\n   <td style=\"text-align:center;\"> 0.93 </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.98 </td>\n   <td style=\"text-align:center;\"> 0.97 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (marginal) </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.95 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.87 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Posterior medians; 95% credible intervals in brackets</td></tr></tfoot>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Total \\(R^2\\) considers the variance of both population and group effects</td></tr></tfoot>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Marginal \\(R^2\\) only takes population effects into account</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n# Outcome models\n\nOur outcome variable for this hypothesis is total foreign aid (ODA), which is (1) exponentially distributed and (2) has a lot of zeros. \n\n\n::: {#tbl-zero-summary .cell layout-align=\"center\" tbl-cap='0s in total ODA'}\n\n```{.r .cell-code}\ndf_country_aid_laws %>% \n  count(is_zero = total_oda == 0) %>% \n  mutate(Outcome = \"Total ODA\") %>% \n  mutate(`Number of 0s` = glue(\"{n[2]} / {sum(n)}\")) %>% \n  mutate(`Proportion of 0s` = label_percent(accuracy = 0.1)(n / sum(n))) %>% \n  filter(is_zero) %>% select(-is_zero, -n) %>% \n  kbl(align = c(\"l\", \"c\", \"c\")) %>% \n  kable_styling(htmltable_class = \"table table-sm\",\n                full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" table table-sm\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Outcome </th>\n   <th style=\"text-align:center;\"> Number of 0s </th>\n   <th style=\"text-align:center;\"> Proportion of 0s </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Total ODA </td>\n   <td style=\"text-align:center;\"> 198 / 3293 </td>\n   <td style=\"text-align:center;\"> 6.0% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell .column-page-inset-right layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_dist_unlogged <- df_country_aid_laws %>%\n  mutate(is_zero = total_oda == 0) %>% \n  mutate(total_oda = ifelse(is_zero, -0.1, total_oda))  %>%  \n  ggplot(aes(x = total_oda)) +\n  geom_histogram(aes(fill = is_zero), binwidth = 2e9, \n                 linewidth = 0.25, boundary = 0, color = \"white\") +\n  geom_vline(xintercept = 0) + \n  scale_x_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_y_continuous(labels = label_comma()) +\n  scale_fill_manual(values = c(clrs$Prism[2], clrs$Prism[8]), \n                    guide = guide_legend(reverse = TRUE)) +\n  labs(x = \"Total ODA\", y = \"Count\", fill = \"Is zero?\") +\n  theme_donors() +\n  theme(legend.position = \"bottom\")\n\nplot_dist_logged <- df_country_aid_laws %>%\n  mutate(is_zero = total_oda_log == 0) %>% \n  mutate(total_oda_log = ifelse(is_zero, -0.1, total_oda_log))  %>%  \n  ggplot(aes(x = total_oda_log)) +\n  geom_histogram(aes(fill = is_zero), binwidth = 1, \n                 linewidth = 0.25, boundary = 0, color = \"white\") +\n  geom_vline(xintercept = 0) +\n  scale_x_continuous(labels = label_math(e^.x)) +\n  scale_fill_manual(values = c(clrs$Prism[2], clrs$Prism[8]), \n                    guide = guide_legend(reverse = TRUE)) +\n  labs(x = \"Total ODA (logged)\", y = \"Count\", fill = \"Is zero?\") +\n  theme_donors() +\n  theme(legend.position = \"bottom\")\n\n(plot_dist_unlogged | plot_dist_logged) +\n  plot_layout(guides = \"collect\") +\n  plot_annotation(theme = theme(legend.position = \"bottom\"))\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-zero-oda-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\nBecause of this distribution, we use a hurdled lognormal family to model the outcome. [This guide to working with tricky outcomes with lots of zeros](model-tricky-outcomes.qmd#hurdle-models-total-aid) explores all the intricacies of hurdled lognormal models, so we won't go into tons of detail here.\n\nFollowing our marginal structural model approach, we need to run a model weighted by the stabilized inverse probability weights that includes covariates for lagged treatment $X_{i, t-1}$, treatment history $\\sum_{\\tau = (t-2)}^{t} X_{i\\tau}$, and non-time-varying confounders $Z_i$. We expand on this approach to account for the panel structure of the data by using a multilevel hierarchical model with country-specific intercepts and a year trend with country-specific offsets (following yet another guide I wrote for this project, [this one on multilevel panel data](https://www.andrewheiss.com/blog/2021/12/01/multilevel-models-panel-data-guide/)). We center the year at 2000 so that (1) the intercept is interpretable [@Schielzeth:2010] and (2) the MCMC simulation runs faster and more efficiently [@McElreath:2020 Â§13.4, pp. 420â€“422]. \n\nWeâ€™re not entirely sure what the actual underlying zero process is for foreign aid, but from looking at the data, we know that thereâ€™s a time componentâ€”before 1995 and after 2005 lots of countries received no aid. We donâ€™t know why, though. Maybe there are issues with reporting quality. Maybe some countries didnâ€™t need aid anymore (almost like a survival model, but not really, since countries can resume getting aid later after seeing a 0). Maybe there were political reasons. Itâ€™s impossible to tell, and it goes beyond the scope of our paper here. Accordingly, we model the hurdle part of the model with year and year squared since the year trend is parabolic and nonlinear.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_country_aid_laws %>% \n  group_by(year) %>% \n  summarize(prop_zero = mean(total_oda == 0)) %>% \n  ggplot(aes(x = year, y = prop_zero)) +\n  geom_line(linewidth = 0.5, color = \"grey70\") +\n  geom_point(size = 1) + \n  geom_smooth(aes(color = \"y = year + year<sup>2</sup>\"), method = \"lm\", \n              formula = y ~ x + I(x^2), se = FALSE) +\n  scale_y_continuous(labels = label_percent()) +\n  scale_color_manual(values = clrs$Prism[c(3, 11)]) +\n  labs(x = NULL, y = \"Proportion of countries with zero ODA\",\n       color = NULL) +\n  theme_donors() +\n  theme(legend.text = element_markdown())\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-prop-zero-hu-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n## Formal model and priors\n\nOur final model looks like this (again with `treatment` replaced by the actual treatment column):\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nbf(total_oda | weights(iptw) ~ treatment_lag1 + treatment_lag2_cumsum +\n     year_c + (1 + year_c | gwcode),\n   hu ~ year_c + I(year_c^2))\n```\n:::\n\n\nOr more formally:\n\n::: {.column-page-inset-right}\n\n$$\n\\begin{aligned}\n&\\ \\mathrlap{\\textbf{Hurdled model of aid $i$ across time $t$ within each country $j$}} \\\\\n\\text{Foreign aid}_{it_j} \\sim&\\ \\mathrlap{\\begin{cases}\n0 & \\text{with probability } \\pi_{it} \\\\[4pt]\n\\operatorname{Log-normal}(\\mu_{it_j}, \\sigma_y) & \\text{with probability } 1 - \\pi_{it}\n\\end{cases}} \\\\\n\\\\\n&\\ \\textbf{Models for distribution parameters} \\\\\n\\operatorname{logit}(\\pi_{it}) =&\\ \\gamma_0 + \\gamma_1 \\text{Year}_{it} + \\gamma_2 \\text{Year}^2_{it} & \\text{Zero/not-zero process} \\\\[4pt]\n\\log (\\mu_{it_j}) =&\\ \\text{IPTW}_{i, t-1_j} \\times \\Bigl[ (\\beta_0 + b_{0_j}) + \\beta_1\\, \\text{Treatment}_{i, t-1_j} + \\\\\n&\\ \\beta_2\\, \\textstyle{\\sum_{\\tau = (t-2)}^{t}} \\text{Treatment}_{i\\tau} + (\\beta_3 + b_{3_j}) \\text{Year}_{it_j} \\Bigr] & \\text{Within-country variation} \\\\[4pt]\n\\left(\n  \\begin{array}{c} \n  b_{0_j} \\\\\n  b_{3_j}\n  \\end{array}\n\\right) \n\\sim&\\ \\text{MV}\\,\\mathcal{N}\n\\left[\n  \\left(\n    \\begin{array}{c}\n    0 \\\\\n    0 \\\\\n    \\end{array}\n  \\right)\n  , \\,\n  \\left(\n  \\begin{array}{cc}\n     \\sigma^2_{0} & \\rho_{0, 3}\\, \\sigma_{0} \\sigma_{3} \\\\ \n     \\cdots & \\sigma^2_{3}\n  \\end{array}\n\\right)\n\\right] & \\text{Variability in average intercepts and slopes} \\\\\n\\\\\n&\\ \\textbf{Priors} \\\\\n\\gamma_0 \\sim&\\ \\text{Student $t$}(\\nu = 3, \\mu = -2, \\sigma = 1.5) & \\text{Prior for intercept in hurdle model} \\\\\n\\gamma_1, \\gamma_2 \\sim&\\ \\text{Student $t$}(\\nu = 3, \\mu = 0, \\sigma = 1.5) & \\text{Prior for year effect in hurdle model} \\\\\n\\beta_0 \\sim&\\ \\mathcal{N}(20, 2.5) & \\text{Prior for global average aid} \\\\\n\\beta_1, \\beta_2, \\beta_3 \\sim&\\ \\mathcal{N}(0, 2) & \\text{Prior for global effects} \\\\\n\\sigma_y, \\sigma_0, \\sigma_3 \\sim&\\ \\operatorname{Exponential}(1) & \\text{Prior for within-country variability} \\\\\n\\rho \\sim&\\ \\operatorname{LKJ}(2) & \\text{Prior for between-country variability}\n\\end{aligned}\n$$\n\n:::\n\nHere's what those priors look like:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndesign <- \"\n  AAABBB\n  CCCDDD\n  EEFFGG\n\"\n\nm_oda_outcome_total$priors %>% \n  parse_dist() %>% \n  # K = dimension of correlation matrix; \n  # ours is 2x2 here because we have one random slope\n  marginalize_lkjcorr(K = 2) %>%\n  mutate(nice_title = glue(\"**{class}**: {prior}\"),\n         stage = ifelse(dpar == \"hu\", \"Hurdle part (Ï€)\", \"Lognormal part (Âµ and Ïƒ)\")) %>% \n  mutate(nice_title = fct_inorder(nice_title)) %>% \n  ggplot(aes(y = 0, dist = .dist, args = .args, fill = prior)) +\n  stat_slab(normalize = \"panels\") +\n  scale_fill_manual(values = clrs$Prism[1:6]) +\n  facet_manual(vars(stage, nice_title), design = design, scales = \"free_x\",\n               strip = strip_nested(background_x = list(element_rect(fill = \"grey92\"), NULL),\n                                    by_layer_x = TRUE)) +\n  guides(fill = \"none\") +\n  labs(x = NULL, y = NULL) +\n  theme_donors(prior = TRUE) +\n  theme(strip.text = element_markdown())\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-outcome-priors-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n## MCMC diagnostics\n\nTo check that everything converged nicely, we check some diagnostics for the outcome models for the total barriers treatment. All the other models look basically the same as thisâ€”everything's fine.\n\n::: {.panel-tabset}\n\n### Trace plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_total$model %>% \n  gather_draws(`^b_.*|^sd_.*|^sigma`, regex = TRUE) %>% \n  ggplot(aes(x = .iteration, y = .value, color = factor(.chain))) +\n  geom_line(linewidth = 0.1) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-outcome-trace-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Trank plots\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_total$model %>% \n  gather_draws(`^b_.*|^sd_.*|^sigma`, regex = TRUE) %>% \n  group_by(.variable) %>% \n  mutate(draw_rank = rank(.value)) %>% \n  ggplot(aes(x = draw_rank, color = factor(.chain))) +\n  stat_bin(geom = \"step\", binwidth = 1000, position = position_identity(), boundary = 0) +\n  scale_color_manual(values = clrs$Sunset[3:6]) +\n  facet_wrap(vars(.variable), scales = \"free_y\") +\n  theme_donors() +\n  theme(axis.text.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-outcome-trank-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Posterior predictive check\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwithr::with_seed(1234, {\n  pp_check(m_oda_outcome_total$model, ndraws = 20) +\n    labs(x = \"Total ODA\",\n         title = \"Outcome model\") +\n    theme_donors() +\n    coord_cartesian(xlim = c(0, 5e10))\n})\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-outcome-ppcheck-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n## Analyzing the posterior\n\n### Average treatment effects (global analysis)\n\nIn this project we care most about *conditional effects*, or the effect of the treatment in a typical country, or effect of the treatment when all country-specific $b_0$ and $b_3$ estimates are set to 0. That's also what our main estimand is. We could also calculate marginal effects, or the effect of the treatment across all countries on average, which would require integrating out the random effects, but we're most interested in the effect in a typical average country instead.\n\n::: {.panel-tabset}\n#### Total barriers\n\nIn general, aid decreases slightly as additional legal barriers are added:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_total$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_total$model,\n                                 year_c = 0,\n                                 barriers_total = seq(0, 10, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = barriers_total, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = seq(0, 10, by = 2)) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Total barriers\", y = \"Predicted ODA in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-range-total-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nWe can get the exact slope of the line at different levels of de jure restriction. The effect is fairly smallâ€”only a posterior median decrease of â‰ˆ\\$6 million, with pretty huge credible intervals\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$total %>% \n  select(barriers_total, dydx, conf.low, conf.high) %>% \n  mutate(across(c(dydx, conf.low, conf.high), ~label_dollar()(.)))\n##    barriers_total        dydx     conf.low   conf.high\n## 1               0 -$7,201,245 -$42,282,553 $22,131,545\n## 2               1 -$7,102,997 -$39,506,193 $23,088,526\n## 3               2 -$7,006,358 -$36,889,075 $24,087,000\n## 4               3 -$6,913,167 -$34,431,126 $25,166,377\n## 5               4 -$6,824,501 -$32,154,131 $26,243,236\n## 6               5 -$6,735,237 -$30,000,680 $27,398,710\n## 7               6 -$6,645,998 -$28,019,560 $28,583,791\n## 8               7 -$6,554,235 -$26,259,623 $29,832,930\n## 9               8 -$6,465,525 -$24,590,457 $31,144,704\n## 10              9 -$6,377,088 -$22,974,532 $32,442,392\n## 11             10 -$6,285,187 -$21,522,151 $33,878,723\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_total_p_direction <- mfx_oda_cfx_multiple$total %>% \n  posteriordraws() %>% \n  filter(barriers_total == 1) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$total %>% \n  posteriordraws() %>% \n  filter(barriers_total %in% c(1, 7)) %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(barriers_total))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_x_continuous(labels = label_dollar(style_negative = \"minus\", scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6)]) +\n  labs(x = \"Conditional effect of\\ntotal barriers on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE < 0) = {pull(mfx_total_p_direction, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-mfx-total-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Advocacy\n\nHere, total ODA increases significantly and substantially with the addition of new barriers to advocacy, with an increase of \\$130 to \\$200 million more ODA, depending on the initial count of legal barriers. Moving from 1 to 2 represents a 24% increase in aid.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_advocacy$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_advocacy$model,\n                                 year_c = 0,\n                                 advocacy = seq(0, 2, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = advocacy, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:2) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to advocacy\", y = \"Predicted ODA in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-range-advocacy-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$advocacy %>% \n  select(advocacy, dydx, conf.low, conf.high) %>% \n  mutate(across(c(dydx, conf.low, conf.high), ~label_dollar()(.)))\n##   advocacy         dydx    conf.low    conf.high\n## 1        0 $128,867,441 $12,533,404 $247,930,738\n## 2        1 $164,448,642 $12,785,928 $386,326,487\n## 3        2 $209,827,336 $13,073,736 $610,498,461\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_advocacy_p_direction <- mfx_oda_cfx_multiple$advocacy %>% \n  posteriordraws() %>% \n  filter(advocacy == 1) %>% \n  summarize(pd = sum(draw > 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$advocacy %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(advocacy))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_x_continuous(labels = label_dollar(style_negative = \"minus\", scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6)]) +\n  labs(x = \"Conditional effect of\\nbarriers to advocacy on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_advocacy_p_direction, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-mfx-advocacy-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Entry\n\nAdding additional barriers to entry doesn't have much of an effect. It's technically positive, but the probability that the slope is greater than zero is only 0.65.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_entry$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_entry$model,\n                                 year_c = 0,\n                                 entry = seq(0, 3, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = entry, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:3) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to entry\", y = \"Predicted ODA in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-range-entry-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$entry %>% \n  select(entry, dydx, conf.low, conf.high) %>% \n  mutate(across(c(dydx, conf.low, conf.high), ~label_dollar()(.)))\n##   entry        dydx     conf.low   conf.high\n## 1     0 $11,335,864 -$51,194,545 $66,384,586\n## 2     1 $11,566,016 -$47,066,882 $74,817,143\n## 3     2 $11,815,457 -$43,418,095 $84,383,802\n## 4     3 $12,061,834 -$40,029,314 $95,315,271\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_entry_p_direction <- mfx_oda_cfx_multiple$entry %>% \n  posteriordraws() %>% \n  filter(entry == 1) %>% \n  summarize(pd = sum(draw > 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$entry %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(entry))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_x_continuous(labels = label_dollar(style_negative = \"minus\", scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Sunset[c(2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\nbarriers to entry on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_entry_p_direction, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-mfx-entry-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Funding\n\nAn additional barrier to funding leads to a 5ish% decrease in aid, but the probability that the decrease is negative is only 0.78.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_funding$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_funding$model,\n                                 year_c = 0,\n                                 funding = seq(0, 4, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = funding, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_continuous(breaks = 0:4) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Barriers to funding\", y = \"Predicted ODA in the following year\") +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-range-funding-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$funding %>% \n  select(funding, dydx, conf.low, conf.high) %>% \n  mutate(across(c(dydx, conf.low, conf.high), ~label_dollar()(.)))\n##   funding         dydx      conf.low   conf.high\n## 1       0 -$26,843,409 -$103,319,529 $41,458,580\n## 2       1 -$25,580,750  -$87,751,749 $44,531,998\n## 3       2 -$24,365,995  -$74,838,354 $47,843,966\n## 4       3 -$23,206,566  -$63,741,934 $51,361,933\n## 5       4 -$22,124,432  -$54,488,103 $55,210,300\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_funding_p_direction <- mfx_oda_cfx_multiple$funding %>% \n  posteriordraws() %>% \n  filter(funding == 1) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$funding %>% \n  posteriordraws() %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(funding))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_x_continuous(labels = label_dollar(style_negative = \"minus\", scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of\\nbarriers to funding on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_funding_p_direction, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-mfx-funding-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Core civil society index\n\nImprovements in the core civil society index lead to a tiny decrease in aid (a 1% drop, on average), and the probability that the effect is negative is 0.93. This is not an issue of punishmentâ€”donor countries aren't withholding aid as countries improve. Instead, it's helpful to think of this in reverseâ€”as civil society gets worse in a country, aid increases a tiny bit.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_ccsi$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_ccsi$model_50,\n                                 year_c = 0,\n                                 v2xcs_ccsi = seq(0, 1, 0.1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2xcs_ccsi, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_reverse() +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Core civil society index\", y = \"Predicted ODA in the following year\",\n       caption = \"**x-axis reversed**; lower values represent worse respect for civil society\") +\n  theme_donors() +\n  theme(plot.caption = element_markdown())\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-range-ccsi-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$ccsi %>% \n  select(v2xcs_ccsi, dydx, conf.low, conf.high) %>% \n  mutate(across(c(dydx, conf.low, conf.high), ~label_dollar()(.)))\n##   v2xcs_ccsi         dydx      conf.low   conf.high\n## 1        0.0 -$59,822,062 -$156,792,289 $19,403,661\n## 2        0.5 -$56,759,505 -$140,034,394 $19,743,943\n## 3        1.0 -$53,883,788 -$125,338,011 $20,081,901\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_ccsi_p_direction <- mfx_oda_cfx_multiple$ccsi %>% \n  posteriordraws() %>% \n  filter(v2xcs_ccsi == 0.5) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$ccsi %>% \n  posteriordraws() %>% \n  mutate(draw = -draw) %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(v2xcs_ccsi))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_x_continuous(labels = label_dollar(style_negative = \"minus\", scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of worsening the\\ncore civil society index on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_ccsi_p_direction, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-mfx-ccsi-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n#### Civil society repression\n\nIf we look at civil society repression in particular, we see the same effect. Improvements in civil society repression lead to 3% less aid (with p = 1 that it's negative), or in reverse, more civil society repression leads to *more* aid. This is likely driven by the barriers to advocacy that we saw earlier.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm_oda_outcome_repress$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_repress$model_50,\n                                 year_c = 0,\n                                 v2csreprss = seq(-4, 3, 0.25)),\n              re_formula = NA)  %>% \n  ggplot(aes(x = v2csreprss, y = .epred)) +\n  stat_lineribbon(color = clrs$Peach[7]) +\n  scale_x_reverse(labels = label_number(style_negative = \"minus\")) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Peach[1:3]) +\n  guides(fill = \"none\") +\n  labs(x = \"Civil society repression\", y = \"Predicted ODA in the following year\",\n       caption = \"**x-axis reversed**; lower values represent greater civil society repression\") +\n  theme_donors() +\n  theme(plot.caption = element_markdown())\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-range-repress-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$repress %>% \n  select(v2csreprss, dydx, conf.low, conf.high) %>% \n  mutate(across(c(dydx, conf.low, conf.high), ~label_dollar()(.)))\n##   v2csreprss         dydx     conf.low   conf.high\n## 1         -2 -$20,479,557 -$41,272,510 -$5,847,425\n## 2          0 -$19,141,607 -$37,152,384 -$5,719,881\n## 3          2 -$17,867,557 -$33,458,614 -$5,590,522\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_repress_p_direction <- mfx_oda_cfx_multiple$repress %>% \n  posteriordraws() %>% \n  filter(v2csreprss == 0) %>% \n  summarize(pd = sum(draw < 0) / n()) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_oda_cfx_multiple$repress %>% \n  posteriordraws() %>% \n  mutate(draw = -draw) %>% \n  pivot_longer(draw) %>% \n  ggplot(aes(x = value, fill = factor(v2csreprss))) +\n  stat_halfeye(alpha = 0.7) +\n  scale_x_continuous(labels = label_dollar(style_negative = \"minus\", scale_cut = cut_short_scale())) +\n  scale_fill_manual(values = clrs$Sunset[c(1, 2, 4, 6, 7)]) +\n  labs(x = \"Conditional effect of worsening\\ncivil society repression on ODA in the following year\", y = NULL,\n       subtitle = glue(\"P(ATE > 0) = {pull(mfx_repress_p_direction, pd_short)}\"), fill = NULL) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](models_total-aid_files/figure-html/plot-cfx-mfx-repress-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n### Combined plots\n\n#### Predictions\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nci_cols <- c(\"grey70\", \"grey45\", \"grey20\")\n\np1 <- m_oda_outcome_total$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_total$model,\n                                 year_c = 0,\n                                 barriers_total = seq(0, 10, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = barriers_total, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = seq(0, 10, by = 2)) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_color_manual(\n    values = clrs$PurpOr[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$PurpOr[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  facet_wrap(vars(\"Total barriers\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np2 <- m_oda_outcome_advocacy$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_advocacy$model,\n                                 year_c = 0,\n                                 advocacy = seq(0, 2, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = advocacy, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:2) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_color_manual(\n    values = clrs$Teal[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Teal[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  facet_wrap(vars(\"Barriers to advocacy\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np3 <- m_oda_outcome_entry$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_entry$model,\n                                 year_c = 0,\n                                 entry = seq(0, 3, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = entry, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:3) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_color_manual(\n    values = clrs$Emrld[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Emrld[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  facet_wrap(vars(\"Barriers to entry\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np4 <- m_oda_outcome_funding$model %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_funding$model,\n                                 year_c = 0,\n                                 funding = seq(0, 4, 1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = funding, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_continuous(breaks = 0:4) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_color_manual(\n    values = clrs$Peach[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Peach[c(1, 3, 5)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  facet_wrap(vars(\"Barriers to funding\")) +\n  theme_donors() + \n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Put the shared y-axis label in a separate plot and add it to the combined plot\n# https://stackoverflow.com/a/66778622/120898\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, angle = 90, size = 3.3, fontface = \"bold\",\n           label = \"Predicted ODA in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(p_lab | \n    ((p1 | p2) / (p3 | p4) + \n       plot_layout(guides = \"collect\") + \n       plot_annotation(theme = theme(legend.position = \"bottom\")))) + \n  plot_layout(widths = c(0.05, 1))\n```\n\n::: {.cell-output-display}\n![The effect of de jure anti-NGO legal barriers on predicted levels of foreign aid in a typical country](models_total-aid_files/figure-html/plot-cfx-predictions-combined-1.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- m_oda_outcome_ccsi$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_ccsi$model_50,\n                                 year_c = 0,\n                                 v2xcs_ccsi = seq(0, 1, 0.1)),\n              re_formula = NA) %>% \n  ggplot(aes(x = v2xcs_ccsi, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_reverse(breaks = seq(0, 1, by = 0.25)) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_color_manual(\n    values = clrs$Sunset[4],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Sunset[c(1, 2, 3)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\") +\n  facet_wrap(vars(\"Worsening core civil society index\")) +\n  theme_donors() +\n  theme(legend.margin = margin(l = 7.5, r = 7.5))\n\np2 <- m_oda_outcome_repress$model_50 %>% \n  epred_draws(newdata = datagrid(model = m_oda_outcome_repress$model_50,\n                                 year_c = 0,\n                                 v2csreprss = seq(-4, 3, 0.25)),\n              re_formula = NA)  %>% \n  ggplot(aes(x = v2csreprss, y = .epred)) +\n  stat_lineribbon(aes(color = \"Posterior median\"), \n                  alpha = 0.6, point_interval = median_hdci) +\n  scale_x_reverse(labels = label_number(style_negative = \"minus\")) +\n  scale_y_continuous(labels = label_dollar(scale_cut = cut_short_scale())) +\n  scale_color_manual(\n    values = clrs$Sunset[7],\n    guide = guide_legend(order = 1, \n                         override.aes = list(fill = NA, alpha = 1, color = \"black\"))\n  ) +\n  scale_fill_manual(\n    values = clrs$Sunset[c(4, 5, 6)], \n    labels = function(x) label_percent()(as.numeric(x)),\n    guide = guide_legend(order = 2, \n                         override.aes = list(color = NA, fill = ci_cols))\n  ) +\n  labs(x = NULL, y = NULL, color = NULL, fill = \"Credible interval (HPDI):\",\n       caption = \"**x-axis reversed**; lower values represent worse respect for and repression of civil society\") +\n  facet_wrap(vars(\"Worsening civil society repression\")) +\n  theme_donors() +\n  theme(legend.margin = margin(l = 7.5, r = 7.5),\n        plot.caption = element_markdown())\n\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, angle = 90, size = 3.3, fontface = \"bold\",\n           label = \"Predicted ODA in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(p_lab | \n    ((p1 | p2) + \n       plot_layout(guides = \"collect\") + \n       plot_annotation(theme = theme(legend.position = \"bottom\")))) + \n  plot_layout(widths = c(0.05, 1))\n```\n\n::: {.cell-output-display}\n![The effect of the de facto civil society legal environment on predicted levels of foreign aid in a typical country](models_total-aid_files/figure-html/plot-cfx-predictions-defacto-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n#### Conditional marginal effects\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmfx_total_stats <- mfx_oda_cfx_single$total %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_advocacy_stats <- mfx_oda_cfx_single$advocacy %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_entry_stats <- mfx_oda_cfx_single$entry %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_funding_stats <- mfx_oda_cfx_single$funding %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_ccsi_stats <- mfx_oda_cfx_single$ccsi %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n\nmfx_repress_stats <- mfx_oda_cfx_single$repress %>% \n  posteriordraws() %>% \n  summarize(pd = sum(draw < 0) / n(),\n            mad = mad(draw),\n            med_hdci = median_hdci(draw)) %>% \n  unnest(med_hdci) %>% \n  mutate(pd_short = round(pd, 2))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- mfx_oda_cfx_single$total %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$PurpOr[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE < 0) = {pull(mfx_total_stats, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_dollar(scale_cut = cut_short_scale(),\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$PurpOr[4], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier of any type\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np2 <- mfx_oda_cfx_single$advocacy %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Teal[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_advocacy_stats, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_dollar(scale_cut = cut_short_scale(),\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Teal[6], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to advocacy\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np3 <- mfx_oda_cfx_single$entry %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Emrld[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {1 - pull(mfx_entry_stats, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_dollar(scale_cut = cut_short_scale(),\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Emrld[6], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to entry\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np4 <- mfx_oda_cfx_single$funding %>% \n  posteriordraws() %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Peach[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE < 0) = {pull(mfx_funding_stats, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_dollar(scale_cut = cut_short_scale(),\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Peach[4], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"One additional barrier to funding\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, size = 3.3, fontface = \"bold\",\n           label = \"Conditional effect of treatment on ODA in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n(((p1 | p2) / (p3 | p4)) / p_lab) + \n  plot_layout(heights = c(1, 1, 0.1)) +\n  plot_annotation(caption = \"Point shows median value;\\nthick bar = 80% credible interval; thin bar = 95% credible interval\")\n```\n\n::: {.cell-output-display}\n![The effect of one additional de jure anti-NGO legal barrier on foreign aid in a typical country](models_total-aid_files/figure-html/plot-cfx-mfx-combined-1.png){fig-align='center' width=90%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- mfx_oda_cfx_single$ccsi %>% \n  posteriordraws() %>% \n  mutate(draw = -draw / 10) %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Sunset[4], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {pull(mfx_ccsi_stats, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_dollar(scale_cut = cut_short_scale(),\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Sunset[3], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"A 0.1 unit decrease (worsening) in\\nthe core civil society index\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np2 <- mfx_oda_cfx_single$repress %>% \n  posteriordraws() %>% \n  mutate(draw = -draw) %>% \n  ggplot(aes(x = draw)) +\n  stat_halfeye(aes(fill_ramp = after_stat(x < 0)),\n               fill = clrs$Sunset[6], .width = c(0.8, 0.95),\n               point_interval = median_hdci) +\n  geom_vline(xintercept = 0, linewidth = 0.25) +\n  annotate(geom = \"richtext\", label = glue(\"P(ATE > 0) = {pull(mfx_repress_stats, pd_short)}\"),\n           x = Inf, y = Inf, hjust = 1, vjust = 1, size = 3,\n           label.color = NA, label.margin = unit(rep(0.5, 4), \"lines\")) +\n  scale_x_continuous(labels = label_dollar(scale_cut = cut_short_scale(),\n                                           style_negative = \"minus\")) +\n  scale_fill_ramp_discrete(from = clrs$Sunset[3], guide = \"none\") +\n  labs(x = NULL, y = NULL, fill = NULL) +\n  facet_wrap(vars(\"A 1 unit decrease (worsening) in\\nthe civil society repression score\")) +\n  theme_donors() +\n  theme(axis.text.y = element_blank())\n\np_lab <- ggplot() + \n  annotate(geom = \"text\", x = 1, y = 1, size = 3.3, fontface = \"bold\",\n           label = \"Conditional effect of treatment on ODA in the following year\") +\n  coord_cartesian(clip = \"off\") +\n  theme_void()\n\n((p1 | p2) / p_lab) + \n  plot_layout(heights = c(1, 0.15)) +\n  plot_annotation(caption = \"Point shows median value;\\nthick bar = 80% credible interval; thin bar = 95% credible interval\")\n```\n\n::: {.cell-output-display}\n![The effect of changes in the de facto civil society legal environment on predicted levels of foreign aid in a typical country](models_total-aid_files/figure-html/plot-cfx-mfx-defacto-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n#### Table\n\nBecause of how {marginaleffects} deals with link transformations, we can't get log-scale marginal effects that incorporate the hurdle processâ€”the only way to incorporate hurdling is to use `type = \"response\"`, which uses `posterior_epred()` behind the scenes, which returns values on the dollar scale. This isn't {marginaleffects}'s fault, since `posterior_epred()` is the only way to get simultaneous results from both the non-hurdled and hurdled parts (since it's the average of the full posterior prediction, or $\\textbf{E}[\\operatorname{Hurdle\\,log-normal}(\\pi_{it}, \\mu_{it_j}, \\sigma_y)]$), and it only returns values on the original response scale.\n\nThat's great, but it can also be helpful to think of percent changes (especially with these multi-million dollar values!). Fortunately we can find percent changes pretty easily with calculus:\n\n$$\n\\text{\\% change when $x$ is $a$} = \\frac{f'(x \\mid x = a)}{f(x \\mid x = a)}\n$$\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsignif_millions <- label_dollar(accuracy = 1,\n                                prefix = \"\\\\$\",\n                                style_negative = \"minus\",\n                                scale_cut = cut_short_scale())\nsignif_pct <- label_percent(accuracy = 0.1,\n                            style_negative = \"minus\")\n\nmfx_lookup <- tribble(\n  ~term, ~Treatment,\n  \"barriers_total\", \"One additional barrier of any type\",\n  \"advocacy\", \"One additional barrier to advocacy\",\n  \"entry\", \"One additional barrier to entry\",\n  \"funding\", \"One additional barrier to funding\",\n  \"v2xcs_ccsi\", \"A 0.1 unit decrease in the core civil society index (i.e. worse environment)\",\n  \"v2csreprss\", \"A 1 unit decrease in the civil society repression score (i.e. more repression)\"\n) %>% \n  mutate(Treatment = fct_inorder(Treatment))\n\nmfx_all_posteriors <- bind_rows(\n  posteriordraws(mfx_oda_cfx_single$total), \n  posteriordraws(mfx_oda_cfx_single$advocacy), \n  posteriordraws(mfx_oda_cfx_single$entry), \n  posteriordraws(mfx_oda_cfx_single$funding),\n  (posteriordraws(mfx_oda_cfx_single$ccsi) %>% mutate(draw = draw / 10)),\n  posteriordraws(mfx_oda_cfx_single$repress)) %>% \n  mutate(draw = ifelse(term %in% c(\"v2xcs_ccsi\", \"v2csreprss\"), -draw, draw),\n         dydx = ifelse(term %in% c(\"v2xcs_ccsi\", \"v2csreprss\"), -dydx, dydx),\n         conf.low_real = ifelse(term %in% c(\"v2xcs_ccsi\", \"v2csreprss\"), -conf.high, conf.low),\n         conf.high_real = ifelse(term %in% c(\"v2xcs_ccsi\", \"v2csreprss\"), -conf.low, conf.high),\n         conf.low = conf.low_real, conf.high = conf.high_real)\n\nmfx_p_direction <- mfx_all_posteriors %>% \n  group_by(term) %>% \n  summarize(pd_lt = round(sum(draw < 0) / n(), 2),\n            pd_gt = round(sum(draw > 0) / n(), 2))\n\nmfx_medians <- mfx_all_posteriors %>% \n  mutate(pct_change = draw / predicted) %>% \n  group_by(term) %>% \n  median_hdci(draw, pct_change) %>%\n  left_join(mfx_p_direction, by = \"term\") %>% \n  mutate(direction = case_when(\n    draw > 0 ~ \"more ODA in the next year\",\n    draw < 0 ~ \"less ODA in the next year\"\n  )) %>% \n  mutate(pd = case_when(\n    draw > 0 ~ pd_gt,\n    draw < 0 ~ pd_lt\n  )) %>% \n  mutate(pd_nice = label_percent(accuracy = 1)(pd)) %>% \n  mutate(across(c(draw, draw.lower, draw.upper), ~signif_millions(.))) %>% \n  mutate(across(c(pct_change, pct_change.lower, pct_change.upper), ~signif_pct(.))) %>% \n  mutate(draw.interval = glue(\"[{draw.lower}, {draw.upper}]\")) %>% \n  mutate(pct_change.interval = glue(\"[{pct_change.lower}, {pct_change.upper}]\")) %>% \n  mutate(draw.nice = glue(\"{draw}\\n{draw.interval}\"),\n         pct_change.nice = glue(\"{pct_change}\\n{pct_change.interval}\")) %>% \n  left_join(mfx_lookup, by = \"term\")\n\nmfx_medians_with_plots <- mfx_medians %>% \n  group_by(term) %>% \n  nest() %>% \n  mutate(sparkplot = map(data, ~spark_bar(.x))) %>% \n  mutate(sparkname = glue(\"sparkplots/oda_bar_{term}\")) %>% \n  mutate(saved_plot = map2(sparkplot, sparkname, ~save_sparks(.x, .y)))\n\nmfx_median_clean <- mfx_medians_with_plots %>% \n  ungroup() %>% \n  select(-sparkplot) %>% \n  unnest_wider(saved_plot) %>% \n  unnest(data) %>% \n  arrange(Treatment)\n```\n:::\n\n::: {.cell .column-screen-inset-right layout-align=\"center\"}\n\n```{.r .cell-code}\ntbl_notes <- c(\"The probability denotes the percentage of the posterior distribution that falls above or below 0.\",\n               \"Reported values are the median posterior marginal effect of each treatment variable on the outcome, as millions of USD; 95% highest posterior density intervals (HPDI) shown in brackets.\",\n               \"The percent change value is calculated by dividing the marginal effect by the predicted value (or \\\\(f'(x \\\\mid x = a) / f(x \\\\mid x = a)\\\\)) when the count of legal barriers is set to 1 (i.e. one barrier to advocacy, one barrier to entry, etc.), when the core civil society index is set to 0.5, and when civil society repression is set to 0.\")\n\nmfx_median_clean %>% \n  mutate(Probability = \"\") %>% \n  # mutate(across(c(draw.nice, pct_change.nice), ~linebreak(., align = \"c\"))) %>%  # For LaTeX\n  mutate(across(c(draw.nice, pct_change.nice), ~str_replace(., \"\\\\n\", \"<br>\"))) %>% \n  select(Treatment, direction, Probability, draw.nice, pct_change.nice) %>% \n  set_names(c(\"Countries that addâ€¦\", \n              \"â€¦receiveâ€¦\", \n              paste0(\"Probability\", footnote_marker_symbol(1)),\n              paste0(\"Median\", footnote_marker_symbol(2)), \n              paste0(\"% change\", footnote_marker_symbol(3)))) %>% \n  kbl(align = c(\"l\", \"l\", \"c\", \"c\", \"c\"), escape = FALSE) %>% \n  kable_styling(htmltable_class = \"table table-sm table-borderless\") %>% \n  pack_rows(\"De jure legislation\", 1, 4, indent = FALSE) %>% \n  pack_rows(\"De facto enforcement\", 5, 6, indent = FALSE) %>% \n  column_spec(1, width = \"35%\") %>% \n  column_spec(2, width = \"15%\") %>% \n  column_spec(3, image = mfx_median_clean$png, width = \"14%\") %>% \n  column_spec(4, width = \"18%\") %>% \n  column_spec(5, width = \"18%\") %>% \n  footnote(symbol = tbl_notes, footnote_as_chunk = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" table table-sm table-borderless\" style=\"margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Countries that addâ€¦ </th>\n   <th style=\"text-align:left;\"> â€¦receiveâ€¦ </th>\n   <th style=\"text-align:center;\"> Probability<sup>*</sup> </th>\n   <th style=\"text-align:center;\"> Median<sup>â€ </sup> </th>\n   <th style=\"text-align:center;\"> % change<sup>â€¡</sup> </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"4\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>De jure legislation</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;width: 35%; \"> One additional barrier of any type </td>\n   <td style=\"text-align:left;width: 15%; \"> less ODA in the next year </td>\n   <td style=\"text-align:center;width: 14%; \">  <img src=\"sparkplots/oda_bar_barriers_total.png\">\n</td>\n   <td style=\"text-align:center;width: 18%; \"> âˆ’\\$7M<br>[âˆ’\\$38M, \\$24M] </td>\n   <td style=\"text-align:center;width: 18%; \"> âˆ’1.3%<br>[âˆ’7.1%, 4.5%] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 35%; \"> One additional barrier to advocacy </td>\n   <td style=\"text-align:left;width: 15%; \"> more ODA in the next year </td>\n   <td style=\"text-align:center;width: 14%; \">  <img src=\"sparkplots/oda_bar_advocacy.png\">\n</td>\n   <td style=\"text-align:center;width: 18%; \"> \\$164M<br>[âˆ’\\$326K, \\$366M] </td>\n   <td style=\"text-align:center;width: 18%; \"> 24.0%<br>[0.0%, 53.4%] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 35%; \"> One additional barrier to entry </td>\n   <td style=\"text-align:left;width: 15%; \"> more ODA in the next year </td>\n   <td style=\"text-align:center;width: 14%; \">  <img src=\"sparkplots/oda_bar_entry.png\">\n</td>\n   <td style=\"text-align:center;width: 18%; \"> \\$12M<br>[âˆ’\\$49M, \\$72M] </td>\n   <td style=\"text-align:center;width: 18%; \"> 2.0%<br>[âˆ’8.6%, 12.6%] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 35%; \"> One additional barrier to funding </td>\n   <td style=\"text-align:left;width: 15%; \"> less ODA in the next year </td>\n   <td style=\"text-align:center;width: 14%; \">  <img src=\"sparkplots/oda_bar_funding.png\">\n</td>\n   <td style=\"text-align:center;width: 18%; \"> âˆ’\\$26M<br>[âˆ’\\$88M, \\$45M] </td>\n   <td style=\"text-align:center;width: 18%; \"> âˆ’4.7%<br>[âˆ’16.0%, 8.1%] </td>\n  </tr>\n  <tr grouplength=\"2\"><td colspan=\"5\" style=\"border-bottom: 1px solid;\"><strong>De facto enforcement</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;width: 35%; \"> A 0.1 unit decrease in the core civil society index (i.e. worse environment) </td>\n   <td style=\"text-align:left;width: 15%; \"> more ODA in the next year </td>\n   <td style=\"text-align:center;width: 14%; \">  <img src=\"sparkplots/oda_bar_v2xcs_ccsi.png\">\n</td>\n   <td style=\"text-align:center;width: 18%; \"> \\$6M<br>[âˆ’\\$2M, \\$14M] </td>\n   <td style=\"text-align:center;width: 18%; \"> 1.0%<br>[âˆ’0.4%, 2.5%] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 35%; \"> A 1 unit decrease in the civil society repression score (i.e. more repression) </td>\n   <td style=\"text-align:left;width: 15%; \"> more ODA in the next year </td>\n   <td style=\"text-align:center;width: 14%; \">  <img src=\"sparkplots/oda_bar_v2csreprss.png\">\n</td>\n   <td style=\"text-align:center;width: 18%; \"> \\$19M<br>[\\$5M, \\$36M] </td>\n   <td style=\"text-align:center;width: 18%; \"> 3.3%<br>[0.8%, 6.2%] </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup>*</sup> The probability denotes the percentage of the posterior distribution that falls above or below 0.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup>â€ </sup> Reported values are the median posterior marginal effect of each treatment variable on the outcome, as millions of USD; 95% highest posterior density intervals (HPDI) shown in brackets.</td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup>â€¡</sup> The percent change value is calculated by dividing the marginal effect by the predicted value (or \\(f'(x \\mid x = a) / f(x \\mid x = a)\\)) when the count of legal barriers is set to 1 (i.e. one barrier to advocacy, one barrier to entry, etc.), when the core civil society index is set to 0.5, and when civil society repression is set to 0.</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n### Within- and between-country variability\n\n\n\n\n\nThe $\\sigma$ terms are roughly the same across all these different models, so we'll just show the results from the total barriers model here. We have three $\\sigma$ terms to work with:\n\n- $\\sigma_y$ (`sd__Observation`): This is 0.858, which means that within any country, their total ODA varies by 0.9 logged units, so if their baseline is $e^{19}$, their total aid will bounce around between $e^{18.1}$ and $e^{19.9}$.\n- $\\sigma_0$ (`sd__(Intercept)` for the `gwcode` group): This is the variability between countries' baseline averages, or the variability around the $b_{0_j}$ offsets. Here it's 1.52, which means that across or between countries, total ODA varies by 1.5 logged units.\n- $\\sigma_3$ (`sd__year_c` for the `gwcode` group): the variability between countries' year effects, or the variability around the $b_{3_j}$ offsets. Here it's 0.096, which means that average year effects vary by 10ish% across or between countries.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nm_oda_outcome_total$model %>% \n  tidy(effects = \"ran_pars\") %>% \n  select(-component, -effect) %>% \n  filter(!str_starts(term, \"cor\"))\n## # A tibble: 3 Ã— 6\n##   group    term            estimate std.error conf.low conf.high\n##   <chr>    <chr>              <dbl>     <dbl>    <dbl>     <dbl>\n## 1 gwcode   sd__(Intercept)   1.52     0.0934    1.35       1.71 \n## 2 gwcode   sd__year_c        0.0958   0.00718   0.0828     0.111\n## 3 Residual sd__Observation   0.858    0.0110    0.837      0.880\n```\n:::\n\n\n\n### Full results table\n\nAgain, this is less important since we don't care about individual coefficients and instead care about conditional effects, but for the sake of full transparency (and to placate future reviewers), here's a table of all the results:\n\n\n::: {#tbl-h1-outcome .cell layout-align=\"center\" tbl-cap='Results from all outcome models'}\n\n```{.r .cell-code}\nmodels_tbl_h1_outcome_dejure <- models_tbl_h1_outcome_dejure %>% \n  set_names(1:length(.))\n\nnotes <- c(\n  \"Posterior medians; 95% credible intervals (HDPI) in brackets.\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects;\", \n  \"marginal \\\\(R^2\\\\) only takes population effects into account\"\n)\n\nmodelsummary(models_tbl_h1_outcome_dejure,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             add_rows = outcome_rows,\n             coef_map = coefs_outcome,\n             gof_map = gofs,\n             output = \"kableExtra\",\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2)) %>% \n  row_spec(1, bold = TRUE) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\") %>% \n  footnote(general = notes, footnote_as_chunk = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-sm light-border\" style=\"width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> 1 </th>\n   <th style=\"text-align:center;\"> 2 </th>\n   <th style=\"text-align:center;\"> 3 </th>\n   <th style=\"text-align:center;\"> 4 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Treatment </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Total barriers (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to advocacy (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to entry (t) </td>\n   <td style=\"text-align:center;font-weight: bold;\"> Barriers to funding (t) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment (t âˆ’ 1) </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n   <td style=\"text-align:center;\"> 0.24 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> âˆ’0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.07, 0.04] </td>\n   <td style=\"text-align:center;\"> [0.02, 0.46] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.08, 0.12] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.17, 0.07] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Treatment history </td>\n   <td style=\"text-align:center;\"> âˆ’0.01 </td>\n   <td style=\"text-align:center;\"> âˆ’0.04 </td>\n   <td style=\"text-align:center;\"> âˆ’0.02 </td>\n   <td style=\"text-align:center;\"> âˆ’0.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.02, âˆ’0.005] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.07, âˆ’0.02] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.03, âˆ’0.002] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.04, âˆ’0.007] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept </td>\n   <td style=\"text-align:center;\"> 19.95 </td>\n   <td style=\"text-align:center;\"> 19.83 </td>\n   <td style=\"text-align:center;\"> 19.87 </td>\n   <td style=\"text-align:center;\"> 19.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [19.68, 20.22] </td>\n   <td style=\"text-align:center;\"> [19.56, 20.10] </td>\n   <td style=\"text-align:center;\"> [19.60, 20.14] </td>\n   <td style=\"text-align:center;\"> [19.63, 20.13] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.02, 0.06] </td>\n   <td style=\"text-align:center;\"> [0.01, 0.05] </td>\n   <td style=\"text-align:center;\"> [0.01, 0.05] </td>\n   <td style=\"text-align:center;\"> [0.01, 0.05] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hurdle part: Year </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.05, 0.11] </td>\n   <td style=\"text-align:center;\"> [0.07, 0.13] </td>\n   <td style=\"text-align:center;\"> [0.04, 0.10] </td>\n   <td style=\"text-align:center;\"> [0.04, 0.10] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hurdle part: YearÂ² </td>\n   <td style=\"text-align:center;\"> 0.007 </td>\n   <td style=\"text-align:center;\"> 0.008 </td>\n   <td style=\"text-align:center;\"> 0.008 </td>\n   <td style=\"text-align:center;\"> 0.009 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.003, 0.01] </td>\n   <td style=\"text-align:center;\"> [0.004, 0.01] </td>\n   <td style=\"text-align:center;\"> [0.004, 0.01] </td>\n   <td style=\"text-align:center;\"> [0.005, 0.01] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hurdle part: Intercept </td>\n   <td style=\"text-align:center;\"> âˆ’3.46 </td>\n   <td style=\"text-align:center;\"> âˆ’3.41 </td>\n   <td style=\"text-align:center;\"> âˆ’3.51 </td>\n   <td style=\"text-align:center;\"> âˆ’3.57 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’3.71, âˆ’3.22] </td>\n   <td style=\"text-align:center;\"> [âˆ’3.68, âˆ’3.16] </td>\n   <td style=\"text-align:center;\"> [âˆ’3.78, âˆ’3.25] </td>\n   <td style=\"text-align:center;\"> [âˆ’3.84, âˆ’3.32] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country intercept variability (\\(\\sigma_0\\) for \\(b_0\\) offsets) </td>\n   <td style=\"text-align:center;\"> 1.52 </td>\n   <td style=\"text-align:center;\"> 1.49 </td>\n   <td style=\"text-align:center;\"> 1.51 </td>\n   <td style=\"text-align:center;\"> 1.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [1.35, 1.71] </td>\n   <td style=\"text-align:center;\"> [1.32, 1.69] </td>\n   <td style=\"text-align:center;\"> [1.34, 1.72] </td>\n   <td style=\"text-align:center;\"> [1.34, 1.70] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Between-country year variability (\\(\\sigma_3\\) for \\(b_3\\) offsets) </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n   <td style=\"text-align:center;\"> 0.10 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.08, 0.11] </td>\n   <td style=\"text-align:center;\"> [0.08, 0.11] </td>\n   <td style=\"text-align:center;\"> [0.08, 0.11] </td>\n   <td style=\"text-align:center;\"> [0.08, 0.11] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Correlation between random intercepts and slopes (\\(\\rho\\)) </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> âˆ’0.0008 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n   <td style=\"text-align:center;\"> 0.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [âˆ’0.15, 0.22] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.18, 0.19] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.17, 0.20] </td>\n   <td style=\"text-align:center;\"> [âˆ’0.15, 0.20] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Model variability (\\(\\sigma_y\\)) </td>\n   <td style=\"text-align:center;\"> 0.86 </td>\n   <td style=\"text-align:center;\"> 0.91 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 0.90 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.84, 0.88] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.89, 0.94] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.90, 0.95] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.88, 0.92] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:center;\"> 3151 </td>\n   <td style=\"text-align:center;\"> 3151 </td>\n   <td style=\"text-align:center;\"> 3151 </td>\n   <td style=\"text-align:center;\"> 3151 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (total) </td>\n   <td style=\"text-align:center;\"> 0.51 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n   <td style=\"text-align:center;\"> 0.53 </td>\n   <td style=\"text-align:center;\"> 0.52 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (marginal) </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.001 </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Posterior medians; 95% credible intervals (HDPI) in brackets. <sup></sup> Total \\(R^2\\) considers the variance of both population and group effects; <sup></sup> marginal \\(R^2\\) only takes population effects into account</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
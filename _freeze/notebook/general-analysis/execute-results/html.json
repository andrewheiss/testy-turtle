{
  "hash": "e079c8df4843c4f7c22f2b357368a731",
  "result": {
    "markdown": "---\ntitle: \"General analysis\"\nauthor: \"Suparna Chaudhry and Andrew Heiss\"\ndate: \"2023-01-19\"\nlink-citations: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(targets)\nlibrary(scales)\nlibrary(patchwork)\nlibrary(kableExtra)\nlibrary(sf)\nlibrary(here)\n\n# Load things from targets\ninvisible(list2env(tar_read(graphic_functions), .GlobalEnv))\ninvisible(list2env(tar_read(misc_funs), .GlobalEnv))\n\ndf_donor <- tar_read(donor_level_data)\ndf_donor_us <- tar_read(donor_level_data_usaid)\n\ndf_country_aid <- tar_read(country_aid_final)\ndf_country_aid_laws <- filter(df_country_aid, laws)\n\ndf_autocracies <- tar_read(autocracies)\n\nvars_to_summarize <- tar_read(var_details) %>% \n  mutate(summary_order = 1:n())\ntar_load(c(ngo_index_table, regulations))\n\ntar_load(c(civicus_map_data, civicus_clean))\n\n\nmy_seed <- 1234\nset.seed(my_seed)\n```\n:::\n\n\n\n# Overall data summary\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnum_countries <- df_country_aid_laws %>% distinct(gwcode) %>% nrow()\nnum_years <- df_country_aid_laws %>% distinct(year) %>% nrow()\nyear_first <- df_country_aid_laws %>% distinct(year) %>% min()\nyear_last <- df_country_aid_laws %>% distinct(year) %>% max()\n```\n:::\n\n\nOur data includes information about 142 countries across 24 years (from 1990–2013)\n\n\n# Summary of variables in model\n\n(*From our AJPS submission*): The values here are slightly different from what we had at ISA and MPSA (and our ISQ submission) because we're now using V-Dem 8.0 and AidData 3.1. \n\nAnd now the values are even different-er, since we're using V-Dem 10.0 and have really clean data now.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nvars_summarized <- df_country_aid_laws %>%\n  select(one_of(vars_to_summarize$term)) %>%\n  mutate(total_oda = total_oda / 1000000) %>%\n  mutate(gdpcap_log = exp(gdpcap_log)) %>% \n  pivot_longer(names_to = \"term\", values_to = \"value\", everything()) %>%\n  filter(!is.na(value)) %>% \n  group_by(term) %>%\n  summarize(N = n(),\n            Mean = mean(value),\n            Median = median(value),\n            `Std. Dev.` = sd(value),\n            Min = min(value),\n            Max = max(value)) %>% \n  ungroup() %>% \n  left_join(vars_to_summarize, by = \"term\") %>%\n  arrange(summary_order) %>%\n  mutate(across(c(Mean, `Std. Dev.`, Median, Min, Max),\n                ~case_when(\n                  format == \"percent\" ~ percent_format(accuracy = 0.1)(.),\n                  format == \"dollar\" ~ dollar_format(accuracy = 1)(.),\n                  format == \"number\" ~ comma_format(accuracy = 0.1)(.)))) %>% \n  mutate(N = comma(N)) %>% \n  select(category, subcategory, Variable = term_clean_table, Source = source, \n         Mean, `Std. Dev.`, Median, Min, Max, N)\n\nvars_summarized %>% \n  select(-category, ` ` = subcategory) %>% \n  kbl() %>% \n  kable_styling() %>% \n  pack_rows(index = table(fct_inorder(vars_summarized$category))) %>% \n  collapse_rows(columns = 1, valign = \"top\") %>% \n  unclass() %>% cat()\n```\n\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> Source </th>\n   <th style=\"text-align:left;\"> Mean </th>\n   <th style=\"text-align:left;\"> Std. Dev. </th>\n   <th style=\"text-align:left;\"> Median </th>\n   <th style=\"text-align:left;\"> Min </th>\n   <th style=\"text-align:left;\"> Max </th>\n   <th style=\"text-align:left;\"> N </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"4\"><td colspan=\"9\" style=\"border-bottom: 1px solid;\"><strong>Outcome</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;vertical-align: top !important;\" indentlevel=\"1\" rowspan=\"4\">  </td>\n   <td style=\"text-align:left;\"> Total aid (constant 2011 USD, millions) </td>\n   <td style=\"text-align:left;\"> OECD and AidData </td>\n   <td style=\"text-align:left;\"> $1,316 </td>\n   <td style=\"text-align:left;\"> $2,968 </td>\n   <td style=\"text-align:left;\"> $483 </td>\n   <td style=\"text-align:left;\"> $0 </td>\n   <td style=\"text-align:left;\"> $63,233 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Proportion of contentious aid </td>\n   <td style=\"text-align:left;\"> OECD and AidData </td>\n   <td style=\"text-align:left;\"> 7.1% </td>\n   <td style=\"text-align:left;\"> 10.5% </td>\n   <td style=\"text-align:left;\"> 3.3% </td>\n   <td style=\"text-align:left;\"> 0.0% </td>\n   <td style=\"text-align:left;\"> 100.0% </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Proportion of aid to domestic NGOs </td>\n   <td style=\"text-align:left;\"> USAID </td>\n   <td style=\"text-align:left;\"> 4.1% </td>\n   <td style=\"text-align:left;\"> 13.8% </td>\n   <td style=\"text-align:left;\"> 0.1% </td>\n   <td style=\"text-align:left;\"> 0.0% </td>\n   <td style=\"text-align:left;\"> 100.0% </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Proportion of aid to foreign NGOs </td>\n   <td style=\"text-align:left;\"> USAID </td>\n   <td style=\"text-align:left;\"> 13.1% </td>\n   <td style=\"text-align:left;\"> 20.3% </td>\n   <td style=\"text-align:left;\"> 0.7% </td>\n   <td style=\"text-align:left;\"> 0.0% </td>\n   <td style=\"text-align:left;\"> 100.0% </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr grouplength=\"5\"><td colspan=\"9\" style=\"border-bottom: 1px solid;\"><strong>Treatment</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;vertical-align: top !important;\" indentlevel=\"1\" rowspan=\"5\">  </td>\n   <td style=\"text-align:left;\"> Total legal barriers </td>\n   <td style=\"text-align:left;\"> @Chaudhry:2016 </td>\n   <td style=\"text-align:left;\"> 1.5 </td>\n   <td style=\"text-align:left;\"> 1.9 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 9.5 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Barriers to advocacy </td>\n   <td style=\"text-align:left;\"> @Chaudhry:2016 </td>\n   <td style=\"text-align:left;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 2.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Barriers to entry </td>\n   <td style=\"text-align:left;\"> @Chaudhry:2016 </td>\n   <td style=\"text-align:left;\"> 0.8 </td>\n   <td style=\"text-align:left;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 3.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Barriers to funding </td>\n   <td style=\"text-align:left;\"> @Chaudhry:2016 </td>\n   <td style=\"text-align:left;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 4.5 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Core civil society index </td>\n   <td style=\"text-align:left;\"> @Chaudhry:2016 </td>\n   <td style=\"text-align:left;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr grouplength=\"13\"><td colspan=\"9\" style=\"border-bottom: 1px solid;\"><strong>Confounders</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;padding-left: 2em;vertical-align: top !important;\" indentlevel=\"1\" rowspan=\"6\"> Human rights and politics </td>\n   <td style=\"text-align:left;\"> Electoral democracy index (polyarchy) </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 0.2 </td>\n   <td style=\"text-align:left;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0.9 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Political corruption index </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Rule of law index </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 0.4 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Civil liberties index </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 0.2 </td>\n   <td style=\"text-align:left;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Physical violence index </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Private civil liberties index </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.6 </td>\n   <td style=\"text-align:left;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 0.7 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;vertical-align: top !important;\" indentlevel=\"1\" rowspan=\"5\"> Economics and development </td>\n   <td style=\"text-align:left;\"> GDP per capita (constant 2011 USD) </td>\n   <td style=\"text-align:left;\"> UN </td>\n   <td style=\"text-align:left;\"> $6,359 </td>\n   <td style=\"text-align:left;\"> $10,440 </td>\n   <td style=\"text-align:left;\"> $2,726 </td>\n   <td style=\"text-align:left;\"> $92 </td>\n   <td style=\"text-align:left;\"> $82,410 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Trade as % of GDP </td>\n   <td style=\"text-align:left;\"> UN </td>\n   <td style=\"text-align:left;\"> 78.1% </td>\n   <td style=\"text-align:left;\"> 46.0% </td>\n   <td style=\"text-align:left;\"> 69.2% </td>\n   <td style=\"text-align:left;\"> 1.9% </td>\n   <td style=\"text-align:left;\"> 441.6% </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Educational equality </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> 1.3 </td>\n   <td style=\"text-align:left;\"> -0.1 </td>\n   <td style=\"text-align:left;\"> -3.2 </td>\n   <td style=\"text-align:left;\"> 3.6 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Health equality </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 0.1 </td>\n   <td style=\"text-align:left;\"> 1.4 </td>\n   <td style=\"text-align:left;\"> -0.1 </td>\n   <td style=\"text-align:left;\"> -3.3 </td>\n   <td style=\"text-align:left;\"> 3.5 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Infant mortality rate (deaths per 1,000 births) </td>\n   <td style=\"text-align:left;\"> @vdem-v10 </td>\n   <td style=\"text-align:left;\"> 45.3 </td>\n   <td style=\"text-align:left;\"> 34.6 </td>\n   <td style=\"text-align:left;\"> 35.9 </td>\n   <td style=\"text-align:left;\"> 2.2 </td>\n   <td style=\"text-align:left;\"> 171.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;padding-left: 2em;vertical-align: top !important;\" indentlevel=\"1\" rowspan=\"2\"> Unexpected shocks </td>\n   <td style=\"text-align:left;\"> Internal conflict in last 5 years </td>\n   <td style=\"text-align:left;\"> UCDP/PRIO </td>\n   <td style=\"text-align:left;\"> 0.3 </td>\n   <td style=\"text-align:left;\"> 0.5 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:left;\"> Natural disasters </td>\n   <td style=\"text-align:left;\"> EM-DAT </td>\n   <td style=\"text-align:left;\"> 2.1 </td>\n   <td style=\"text-align:left;\"> 3.5 </td>\n   <td style=\"text-align:left;\"> 1.0 </td>\n   <td style=\"text-align:left;\"> 0.0 </td>\n   <td style=\"text-align:left;\"> 43.0 </td>\n   <td style=\"text-align:left;\"> 3,293 </td>\n  </tr>\n</tbody>\n</table>\n:::\n\n\n\n# Aid stuff\n\n## Overall OECD aid\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntotal_oecd_aid <- df_country_aid_laws %>%\n  summarise(total = dollar(sum(total_oda))) %>% \n  pull(total)\n```\n:::\n\n\nOECD members donated $4,333,135,732,679 between 1990 and 2013.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_aid <- df_country_aid_laws %>%\n  filter(year <= 2013) %>% \n  group_by(year) %>%\n  summarise(total = sum(total_oda)) %>% \n  mutate(fake_facet_title = \"ODA commitments (all OECD)\")\n\nfig_oecd_aid <- ggplot(plot_aid, aes(x = year, y = (total / 1000000000))) + \n  geom_line(size = 0.5) +\n  labs(x = NULL, y = \"Billions of USD\") +\n  scale_y_continuous(labels = dollar) +\n  coord_cartesian(xlim = c(1990, 2015)) +\n  theme_donors() + \n  facet_wrap(vars(fake_facet_title))\n## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n## ℹ Please use `linewidth` instead.\nfig_oecd_aid\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/plot-oecd-aid-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## Proportion of contentious vs. noncontentious aid\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_donor %>%\n  filter(year >= 1990) %>%\n  group_by(purpose_contentiousness) %>%\n  summarise(Total = sum(oda)) %>%\n  ungroup() %>% \n  mutate(Percent = Total / sum(Total)) %>%\n  mutate(Total = dollar(Total), \n         Percent = percent_format(accuracy = 0.1)(Percent)) %>% \n  rename(`Contentiousness` = purpose_contentiousness) %>% \n  kbl() %>% \n  kable_styling(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Contentiousness </th>\n   <th style=\"text-align:left;\"> Total </th>\n   <th style=\"text-align:left;\"> Percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> High </td>\n   <td style=\"text-align:left;\"> $267,373,936,986 </td>\n   <td style=\"text-align:left;\"> 6.2% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Low </td>\n   <td style=\"text-align:left;\"> $4,071,293,867,271 </td>\n   <td style=\"text-align:left;\"> 93.8% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_aid_contentiousness <- df_donor %>%\n  filter(year >= 1990) %>%\n  group_by(year, purpose_contentiousness) %>%\n  summarise(total = sum(oda)) %>%\n  mutate(perc = total / sum(total)) %>%\n  filter(purpose_contentiousness == \"High\") %>% \n  mutate(fake_facet_title = \"Contentious aid (all OECD)\")\n\nfig_oecd_contention <- ggplot(plot_aid_contentiousness, aes(x = year, y = perc)) + \n  geom_line(size = 0.5) +\n  scale_y_continuous(labels = percent_format(accuracy = 1)) + \n  labs(x = NULL, y = \"Percent\") +\n  coord_cartesian(xlim = c(1990, 2015)) +\n  theme_donors() +\n  facet_wrap(vars(fake_facet_title))\nfig_oecd_contention\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/plot-contentious-aid-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## USAID aid\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntotal_us_aid <- df_country_aid_laws %>%\n  summarise(total = dollar(sum(oda_us))) %>% \n  pull(total)\n\ntotal_us_aid_post_2000 <- df_country_aid_laws %>%\n  filter(year > 1999) %>%\n  summarise(total = dollar(sum(oda_us))) %>% \n  pull(total)\n```\n:::\n\n\nThe US donated $372,941,015,547 between 1990 and 2014 and $249,318,427,528 between 2000 and 2014.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_aid_us <- df_country_aid_laws %>%\n  filter(year >= 1990) %>% \n  group_by(year) %>%\n  summarise(total = sum(oda_us)) %>% \n  mutate(fake_facet_title = \"ODA commitments (USAID only)\")\n\nfig_us_aid <- ggplot(plot_aid_us, aes(x = year, y = (total / 1000000000))) + \n  geom_line(size = 0.5) +\n  expand_limits(y = 0) +\n  labs(x = NULL, y = \"Billions of USD\") +\n  scale_y_continuous(labels = dollar) +\n  coord_cartesian(xlim = c(1990, 2015)) +\n  theme_donors() +\n  facet_wrap(vars(fake_facet_title))\nfig_us_aid\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/plot-us-aid-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## Proportion of US aid to types of NGOs\n\nTotal amounts over time:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nusaid_total <- df_country_aid_laws %>% \n  summarise(total = sum(oda_us)) %>% pull(total)\n\nchannels_nice <- tribble(\n  ~channel,         ~channel_clean,\n  \"oda_us_ngo_dom\", \"Domestic NGOs\",\n  \"oda_us_ngo_int\", \"International NGOs\",\n  \"oda_us_ngo_us\",  \"US-based NGOs\"\n)\n\ndf_country_aid_laws %>%\n  pivot_longer(names_to = \"channel\", values_to = \"total_oda_us\",\n               c(oda_us_ngo_dom, oda_us_ngo_int, oda_us_ngo_us)) %>% \n  group_by(channel) %>%\n  summarise(total = sum(total_oda_us)) %>%\n  ungroup() %>% \n  left_join(channels_nice, by = \"channel\") %>% \n  mutate(perc = total / usaid_total) %>%\n  mutate(total = dollar(total), perc = percent(perc)) %>% \n  select(Channel = channel_clean, Total = total, Percent = perc) %>% \n  kbl() %>% \n  kable_styling(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Channel </th>\n   <th style=\"text-align:left;\"> Total </th>\n   <th style=\"text-align:left;\"> Percent </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Domestic NGOs </td>\n   <td style=\"text-align:left;\"> $6,260,665,669 </td>\n   <td style=\"text-align:left;\"> 1.7% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> International NGOs </td>\n   <td style=\"text-align:left;\"> $13,963,319,102 </td>\n   <td style=\"text-align:left;\"> 3.7% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> US-based NGOs </td>\n   <td style=\"text-align:left;\"> $28,903,292,740 </td>\n   <td style=\"text-align:left;\"> 7.8% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe US clearly favors US-based NGOs or international NGOs over domestic NGOs.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nusaid_total_yearly <- df_country_aid_laws %>%\n  group_by(year) %>%\n  summarise(annual_total = sum(oda_us)) %>% \n  mutate(fake_facet_title = \"USAID ODA channeled through NGOs\")\n\nplot_usaid_channel <- df_country_aid_laws %>%\n  filter(year >= 1990) %>% \n  pivot_longer(names_to = \"channel\", values_to = \"total_oda_us\", \n               c(oda_us_ngo_dom, oda_us_ngo_int, oda_us_ngo_us)) %>%\n  group_by(year, channel) %>%\n  summarise(total = sum(total_oda_us)) %>%\n  left_join(usaid_total_yearly, by = \"year\") %>%\n  mutate(perc = total / annual_total) %>%\n  left_join(channels_nice, by = \"channel\")\n\nfig_usaid_channel <- ggplot(plot_usaid_channel, \n                            aes(x = year, y = perc, colour = channel_clean)) + \n  geom_line(size = 0.5) +\n  scale_y_continuous(labels = percent_format(accuracy = 1)) + \n  scale_colour_manual(values = clrs$Sunset[c(2, 5, 7)]) +\n  labs(x = NULL, y = \"Percent\") +\n  guides(colour = guide_legend(title = NULL, reverse = TRUE, nrow = 2)) +\n  coord_cartesian(xlim = c(1990, 2015)) +\n  theme_donors() + \n  facet_wrap(vars(fake_facet_title))\nfig_usaid_channel\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/plot-aid-channels-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nUSAID data categorizes all aid as government-channeled before 2000 because of some quirk in the data.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_usaid_channels_all <- df_donor_us %>%\n  group_by(year, implementing_partner_sub_category_name) %>%\n  summarise(total = sum(oda_us_2011)) %>%\n  mutate(perc = total / sum(total)) %>%\n  mutate(channel = ifelse(str_detect(implementing_partner_sub_category_name, \"NGO\"), \"NGO\", \"Other\"))\n\nggplot(plot_usaid_channels_all, \n       aes(x = year, y = perc, colour = implementing_partner_sub_category_name)) + \n  geom_line(size = 0.5) +\n  scale_y_continuous(labels = percent_format(accuracy = 1)) + \n  labs(x = NULL, y = \"Percent of US aid given through different channels\") +\n  guides(colour = guide_legend(title = NULL, ncol = 2)) +\n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/plot-all-channels-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\nSo we just look at aid after 2000.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfig_usaid_channel_trimmed <- fig_usaid_channel +\n  coord_cartesian(xlim = c(2000, 2015))\nfig_usaid_channel_trimmed\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/plot-channels-post-2000-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## All DV figures combined\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfig_dvs <- (fig_oecd_aid + fig_oecd_contention) / \n  (fig_us_aid + fig_usaid_channel_trimmed) &\n  theme_donors(base_size = 10) +\n  theme(legend.text = element_text(size = rel(0.6)),\n        axis.title.y = element_text(margin = margin(r = 3)),\n        legend.box.margin = margin(t = -0.5, unit = \"lines\"))\n\nfig_dvs\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/plot-all-dvs-1.png){fig-align='center' width=85%}\n:::\n\n```{.r .cell-code}\nggsave(here(\"analysis\", \"output\", \"fig-dvs.pdf\"), fig_dvs,\n       width = 6.5, height = 4.75, device = cairo_pdf)\nggsave(here(\"analysis\", \"output\", \"fig-dvs.png\"), fig_dvs,\n       width = 6.5, height = 4.75, res = 300, device = ragg::agg_png)\n```\n:::\n\n\n\n# Legal restrictions on NGOs\n\n## DCJW / Chaudhry indexes\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nngo_index_table <- ngo_index_table %>% \n  mutate(Index_nice = paste0(Index, \" (max: \", Max, \")\"))\n\nngo_index_table %>% \n  select(`Restriction description` = Description, Coding) %>% \n  kbl(align = c(\"l\", \"l\"),\n      caption = \"Description of indexes of NGO barriers\") %>% \n  kable_styling() %>% \n  pack_rows(index = table(fct_inorder(ngo_index_table$Index_nice)),\n            indent = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Description of indexes of NGO barriers</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Restriction description </th>\n   <th style=\"text-align:left;\"> Coding </th>\n  </tr>\n </thead>\n<tbody>\n  <tr grouplength=\"3\"><td colspan=\"2\" style=\"border-bottom: 1px solid;\"><strong>Barriers to entry (max: 3)</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;\"> How burdensome is registration? </td>\n   <td style=\"text-align:left;\"> Not burdensome = 0; Burdensome = 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> In law, can an NGO appeal if denied registration? </td>\n   <td style=\"text-align:left;\"> Yes = 0; No = 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Are barriers to entry different for NGOs receiving foreign funds? </td>\n   <td style=\"text-align:left;\"> Less burdensome = -1; Same = 0; More burdensome = 1 </td>\n  </tr>\n  <tr grouplength=\"5\"><td colspan=\"2\" style=\"border-bottom: 1px solid;\"><strong>Barriers to funding (max: 5)</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;\"> Do NGOs need prior approval from the government to receive foreign funding? </td>\n   <td style=\"text-align:left;\"> Yes = 1; No = 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Are NGOs required to channel foreign funding through state-owned banks or government ministries? </td>\n   <td style=\"text-align:left;\"> Yes = 1; No = 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Are any additional restrictions on foreign support in place? </td>\n   <td style=\"text-align:left;\"> Yes = 1; No = 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Are all NGOs prohibited from receiving foreign funds? </td>\n   <td style=\"text-align:left;\"> No = 0; Partially = 0.5; Yes = 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Is a category of NGOs prohibited from receiving foreign funds? </td>\n   <td style=\"text-align:left;\"> No = 0; Partially = 0.5; Yes = 1 </td>\n  </tr>\n  <tr groupLength=\"2\"><td colspan=\"2\" style=\"border-bottom: 1px solid;\"><strong>Barriers to advocacy (max: 2)</strong></td></tr>\n<tr>\n   <td style=\"text-align:left;\"> Does the law restrict NGOs from engaging in political activities? </td>\n   <td style=\"text-align:left;\"> No = 0; Partially = 0.5; Yes = 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Are restrictions on political activities different for NGOs receiving foreign funds? </td>\n   <td style=\"text-align:left;\"> Less restrictive = -1; Same = 0; More restrictive = 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## NGO barriers over time\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nregulations <- regulations %>% \n  filter(!ignore_in_index) %>% \n  mutate(barrier_group = paste0(\"Barriers to \", str_to_lower(barrier))) %>% \n  select(barrier_group, barrier = question_clean, barrier_display = question_display)\n\ndf_barriers <- df_country_aid_laws %>% \n  group_by(gwcode, year) %>% \n  summarize(across(one_of(regulations$barrier), ~. > 0)) %>% \n  group_by(year) %>% \n  summarize(across(-gwcode, ~sum(.))) %>% \n  ungroup() %>% \n  pivot_longer(names_to = \"barrier\", values_to = \"value\", -year) %>% \n  left_join(regulations, by = \"barrier\") %>% \n  mutate(barrier_display = str_replace(barrier_display, \"XXX\", \"\\n\")) %>% \n  arrange(desc(value)) %>% \n  mutate(barrier_display = fct_inorder(barrier_display, ordered = TRUE))\n\ndcjw_entry_plot <- ggplot(filter(df_barriers, \n                                 barrier_group == \"Barriers to entry\"), \n                          aes(x = year, y = value, \n                              color = barrier_display,\n                              linetype = barrier_display)) +\n  geom_line(size = 0.5) +\n  expand_limits(y = c(0, 90)) +\n  scale_y_continuous(sec.axis = sec_axis(~ . / num_countries,\n                                         labels = percent_format(accuracy = 1)),\n                     expand = c(0, 0)) +\n  scale_colour_manual(values = c(\"black\", \"grey80\", \"grey50\"), name = NULL) +\n  scale_linetype_manual(values = c(\"solid\", \"solid\", \"21\"), name = NULL) +\n  coord_cartesian(xlim = c(1990, 2015), ylim = c(0, 90)) +\n  guides(color = guide_legend(nrow = 2)) +\n  labs(x = NULL, y = \"Number of countries\") +\n  theme_donors(10) + \n  theme(legend.justification = \"left\") +\n  facet_wrap(vars(barrier_group))\n\ndcjw_funding_plot <- ggplot(filter(df_barriers, \n                                   barrier_group == \"Barriers to funding\"), \n                            aes(x = year, y = value, \n                                color = barrier_display,\n                                linetype = barrier_display)) +\n  geom_line(size = 0.5) +\n  scale_y_continuous(sec.axis = sec_axis(~ . / num_countries,\n                                         labels = percent_format(accuracy = 1)),\n                     expand = c(0, 0)) +\n  scale_colour_manual(values = c(\"black\", \"grey80\", \"grey50\", \"black\", \"grey80\"), name = NULL) +\n  scale_linetype_manual(values = c(\"solid\", \"solid\", \"solid\", \"21\", \"21\"), name = NULL) +\n  coord_cartesian(xlim = c(1990, 2015), ylim = c(0, 40)) +\n  guides(color = guide_legend(nrow = 3),\n         linetype = guide_legend(nrow = 3)) +\n  labs(x = NULL, y = \"Number of countries\") +\n  theme_donors(10) + \n  theme(legend.justification = \"left\") +\n  facet_wrap(vars(barrier_group))\n\ndcjw_advocacy_plot <- ggplot(filter(df_barriers, \n                                    barrier_group == \"Barriers to advocacy\"), \n                            aes(x = year, y = value, \n                                color = barrier_display)) +\n  geom_line(size = 0.5) +\n  scale_y_continuous(sec.axis = sec_axis(~ . / num_countries,\n                                         labels = percent_format(accuracy = 1)),\n                     expand = c(0, 0)) +\n  scale_colour_manual(values = c(\"black\", \"grey80\"), name = NULL) +\n  coord_cartesian(xlim = c(1990, 2015), ylim = c(0, 60)) +\n  guides(color = guide_legend(nrow = 1)) +\n  labs(x = NULL, y = \"Number of countries\") +\n  theme_donors(10) + \n  theme(legend.justification = \"left\") +\n  facet_wrap(vars(barrier_group))\n\ndf_ccsi_plot <- df_country_aid %>%\n  left_join(df_autocracies, by = \"gwcode\") %>%\n  group_by(year, autocracy) %>%\n  nest() %>% \n  mutate(cis = data %>% map(~ mean_cl_normal(.$v2xcs_ccsi))) %>% \n  unnest(cis) %>% \n  ungroup() %>% \n  mutate(fake_facet_title = \"Core civil society index\",\n         autocracy = factor(autocracy, \n                            labels = c(\"Democracies (Regimes of the World > 4)\",\n                                       \"Non-democracies (Regimes of the World ≤ 4)\"), \n                            ordered = TRUE))\n\nfig_ccsi <- ggplot(df_ccsi_plot, aes(x = year, y = y)) +\n  geom_ribbon(aes(ymin = ymin, ymax = ymax, fill = autocracy), alpha = 0.2) +\n  geom_line(aes(color = autocracy), size = 0.5) +\n  annotate(geom = \"text\", x = 2015, y = 0.1, hjust = \"right\", size = pts(7),\n           label = \"Higher values = more open civil society\") +\n  scale_colour_manual(values = c(\"black\", \"grey75\"), name = NULL) +\n  scale_fill_manual(values = c(\"black\", \"grey75\"), name = NULL) +\n  scale_linetype_manual(values = c(\"solid\", \"solid\", \"21\")) +\n  coord_cartesian(xlim = c(1990, 2015), ylim = c(0, 1)) +\n  guides(color = guide_legend(nrow = 2)) +\n  labs(y = \"Average\", x = NULL) +\n  theme_donors(10) +\n  theme(legend.justification = \"left\") +\n  facet_wrap(vars(fake_facet_title))\n\nbarriers_summary <- \n  ((dcjw_entry_plot + dcjw_funding_plot) / \n     (dcjw_advocacy_plot + fig_ccsi)) &\n  theme(legend.text = element_text(size = rel(0.6)),\n        axis.title.y = element_text(margin = margin(r = 3)),\n        legend.box.margin = margin(t = -0.5, unit = \"lines\"))\n\nbarriers_summary\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/advocacy-laws-1.png){fig-align='center' width=85%}\n:::\n\n```{.r .cell-code}\nggsave(here(\"analysis\", \"output\", \"fig-barriers-summary.pdf\"), barriers_summary,\n       width = 6.5, height = 6, device = cairo_pdf)\nggsave(here(\"analysis\", \"output\", \"fig-barriers-summary.png\"), barriers_summary,\n       width = 6.5, height = 6, res = 300, device = ragg::agg_png)\n```\n:::\n\n\n## Compulsory vs. burdensome registration\n\nLaws requiring NGO registration aren't necessarily a sign of oppression—even the US requires that nonprofits that earn above a certain threshold register as 501(c)(3) organizations. Though the figure below shows that compulsory regulation have increased over time, actual restriction has occurred too. Burdensome registration is not just another standard layer of bureaucracy.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_regulation <- df_country_aid_laws %>%\n  left_join(select(df_autocracies, gwcode, autocracy), by = \"gwcode\") %>%\n  group_by(year, autocracy) %>%\n  summarise(`Registration required` = sum(ngo_register) / n(),\n            `Registration burdensome` = sum(ngo_register_burden) / n()) %>%\n  ungroup() %>% \n  pivot_longer(names_to = \"type_of_law\", values_to = \"value\", -c(year, autocracy)) %>% \n  mutate(autocracy = \n           factor(autocracy, levels = c(TRUE, FALSE),\n                  labels = c(\"Non-democracies\", \"Democracies\")))\n\nfig_regulation_burden <- ggplot(df_regulation, \n                                aes(x = year, y = value, color = type_of_law)) +\n  geom_line(size = 0.5) +\n  scale_y_continuous(labels = percent_format(accuracy = 1)) +\n  scale_x_continuous(expand = c(0, 0)) +\n  coord_cartesian(ylim = c(0, 0.7), xlim = c(1990, 2014)) +\n  guides(colour = guide_legend(title = NULL)) +\n  labs(x = NULL, y = \"Proportion of countries\\nwith regulation\") +\n  theme_donors(10) +\n  facet_wrap(vars(autocracy))\n\nfig_regulation_burden\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/compulsory-vs-burdensome-1.png){fig-align='center' width=85%}\n:::\n\n```{.r .cell-code}\nggsave(here(\"analysis\", \"output\", \"fig-regulation-burden.pdf\"), fig_dvs,\n       width = 6, height = 2.5, device = cairo_pdf)\nggsave(here(\"analysis\", \"output\", \"fig-regulation-burden.png\"), fig_dvs,\n       width = 6, height = 2.5, res = 300, device = ragg::agg_png)\n```\n:::\n\n\n\n# Aid\n\n## Aid over time, by donor type\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\naid_donor_type_time <- df_donor %>%\n  group_by(year, donor_type_collapsed) %>%\n  summarise(total_aid = sum(oda, na.rm = TRUE))\n\nggplot(aid_donor_type_time, aes(x = year, y = total_aid / 1000000000,\n                                colour = donor_type_collapsed)) +\n  geom_line(size = 0.5) +\n  labs(x = NULL, y = \"Billions of USD\",\n       caption = \"Source: OECD and AidData. 2011 dollars.\") +\n  guides(colour = guide_legend(title = NULL)) +\n  scale_y_continuous(labels = dollar) + \n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/aid-by-donor-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## Aid over time, by contentiousness\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\naid_contention_time <- df_donor %>%\n  group_by(year, purpose_contentiousness) %>%\n  summarise(total_aid = sum(oda, na.rm = TRUE))\n\nggplot(aid_contention_time, aes(x = year, y = total_aid / 1000000000,\n                                colour = purpose_contentiousness)) +\n  geom_line(size = 0.5) +\n  labs(x = NULL, y = \"Billions of USD\",\n       caption = \"Source: OECD and AidData. 2011 dollars.\") +\n  guides(colour = guide_legend(title = NULL)) +\n  scale_y_continuous(labels = dollar) + \n  theme_donors()\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/aid-by-contention-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n# Restrictions and aid {.tabset .tabset-fade .tabset-pills}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ninv_logit <- function(f, a) {\n  a <- (1 - 2 * a)\n  (a * (1 + exp(f)) + (exp(f) - 1)) / (2 * a * (1 + exp(f)))\n}\n\ndvs_clean_names <- tribble(\n  ~barrier, ~barrier_clean,\n  \"barriers_total\", \"All barriers\",\n  \"advocacy\", \"Barriers to advocacy\",\n  \"entry\", \"Barriers to entry\",\n  \"funding\", \"Barriers to funding\"\n)\n\nivs_clean_names <- tribble(\n  ~variable, ~variable_clean, ~hypothesis,\n  \"total_oda_lead1\", \"Total ODA\", \"H1\",\n  \"prop_contentious_lead1\", \"Contentious aid\", \"H2\",\n  \"prop_ngo_dom_lead1\", \"Aid to domestic NGOs\", \"H3\",\n  \"prop_ngo_foreign_lead1\", \"Aid to foreign NGOs\", \"H3\"\n)\n```\n:::\n\n\n## Restrictions and ODA (H~1~)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_plot_barriers_oda <- df_country_aid_laws %>% \n  select(year, gwcode, country, total_oda_lead1,\n         one_of(dvs_clean_names$barrier)) %>% \n  pivot_longer(names_to = \"barrier\", values_to = \"value\", \n               one_of(dvs_clean_names$barrier)) %>% \n  left_join(dvs_clean_names, by = \"barrier\") %>% \n  mutate(barrier_clean = fct_inorder(barrier_clean, ordered = TRUE))\n\nggplot(df_plot_barriers_oda, \n       aes(x = value, y = total_oda_lead1, color = barrier_clean)) +\n  geom_point(alpha = 0.5) +\n  stat_smooth(method = \"lm\") +\n  stat_smooth(data = filter(df_plot_barriers_oda, \n                            total_oda_lead1 > 10000000000), \n              method = \"lm\", linetype = \"21\") +\n  scale_y_continuous(labels = dollar) +\n  guides(color = \"none\") +\n  labs(x = \"Number of legal barriers\", y = \"Total ODA in next year\",\n       title = \"Total ODA in next year\",\n       subtitle = \"Dotted lines show trends when omitting observations\\nwith less than $10,000,000,000 in ODA\") +\n  theme_donors(10) +\n  theme(strip.text.x = element_text(margin = margin(t = 1, b = 1))) +\n  facet_wrap(vars(barrier_clean), scales = \"free_x\", nrow = 2)\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/restrictions-aid-h1-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## Restrictions and contentiousness (H~2~)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_plot_barriers_contention <- df_country_aid_laws %>% \n  select(year, gwcode, country, prop_contentious_lead1,\n         one_of(dvs_clean_names$barrier))  %>% \n  pivot_longer(names_to = \"barrier\", values_to = \"value\", \n               one_of(dvs_clean_names$barrier)) %>% \n  left_join(dvs_clean_names, by = \"barrier\") %>% \n  mutate(barrier_clean = fct_inorder(barrier_clean, ordered = TRUE))\n\nggplot(df_plot_barriers_contention, \n       aes(x = value, y = prop_contentious_lead1, color = barrier_clean)) +\n  geom_point(alpha = 0.5) +\n  stat_smooth(method = \"lm\") +\n  stat_smooth(data = filter(df_plot_barriers_contention, \n                            prop_contentious_lead1 > 0.05), \n              method = \"lm\", linetype = \"21\") +\n  scale_y_continuous(labels = percent) +\n  guides(color = \"none\") +\n  labs(x = \"Number of legal barriers\", \n       y = \"Proportion of contentious aid in next year\",\n       title = \"Proportion of contentious aid in next year\",\n       subtitle = \"Dotted lines show trends when omitting observations\\nwith less than 5% contentious aid\") +\n  theme_donors(10) +\n  theme(strip.text.x = element_text(margin = margin(t = 1, b = 1))) +\n  facet_wrap(vars(barrier_clean), scales = \"free_x\", nrow = 2)\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/restrictions-aid-h2-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## Restrictions and NGOs (H~3~)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_plot_barriers_ngos <- df_country_aid_laws %>% \n  select(year, gwcode, country, \n         prop_ngo_dom_lead1, prop_ngo_foreign_lead1,\n         one_of(dvs_clean_names$barrier)) %>% \n  pivot_longer(names_to = \"barrier\", values_to = \"value\", \n               one_of(dvs_clean_names$barrier)) %>% \n  pivot_longer(names_to = \"ngo_type\", values_to = \"prop_ngo\", \n               c(prop_ngo_dom_lead1, prop_ngo_foreign_lead1)) %>% \n  left_join(dvs_clean_names, by = \"barrier\") %>% \n  left_join(ivs_clean_names, by = c(\"ngo_type\" = \"variable\")) %>% \n  mutate(barrier_clean = fct_inorder(barrier_clean, ordered = TRUE))\n\nggplot(df_plot_barriers_ngos, \n       aes(x = value, y = prop_ngo, color = barrier_clean)) +\n  geom_point(alpha = 0.5) +\n  stat_smooth(method = \"lm\") +\n  stat_smooth(data = filter(df_plot_barriers_ngos, \n                            prop_ngo > 0.05), \n              method = \"lm\", linetype = \"21\") +\n  scale_y_continuous(labels = percent) +\n  guides(color = \"none\") +\n  labs(x = \"Number of legal barriers\", \n       y = \"Proportion of aid to NGOs in next year\",\n       title = \"Proportion of aid channeled to types of NGOs in next year\",\n       subtitle = \"Dotted lines show trends when omitting observations\\nwith less than 5% aid to NGOs\") +\n  coord_cartesian(ylim = c(0, 1)) +\n  theme_donors(10) +\n  theme(strip.text.x = element_text(margin = margin(t = 1, b = 1))) +\n  facet_wrap(vars(variable_clean, barrier_clean), scales = \"free_x\", ncol = 4)\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/restrictions-aid-h3-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n## CCSI and all DVs (all hypotheses)\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf_plot_ccsi_ngos <- df_country_aid_laws %>% \n  select(year, gwcode, country, \n         one_of(ivs_clean_names$variable), v2xcs_ccsi) %>% \n  pivot_longer(names_to = \"variable\", values_to = \"value\", \n               c(one_of(ivs_clean_names$variable))) %>% \n  left_join(ivs_clean_names, by = \"variable\") %>% \n  mutate(hypothesis_clean = paste0(hypothesis, \": \", variable_clean)) %>% \n  arrange(hypothesis_clean) %>% \n  mutate(hypothesis_clean = fct_inorder(hypothesis_clean, ordered = TRUE))\n  \nggplot(df_plot_ccsi_ngos, \n       aes(x = v2xcs_ccsi, y = value, color = hypothesis)) +\n  geom_point(alpha = 0.25) +\n  scale_color_viridis_d(option = \"plasma\", end = 0.9) +\n  guides(color = \"none\") +\n  labs(x = \"Civil society index\", \n       y = \"Variable value in next year\",\n       title = \"Core civil society index\") +\n  theme_donors() +\n  facet_wrap(vars(hypothesis_clean), scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/ccsi-aid-allhs-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n\n# CIVICUS restrictions\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncivicus_clean %>% \n  filter(!is.na(category)) %>% \n  count(Rating = category, name = \"Count\") %>% \n  arrange(desc(Rating)) %>% \n  kbl(align = c(\"l\", \"c\")) %>% \n  kable_styling(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Rating </th>\n   <th style=\"text-align:center;\"> Count </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Open </td>\n   <td style=\"text-align:center;\"> 42 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Narrowed </td>\n   <td style=\"text-align:center;\"> 40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Obstructed </td>\n   <td style=\"text-align:center;\"> 47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Repressed </td>\n   <td style=\"text-align:center;\"> 44 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Closed </td>\n   <td style=\"text-align:center;\"> 23 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_civicus_map <- ggplot() +\n  geom_sf(data = civicus_map_data, aes(fill = fct_rev(category)), size = 0.15, color = \"black\") +\n  coord_sf(crs = st_crs(\"ESRI:54030\"), datum = NA) +  # Robinson\n  # scale_fill_manual(values = c(\"grey90\", \"grey70\", \"grey45\",\n  #                              \"grey20\", \"black\"),\n  #                   na.translate = FALSE, name = \"Civic space\") +\n  scale_fill_viridis_d(option = \"plasma\", end = 0.9, \n                       na.translate = FALSE, name = \"Civic space\") +\n  theme_donors_map() + \n  theme(legend.position = \"bottom\",\n        legend.key.size = unit(0.7, \"lines\"))\n\nplot_civicus_map\n```\n\n::: {.cell-output-display}\n![](general-analysis_files/figure-html/civicus-map-1.png){fig-align='center' width=85%}\n:::\n\n```{.r .cell-code}\nggsave(here(\"analysis\", \"output\", \"fig-civicus-map.pdf\"), plot_civicus_map,\n       width = 5.5, height = 3, device = cairo_pdf)\nggsave(here(\"analysis\", \"output\", \"fig-civicus-map-new.png\"), plot_civicus_map,\n       width = 5.5, height = 3, res = 300, device = ragg::agg_png)\n```\n:::\n\n\n\n# List of countries included in models\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nncol_countries <- 4\n\nall_countries <- df_country_aid_laws %>% \n  distinct(country) %>% \n  arrange(country) %>% \n  pull(country) \n\ncountries_caption <- paste0(\"All countries included in models (N = \", \n                            length(all_countries), \")\")\n\nall_countries %>% \n  matrix_from_vector(ncol = ncol_countries) %>% \n  kbl(caption = countries_caption) %>% \n  kable_styling(bootstrap_options = c(\"condensed\", \"striped\"), \n                full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-condensed table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>All countries included in models (N = 142)</caption>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Afghanistan </td>\n   <td style=\"text-align:left;\"> Ecuador </td>\n   <td style=\"text-align:left;\"> Liberia </td>\n   <td style=\"text-align:left;\"> Saudi Arabia </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Albania </td>\n   <td style=\"text-align:left;\"> Egypt </td>\n   <td style=\"text-align:left;\"> Libya </td>\n   <td style=\"text-align:left;\"> Senegal </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Algeria </td>\n   <td style=\"text-align:left;\"> El Salvador </td>\n   <td style=\"text-align:left;\"> Lithuania </td>\n   <td style=\"text-align:left;\"> Serbia </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Angola </td>\n   <td style=\"text-align:left;\"> Equatorial Guinea </td>\n   <td style=\"text-align:left;\"> Madagascar </td>\n   <td style=\"text-align:left;\"> Sierra Leone </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Argentina </td>\n   <td style=\"text-align:left;\"> Eritrea </td>\n   <td style=\"text-align:left;\"> Malawi </td>\n   <td style=\"text-align:left;\"> Singapore </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Armenia </td>\n   <td style=\"text-align:left;\"> Estonia </td>\n   <td style=\"text-align:left;\"> Malaysia </td>\n   <td style=\"text-align:left;\"> Slovakia </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Azerbaijan </td>\n   <td style=\"text-align:left;\"> Eswatini </td>\n   <td style=\"text-align:left;\"> Mali </td>\n   <td style=\"text-align:left;\"> Slovenia </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Bahrain </td>\n   <td style=\"text-align:left;\"> Ethiopia </td>\n   <td style=\"text-align:left;\"> Mauritania </td>\n   <td style=\"text-align:left;\"> Solomon Islands </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Bangladesh </td>\n   <td style=\"text-align:left;\"> Fiji </td>\n   <td style=\"text-align:left;\"> Mauritius </td>\n   <td style=\"text-align:left;\"> Somalia </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Belarus </td>\n   <td style=\"text-align:left;\"> Gabon </td>\n   <td style=\"text-align:left;\"> Mexico </td>\n   <td style=\"text-align:left;\"> South Africa </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Benin </td>\n   <td style=\"text-align:left;\"> Gambia </td>\n   <td style=\"text-align:left;\"> Moldova </td>\n   <td style=\"text-align:left;\"> South Korea </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Bhutan </td>\n   <td style=\"text-align:left;\"> Georgia </td>\n   <td style=\"text-align:left;\"> Mongolia </td>\n   <td style=\"text-align:left;\"> South Sudan </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Bolivia </td>\n   <td style=\"text-align:left;\"> Ghana </td>\n   <td style=\"text-align:left;\"> Montenegro </td>\n   <td style=\"text-align:left;\"> Sri Lanka </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Bosnia &amp; Herzegovina </td>\n   <td style=\"text-align:left;\"> Guatemala </td>\n   <td style=\"text-align:left;\"> Morocco </td>\n   <td style=\"text-align:left;\"> Sudan </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Botswana </td>\n   <td style=\"text-align:left;\"> Guinea </td>\n   <td style=\"text-align:left;\"> Mozambique </td>\n   <td style=\"text-align:left;\"> Syria </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Brazil </td>\n   <td style=\"text-align:left;\"> Guinea-Bissau </td>\n   <td style=\"text-align:left;\"> Myanmar (Burma) </td>\n   <td style=\"text-align:left;\"> Tajikistan </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Bulgaria </td>\n   <td style=\"text-align:left;\"> Guyana </td>\n   <td style=\"text-align:left;\"> Namibia </td>\n   <td style=\"text-align:left;\"> Tanzania </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Burkina Faso </td>\n   <td style=\"text-align:left;\"> Haiti </td>\n   <td style=\"text-align:left;\"> Nepal </td>\n   <td style=\"text-align:left;\"> Thailand </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Burundi </td>\n   <td style=\"text-align:left;\"> Honduras </td>\n   <td style=\"text-align:left;\"> Nicaragua </td>\n   <td style=\"text-align:left;\"> Timor-Leste </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cambodia </td>\n   <td style=\"text-align:left;\"> Hungary </td>\n   <td style=\"text-align:left;\"> Niger </td>\n   <td style=\"text-align:left;\"> Togo </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cameroon </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> Nigeria </td>\n   <td style=\"text-align:left;\"> Trinidad &amp; Tobago </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central African Republic </td>\n   <td style=\"text-align:left;\"> Indonesia </td>\n   <td style=\"text-align:left;\"> North Korea </td>\n   <td style=\"text-align:left;\"> Tunisia </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Chile </td>\n   <td style=\"text-align:left;\"> Iran </td>\n   <td style=\"text-align:left;\"> North Macedonia </td>\n   <td style=\"text-align:left;\"> Turkey </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> China </td>\n   <td style=\"text-align:left;\"> Iraq </td>\n   <td style=\"text-align:left;\"> Oman </td>\n   <td style=\"text-align:left;\"> Turkmenistan </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Colombia </td>\n   <td style=\"text-align:left;\"> Israel </td>\n   <td style=\"text-align:left;\"> Pakistan </td>\n   <td style=\"text-align:left;\"> Uganda </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Comoros </td>\n   <td style=\"text-align:left;\"> Jamaica </td>\n   <td style=\"text-align:left;\"> Panama </td>\n   <td style=\"text-align:left;\"> Ukraine </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Congo - Brazzaville </td>\n   <td style=\"text-align:left;\"> Jordan </td>\n   <td style=\"text-align:left;\"> Papua New Guinea </td>\n   <td style=\"text-align:left;\"> United Arab Emirates </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Congo - Kinshasa </td>\n   <td style=\"text-align:left;\"> Kazakhstan </td>\n   <td style=\"text-align:left;\"> Paraguay </td>\n   <td style=\"text-align:left;\"> Uruguay </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Costa Rica </td>\n   <td style=\"text-align:left;\"> Kenya </td>\n   <td style=\"text-align:left;\"> Peru </td>\n   <td style=\"text-align:left;\"> Uzbekistan </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Côte d’Ivoire </td>\n   <td style=\"text-align:left;\"> Kosovo </td>\n   <td style=\"text-align:left;\"> Philippines </td>\n   <td style=\"text-align:left;\"> Venezuela </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Croatia </td>\n   <td style=\"text-align:left;\"> Kuwait </td>\n   <td style=\"text-align:left;\"> Poland </td>\n   <td style=\"text-align:left;\"> Vietnam </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cuba </td>\n   <td style=\"text-align:left;\"> Kyrgyzstan </td>\n   <td style=\"text-align:left;\"> Portugal </td>\n   <td style=\"text-align:left;\"> Yemen </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cyprus </td>\n   <td style=\"text-align:left;\"> Laos </td>\n   <td style=\"text-align:left;\"> Qatar </td>\n   <td style=\"text-align:left;\"> Zambia </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Czechia </td>\n   <td style=\"text-align:left;\"> Latvia </td>\n   <td style=\"text-align:left;\"> Romania </td>\n   <td style=\"text-align:left;\"> Zimbabwe </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Djibouti </td>\n   <td style=\"text-align:left;\"> Lebanon </td>\n   <td style=\"text-align:left;\"> Russia </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dominican Republic </td>\n   <td style=\"text-align:left;\"> Lesotho </td>\n   <td style=\"text-align:left;\"> Rwanda </td>\n   <td style=\"text-align:left;\">  </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n# References\n",
    "supporting": [
      "general-analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}